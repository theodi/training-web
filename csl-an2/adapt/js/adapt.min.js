require(["bowser","underscore","backbone","semver","react","react-dom","html-react-parser","libraries/mediaelement-and-player","handlebars"],function(Bowser,_$1,Backbone$1,semver,React,ReactDOM,HTMLReactParser,mediaelementAndPlayer,Handlebars$1){function _interopDefaultLegacy(e){return e&&typeof e==="object"&&"default"in e?e:{"default":e}}var Bowser__default=_interopDefaultLegacy(Bowser);var ___default=_interopDefaultLegacy(_$1);var Backbone__default=_interopDefaultLegacy(Backbone$1);var semver__default=_interopDefaultLegacy(semver);var React__default=_interopDefaultLegacy(React);var ReactDOM__default=_interopDefaultLegacy(ReactDOM);var HTMLReactParser__default=_interopDefaultLegacy(HTMLReactParser);var Handlebars__default=_interopDefaultLegacy(Handlebars$1);class Wait extends Backbone.Controller{initialize(){this._waitCount=0;this._callbackHandle=null;this.being=this.begin.bind(this);this.end=this.end.bind(this)}isWaiting(){return this._waitCount!==0}begin(){if(!this.isWaiting())this.trigger("wait");this._waitCount++;if(this._callbackHandle){clearTimeout(this._callbackHandle);this._callbackHandle=null}return this}end(){if(!this.isWaiting())return this;this._waitCount--;if(this.isWaiting()||this._callbackHandle)return this;this._callbackHandle=setTimeout(function(){this._callbackHandle=null;this.trigger("ready")}.bind(this),0);return this}queue(callback){if(!callback){this.begin();return new Promise(resolve=>{this.once("ready",resolve);this.end()})}this.begin();this.once("ready",callback);this.end();return this}for(callback){this.begin();_.defer(()=>callback(_.once(this.end)));return this}}const wait=new Wait;var wait$1=__AMD("core/js/wait",wait);var LockingModel=__AMD("core/js/models/lockingModel",class LockingModel extends Backbone.Model{set(attrName,attrVal){let options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const stopProcessing=typeof attrName==="object"||typeof attrVal!=="boolean"||!this.isLocking(attrName);if(stopProcessing)return super.set(...arguments);const isSettingValueForSpecificPlugin=options?.pluginName;if(!isSettingValueForSpecificPlugin){console.error("Must supply a pluginName to change a locked attribute");options.pluginName="compatibility"}const pluginName=options.pluginName;if(this.defaults[attrName]!==undefined){this._lockedAttributes[attrName]=!this.defaults[attrName]}const lockingValue=this._lockedAttributes[attrName];const isAttemptingToLock=lockingValue===attrVal;if(isAttemptingToLock){this.setLockState(attrName,true,{pluginName:pluginName,skipcheck:true});return super.set(attrName,lockingValue)}this.setLockState(attrName,false,{pluginName:pluginName,skipcheck:true});const totalLockValue=this.getLockCount(attrName,{skipcheck:true});if(totalLockValue===0){return super.set(attrName,!lockingValue)}return this}setLocking(attrName,defaultLockValue){if(this.isLocking(attrName))return;if(!this._lockedAttributes)this._lockedAttributes={};this._lockedAttributes[attrName]=defaultLockValue}unsetLocking(attrName){if(!this.isLocking(attrName))return;if(!this._lockedAttributes)return;delete this._lockedAttributes[attrName];delete this._lockedAttributesValues[attrName];if(Object.keys(this._lockedAttributes).length===0){delete this._lockedAttributes;delete this._lockedAttributesValues}}isLocking(attrName){const isCheckingGeneralLockingState=attrName===undefined;const isUsingLockedAttributes=Boolean(this.lockedAttributes||this._lockedAttributes);if(isCheckingGeneralLockingState){return isUsingLockedAttributes}if(!isUsingLockedAttributes)return false;if(!this._lockedAttributes){this._lockedAttributes=_.result(this,"lockedAttributes")}const isAttributeALockingAttribute=this._lockedAttributes.hasOwnProperty(attrName);if(!isAttributeALockingAttribute)return false;if(!this._lockedAttributesValues){this._lockedAttributesValues={}}if(!this._lockedAttributesValues[attrName]){this._lockedAttributesValues[attrName]={}}return true}isLocked(attrName,options){const shouldSkipCheck=options?.skipcheck;if(!shouldSkipCheck){const stopProcessing=!this.isLocking(attrName);if(stopProcessing)return}return this.getLockCount(attrName)>0}getLockCount(attrName,options){const shouldSkipCheck=options?.skipcheck;if(!shouldSkipCheck){const stopProcessing=!this.isLocking(attrName);if(stopProcessing)return}const isGettingValueForSpecificPlugin=options?.pluginName;if(isGettingValueForSpecificPlugin){return this._lockedAttributesValues[attrName][options.pluginName]?1:0}const lockingAttributeValues=Object.values(this._lockedAttributesValues[attrName]);const lockingAttributeValuesSum=lockingAttributeValues.reduce((sum,value)=>sum+(value?1:0),0);return lockingAttributeValuesSum}setLockState(attrName,value,options){const shouldSkipCheck=options?.skipcheck;if(!shouldSkipCheck){const stopProcessing=!this.isLocking(attrName);if(stopProcessing)return this}const isSettingValueForSpecificPlugin=options?.pluginName;if(!isSettingValueForSpecificPlugin){console.error("Must supply a pluginName to set a locked attribute lock value");options.pluginName="compatibility"}if(value){this._lockedAttributesValues[attrName][options.pluginName]=value}else{delete this._lockedAttributesValues[attrName][options.pluginName]}return this}});class AdaptSingleton extends LockingModel{initialize(){this.loadScript=window.__loadScript}defaults(){return{_canScroll:true,_outstandingCompletionChecks:0,_pluginWaitCount:0,_isStarted:false,_shouldDestroyContentObjects:true}}lockedAttributes(){return{_canScroll:false}}async init(){this.addDirection();this.disableAnimation();this.trigger("adapt:preInitialize");await wait$1.queue();this.deferUntilCompletionChecked(async()=>{this.trigger("adapt:start");await wait$1.queue();if(!Backbone.History.started){Backbone.history.start()}this.set("_isStarted",true);this.trigger("adapt:initialize");await wait$1.queue()})}checkingCompletion(){const outstandingChecks=this.get("_outstandingCompletionChecks");this.set("_outstandingCompletionChecks",outstandingChecks+1)}checkedCompletion(){const outstandingChecks=this.get("_outstandingCompletionChecks");this.set("_outstandingCompletionChecks",outstandingChecks-1)}async deferUntilCompletionChecked(){let callback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:()=>{};if(this.get("_outstandingCompletionChecks")===0)return callback();return new Promise(resolve=>{const checkIfAnyChecksOutstanding=(model,outstandingChecks)=>{if(outstandingChecks!==0)return;this.off("change:_outstandingCompletionChecks",checkIfAnyChecksOutstanding);callback();resolve()};this.on("change:_outstandingCompletionChecks",checkIfAnyChecksOutstanding)})}isWaitingForPlugins(){this.log.deprecated("Use wait.isWaiting() as Adapt.isWaitingForPlugins() will be removed in the future");return wait$1.isWaiting()}checkPluginsReady(){this.log.deprecated("Use wait.isWaiting() as Adapt.checkPluginsReady() will be removed in the future");if(this.isWaitingForPlugins()){return}this.trigger("plugins:ready")}parseRelativeString(relativeString){const parts=relativeString.replace(/\s*([+\-=]+\d+){1}/g,"$1").split(/[@ ]/).filter(Boolean);const parsed=parts.map(part=>{let splitIndex=part.search(/[+\-=\d]{1}/);if(splitIndex===-1)splitIndex=part.length;const symbol=part.slice(splitIndex,splitIndex+1);const type=part.slice(0,splitIndex).replace(/^@/,"");let offset=null;let inset=null;switch(symbol){case"=":inset=parseInt(part.slice(splitIndex+1).trim()||0);break;default:offset=parseInt(part.slice(splitIndex).trim()||0);break;}return{type,offset,inset}});return parsed.length===1?parsed[0]:parsed}addDirection(){const defaultDirection=this.config.get("_defaultDirection");$("html").addClass("dir-"+defaultDirection).attr("dir",defaultDirection)}disableAnimation(){const disableAnimationArray=this.config.get("_disableAnimationFor");const disableAnimation=this.config.get("_disableAnimation");if(disableAnimationArray){for(let i=0,l=disableAnimationArray.length;i<l;i++){if(!$("html").is(disableAnimationArray[i]))continue;this.config.set("_disableAnimation",true);$("html").addClass("disable-animation");console.log("Animation disabled.")}return}$("html").toggleClass("disable-animation",disableAnimation===true)}async remove(){const currentView=this.parentView;if(currentView){currentView.model.setOnChildren({_isReady:false,_isRendered:false})}this.trigger("preRemove",currentView);await wait$1.queue();if(currentView&&this.get("_shouldDestroyContentObjects")){currentView.destroy()}this.trigger("remove",currentView);_.defer(this.trigger.bind(this),"postRemove",currentView)}get a11y(){}get componentStore(){}get data(){}get device(){}get drawer(){}get location(){}get notify(){}get offlineStorage(){}get router(){}get scrolling(){}get startController(){}get store(){}get tracking(){}get wait(){}async navigateToElement(){}async scrollTo(){}register(name,object){}getViewName(){}getViewClass(){}getModelName(){}getModelClass(){}findById(){}findViewByModelId(){}findByTrackingPosition(){}}const Adapt=new AdaptSingleton;var Adapt$1=__AMD("core/js/adapt",Adapt);class OfflineStorage extends Backbone.Controller{initialize(handler){this.ready=true;this._handler=undefined;if(!handler){return}this.ready=false;this._handler=handler}hasHandler(){return this._handler!==undefined}save(){Adapt$1.trigger("tracking:save");return this._handler?.save?.(...arguments)}serialize(value){if(this._handler?.serialize){return this._handler.serialize(...arguments)}return JSON.stringify(value)}deserialize(value){if(this._handler?.deserialize){return this._handler.deserialize(...arguments)}return JSON.parse(value)}set(name,value){if(this._handler?.set){return this._handler.set(...arguments)}this[name]=value}get(name){if(this._handler?.get){return this._handler.get(...arguments)}return this[name]}clear(){if(this._handler?.clear){return this._handler.clear(...arguments)}return false}setReadyStatus(){this.ready=true;Adapt$1.trigger("offlineStorage:ready")}}const offlineStorage=new OfflineStorage;var offlineStorage$1=__AMD("core/js/offlineStorage",offlineStorage);class Device extends Backbone.Controller{initialize(){___default["default"].bindAll(this,"onWindowResize","calculateResize");this.bowser=Bowser__default["default"].parse(window.navigator.userAgent);this.$html=$("html");this.$window=$(window);this.touch=Modernizr.touchevents;this.screenWidth=this.getScreenWidth();this.screenHeight=this.getScreenHeight();this.setViewportHeight();this.browser=(this.bowser.browser.name||"").toLowerCase();this.version=(this.bowser.browser.version||"").toLowerCase();this.OS=this.getOperatingSystem().toLowerCase();this.osVersion=this.bowser.os.version||"";this.renderingEngine=this.getRenderingEngine();this.listenTo(Adapt$1,{"configModel:dataLoaded":this.onConfigDataLoaded});const browser=this.browser.toLowerCase();let browserString=browser.replace(/msie|internet explorer/,"ie");browserString+=` version-${this.version} OS-${this.OS} ${this.getAppleDeviceType()}`;browserString+=browserString.replace(".","-").toLowerCase();browserString+=` ${browserString.replace(/\./g,"-").toLowerCase()}`;browserString+=` pixel-density-${this.pixelDensity()}`;this.$html.addClass(browserString)}get orientation(){return this.screenWidth>=this.screenHeight?"landscape":"portrait"}get aspectRatio(){return this.screenWidth/this.screenHeight}onConfigDataLoaded(){this.screenSize=this.checkScreenSize();this.$html.addClass("size-"+this.screenSize);if(this.orientation){this.$html.addClass("orientation-"+this.orientation)}this.$window.on("resize orientationchange",this.onWindowResize)}checkScreenSize(){const screenSizeConfig=Adapt$1.config.get("screenSize");let screenSize;const screensizeEmThreshold=300;const baseFontSize=16;const mediumEmBreakpoint=screenSizeConfig.medium>screensizeEmThreshold?screenSizeConfig.medium/baseFontSize:screenSizeConfig.medium;const smallEmBreakpoint=screenSizeConfig.small>screensizeEmThreshold?screenSizeConfig.small/baseFontSize:screenSizeConfig.small;const fontSize=parseFloat($("html").css("font-size"));const screenSizeEmWidth=window.innerWidth/fontSize;if(screenSizeEmWidth>=mediumEmBreakpoint){screenSize="large"}else if(screenSizeEmWidth>=smallEmBreakpoint){screenSize="medium"}else{screenSize="small"}return screenSize}getScreenWidth(){return this.isAppleDevice()?this.getAppleScreenWidth():window.innerWidth||this.$window.width()}getScreenHeight(){return this.isAppleDevice()?this.getAppleScreenHeight():window.innerHeight||this.$window.height()}setViewportHeight(){document.documentElement.style.setProperty("--adapt-viewport-height",`${window.innerHeight}px`)}getOperatingSystem(){let os=this.bowser.os.name.toLowerCase()||"";if(os===""){const platform=navigator.platform.toLowerCase();const match=platform.match(/win|mac|linux/);if(match)os=match[0];if(os==="win")os="windows";if(!os)os=""}if(!os)os="platformunknown";return os}getRenderingEngine(){return this.bowser.engine.name||""}onWindowResize(){if(this.hasWindowResized)return;requestAnimationFrame(this.calculateResize);this.hasWindowResized=true}calculateResize(){this.hasWindowResized=false;const previousWidth=this.screenWidth;const previousHeight=this.screenHeight;this.screenWidth=this.getScreenWidth();this.screenHeight=this.getScreenHeight();this.setViewportHeight();if(previousWidth===this.screenWidth&&previousHeight===this.screenHeight){return}if(this.orientation){this.$html.toggleClass("orientation-landscape",this.orientation==="landscape");this.$html.toggleClass("orientation-portrait",this.orientation==="portrait")}const newScreenSize=this.checkScreenSize();if(newScreenSize!==this.screenSize){this.screenSize=newScreenSize;this.$html.toggleClass("size-small",this.screenSize==="small");this.$html.toggleClass("size-medium",this.screenSize==="medium");this.$html.toggleClass("size-large",this.screenSize==="large");Adapt$1.trigger("device:changed",this.screenSize)}Adapt$1.trigger("device:preResize device:resize device:postResize",this.screenWidth)}isAppleDevice(){return /iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||navigator.userAgent.match(/Mac/)&&navigator?.maxTouchPoints>2}get shouldReportInvertedAppleScreenSize(){const windowRatio=window.innerWidth/window.innerHeight;const screenRatio=window.screen.width/window.screen.height;const isWindowPortrait=windowRatio<1;const isScreenPortrait=screenRatio<1;const isDeviceBadlyReportingScreenOrientation=isWindowPortrait!==isScreenPortrait;return isDeviceBadlyReportingScreenOrientation}getAppleScreenWidth(){return this.shouldReportInvertedAppleScreenSize?window.screen.height:window.screen.width}getAppleScreenHeight(){return this.shouldReportInvertedAppleScreenSize?window.screen.width:window.screen.height}getAppleDeviceType(){const platformType=this.bowser.platform.type?.toLowerCase()||"";const browserName=this.bowser.browser.name?.toLowerCase()||"";const isIPhone=platformType==="mobile"&&browserName==="safari";const isIPad=platformType==="tablet"&&browserName==="safari";if(isIPhone)return"iphone";if(isIPad)return"ipad";return""}pixelDensity(){const pixelDensity=window.devicePixelRatio||1;if(pixelDensity>=3){return"ultra-high"}else if(pixelDensity>=2){return"high"}else if(pixelDensity>=1.5){return"medium"}else{return"low"}}}const device=new Device;var device$1=__AMD("core/js/device",device);class Location extends Backbone__default["default"].Controller{initialize(){this._previousId=null;this._previousContentType=null;this._previousModel=null;this._previousClasses=null;this._lastVisitedType=null;this._lastVisitedMenu=null;this._lastVisitedPage=null;this._currentId=null;this._currentModel=null;this._currentLocation=null;this._contentType=null}}const location=new Location;var location$1=__AMD("core/js/location",location);var BrowserFocus=__AMD("core/js/a11y/browserFocus",class BrowserFocus extends Backbone.Controller{initialize(_ref){let{a11y}=_ref;this.a11y=a11y;this._onBlur=this._onBlur.bind(this);this._onClick=this._onClick.bind(this);this.$body=$("body");this.listenTo(Adapt$1,{"accessibility:ready":this._attachEventListeners})}_attachEventListeners(){this.$body.on("blur","*",this._onBlur).on("blur",this._onBlur);this.$body[0].addEventListener("click",this._onClick,true)}_onBlur(event){const config=this.a11y.config;if(!config._isEnabled||!config._options._isFocusNextOnDisabled){return}const $element=$(event.target);if($element.is("[data-a11y-force-focus]")){$element.removeAttr("tabindex data-a11y-force-focus")}if(event.target!==event.currentTarget){return}if(!$element.is("[disabled]")&&$element.css("display")!=="none"&&$element.css("visibility")!=="hidden"){return}this.a11y.focusNext($element)}_onClick(event){const $element=$(event.target);const isAriaDisabled=$element.closest("[aria-disabled=true]").length===1;if(isAriaDisabled){event.preventDefault();event.stopImmediatePropagation()}const config=this.a11y.config;if(!config._isEnabled||!config._options._isFocusOnClickEnabled){return}const $stack=$([...$element.toArray(),...$element.parents().toArray()]);const $focusable=$stack.filter(config._options._tabbableElements);if(!$focusable.length){return}$focusable[0].focus()}});var FocusOptions=__AMD("core/js/a11y/focusOptions",class FocusOptions{constructor(){let{preventScroll=false,defer=false}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.preventScroll=preventScroll;this.defer=defer}});var KeyboardFocusOutline=__AMD("core/js/a11y/keyboardFocusOutline",class KeyboardFocusOutline extends Backbone.Controller{initialize(_ref){let{a11y}=_ref;this.a11y=a11y;this._onKeyDown=this._onKeyDown.bind(this);this.$html=$("html");this.showOnKeys={9:true,13:true,32:true,37:true,38:true,39:true,40:true};this.listenTo(Adapt$1,{"accessibility:ready":this._attachEventListeners})}_attachEventListeners(){document.addEventListener("keydown",this._onKeyDown);this._start()}_start(){const config=this.a11y.config;if(config._options._isFocusOutlineDisabled){this.$html.addClass("a11y-disable-focusoutline");return}if(!config._isEnabled||!config._options._isFocusOutlineKeyboardOnlyEnabled){return}this.$html.addClass("a11y-disable-focusoutline")}_onKeyDown(event){const config=this.a11y.config;if(config._options._isFocusOutlineDisabled){this.$html.addClass("a11y-disable-focusoutline");return}if(!config._isEnabled||!config._options._isFocusOutlineKeyboardOnlyEnabled||!this.showOnKeys[event.keyCode]){return}const $element=$(event.target);if(!$element.is(config._options._tabbableElements)||$element.is(config._options._focusOutlineKeyboardOnlyIgnore)){return}this.$html.removeClass("a11y-disable-focusoutline")}});const LOG_LEVEL=ENUM(["DEBUG","INFO","WARN","ERROR","FATAL"]);var LOG_LEVEL$1=__AMD("core/js/enums/logLevelEnum",LOG_LEVEL);class Logging extends Backbone.Controller{initialize(){this._config={_isEnabled:true,_level:LOG_LEVEL$1.INFO.asLowerCase,_console:true,_warnFirstOnly:true};this._warned={};this.listenToOnce(Adapt$1,"configModel:dataLoaded",this.onLoadConfigData)}onLoadConfigData(){this.loadConfig();this.debug("Logging config loaded");this.trigger("log:ready")}loadConfig(){if(Adapt$1.config.has("_logging")){this._config=Adapt$1.config.get("_logging")}this.checkQueryStringOverride()}checkQueryStringOverride(){const matches=window.location.search.match(/[?&]loglevel=([a-z]*)/i);if(!matches||matches.length<2)return;const override=LOG_LEVEL$1(matches[1].toUpperCase());if(!override)return;this._config._level=override.asLowerCase;this.debug("Loglevel override in query string:",this._config._level)}debug(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}this._log(LOG_LEVEL$1.DEBUG,args)}info(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}this._log(LOG_LEVEL$1.INFO,args)}warn(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}this._log(LOG_LEVEL$1.WARN,args)}error(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4]}this._log(LOG_LEVEL$1.ERROR,args)}fatal(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5]}this._log(LOG_LEVEL$1.FATAL,args)}removed(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++){args[_key6]=arguments[_key6]}args=["REMOVED"].concat(args);this.warnOnce(...args)}deprecated(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++){args[_key7]=arguments[_key7]}args=["DEPRECATED"].concat(args);this.warnOnce(...args)}warnOnce(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++){args[_key8]=arguments[_key8]}if(this._hasWarned(args)){return}this._log(LOG_LEVEL$1.WARN,args)}_log(level,data){const isEnabled=this._config._isEnabled;if(!isEnabled)return;const configLevel=LOG_LEVEL$1(this._config._level.toUpperCase());const isLogLevelAllowed=level>=configLevel;if(!isLogLevelAllowed)return;this._logToConsole(level,data);this.trigger("log",level,data);this.trigger("log:"+level.asLowerCase,level,data)}_logToConsole(level,data){const shouldLogToConsole=this._config._console;if(!shouldLogToConsole)return;const log=[level.asUpperCase+":"];data&&log.push(...data);if(console[level.asLowerCase]){console[level.asLowerCase](...log)}else{console.log(...log)}}_hasWarned(args){if(!this._config._warnFirstOnly){return false}const hash=args.map(String).join(":");if(this._warned[hash]){return true}this._warned[hash]=true;return false}}const logging=new Logging;var logging$1=__AMD("core/js/logging",logging);var Log=__AMD("core/js/a11y/log",class Log extends Backbone.Controller{initialize(_ref){let{a11y}=_ref;this.a11y=a11y;this._warned={}}_hasWarned(args){const config=this.a11y.config;if(!config._options._warnFirstOnly){return false}const hash=args.map(String).join(":");if(this._warned[hash]){return true}this._warned[hash]=true;return false}_canWarn(){const config=this.a11y.config;return Boolean(config._options._warn)}removed(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}if(!this._canWarn){return}args=["A11Y"].concat(args);if(this._hasWarned(args)){return}logging$1.removed(...args);return this}deprecated(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}if(!this._canWarn){return}args=["A11Y"].concat(args);if(this._hasWarned(args)){return}logging$1.deprecated(...args);return this}});var Scroll=__AMD("core/js/a11y/scroll",class Scroll extends Backbone.Controller{initialize(){this._onTouchStart=this._onTouchStart.bind(this);this._onTouchEnd=this._onTouchEnd.bind(this);this._onScrollEvent=this._onScrollEvent.bind(this);this._onKeyDown=this._onKeyDown.bind(this);this._scrollDisabledElements=$([]);this.$window=$(window);this.$body=$("body");this._preventScrollOnKeys={37:true,38:true,39:true,40:true};this._ignoreKeysOnElementsMatching="textarea, input, select";this._isRunning=false;this._touchStartEventObject=null}disable($elements){$elements=$($elements);this._scrollDisabledElements=this._scrollDisabledElements.add($elements);this._checkRunning();return this}enable($elements){$elements=$($elements);if(!$elements.length){this.clear();return this}this._scrollDisabledElements=this._scrollDisabledElements.not($elements);this._checkRunning();return this}clear(){this._scrollDisabledElements=$([]);this._checkRunning();return this}_checkRunning(){if(!this._scrollDisabledElements.length){this._stop();return}this._start()}_start(){if(this._isRunning){return}this._isRunning=true;window.addEventListener("touchstart",this._onTouchStart);window.addEventListener("touchend",this._onTouchEnd);window.addEventListener("touchmove",this._onScrollEvent,{passive:false});window.addEventListener("wheel",this._onScrollEvent,{passive:false});document.addEventListener("wheel",this._onScrollEvent,{passive:false});document.addEventListener("keydown",this._onKeyDown)}_onTouchStart(event){event=$.event.fix(event);this._touchStartEventObject=event;return true}_onTouchEnd(){this._touchStartEventObject=null;return true}_onScrollEvent(event){event=$.event.fix(event);return this._preventScroll(event)}_onKeyDown(event){event=$.event.fix(event);if(!this._preventScrollOnKeys[event.keyCode]){return}const $target=$(event.target);if($target.is(this._ignoreKeysOnElementsMatching)){return}return this._preventScroll(event)}_preventScroll(event){const isGesture=event.touches?.length>1;if(isGesture){return}const $target=$(event.target);if(this._scrollDisabledElements.length){const scrollingParent=this._getScrollingParent(event,$target);if(scrollingParent.filter(this._scrollDisabledElements).length===0){this.$window.scroll();return}}event.preventDefault();return false}_getScrollingParent(event,$target){const isTouchEvent=event.type==="touchmove";const hasTouchStartEvent=this._touchStartEventObject?.originalEvent;if(isTouchEvent&&!hasTouchStartEvent){return $target}const directionY=this._getScrollDirection(event);if(directionY==="none"){return this.$body}const parents=[$target[0],...$target.parents()];for(let i=0,l=parents.length;i<l;i++){const $parent=$(parents[i]);if($parent.is("body")){return this.$body}if(!this._isScrollable($parent)){continue}if(!this._isScrolling($parent,directionY)){continue}return $parent}return this.$body}_isScrollable($target){const scrollType=$target.css("overflow-y");if(scrollType!=="auto"&&scrollType!=="scroll"){return false}const pointerEvents=$target.css("pointer-events");if(pointerEvents==="none"){return false}return true}_isScrolling($target,directionY){const scrollTop=Math.ceil($target.scrollTop());const innerHeight=$target.outerHeight();const scrollHeight=$target[0].scrollHeight;let hasScrollingSpace=false;switch(directionY){case"down":hasScrollingSpace=scrollTop+innerHeight<scrollHeight;if(hasScrollingSpace){return true}break;case"up":hasScrollingSpace=scrollTop>0;if(hasScrollingSpace){return true}break;}return false}_getScrollDirection(event){const deltaY=this._getScrollDelta(event);if(deltaY===0){return"none"}return deltaY>0?"up":"down"}_getScrollDelta(event){let deltaY=0;const isTouchEvent=event.type==="touchmove";const originalEvent=event.originalEvent;if(isTouchEvent){const startOriginalEvent=this._touchStartEventObject.originalEvent;let currentY=originalEvent.pageY;let previousY=startOriginalEvent.pageY;if(currentY===0||currentY===previousY){currentY=originalEvent.touches[0].pageY;previousY=startOriginalEvent.touches[0].pageY}deltaY=currentY-previousY}else{const hasDeltaY=originalEvent.wheelDeltaY||originalEvent.deltaY!==undefined;if(hasDeltaY){deltaY=-originalEvent.deltaY}else{deltaY=originalEvent.wheelDelta||0}}return deltaY}_stop(){if(!this._isRunning){return}this._isRunning=false;window.removeEventListener("touchstart",this._onTouchStart);window.removeEventListener("touchend",this._onTouchEnd);window.removeEventListener("touchmove",this._onScrollEvent,{passive:false});window.removeEventListener("wheel",this._onScrollEvent,{passive:false});document.removeEventListener("wheel",this._onScrollEvent,{passive:false});document.removeEventListener("keydown",this._onKeyDown)}});var WrapFocus=__AMD("core/js/a11y/wrapFocus",class WrapFocus extends Backbone.Controller{initialize(_ref){let{a11y}=_ref;this.a11y=a11y;_.bindAll(this,"_onWrapAround");this.listenTo(Adapt$1,{"accessibility:ready":this._attachEventListeners})}_attachEventListeners(){const config=this.a11y.config;$("body").on("click focus",config._options._focusguard,this._onWrapAround)}_onWrapAround(event){const config=this.a11y.config;if(!config._isEnabled||!config._options._isPopupWrapFocusEnabled){return}event.preventDefault();event.stopPropagation();this.a11y.focusFirst("body",{defer:false})}});var Popup=__AMD("core/js/a11y/popup",class Popup extends Backbone.Controller{initialize(_ref){let{a11y}=_ref;this.a11y=a11y;this._floorStack=[$("body")];this._focusStack=[];this._tabIndexes={};this._ariaHiddens={};this._elementUIDIndex=0;this.listenTo(Adapt$1,{"popup:opened"($element,ignoreInternalTrigger){if(ignoreInternalTrigger){return}this.a11y.log.deprecated("Adapt.trigger(\"popup:opened\", $element) is replaced with a11y.popupOpened($element);");this.opened($element,true)},"popup:closed"($target,ignoreInternalTrigger){if(ignoreInternalTrigger){return}this.a11y.log.deprecated("Adapt.trigger(\"popup:closed\", $target) is replaced with a11y.popupClosed($target);");this.closed($target,true)}})}opened($popupElement,silent){$popupElement=$popupElement||$(document.activeElement);this._addPopupLayer($popupElement);if(!silent){Adapt$1.trigger("popup:opened",$popupElement,true)}return this}_addPopupLayer($popupElement){$popupElement=$($popupElement);const config=this.a11y.config;if(!config._isEnabled||!config._options._isPopupManagementEnabled||$popupElement.length===0){return $popupElement}this._floorStack.push($popupElement);this._focusStack.push($(document.activeElement));let $elements=$(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);const $branch=$popupElement.add($popupElement.parents());const $siblings=$branch.siblings().filter(config._options._tabbableElementsExcludes);$elements=$elements.add($siblings);$elements.each((index,item)=>{const $item=$(item);if(typeof item.a11y_uid==="undefined"){item.a11y_uid="UID"+ ++this._elementUIDIndex}const elementUID=item.a11y_uid;if(this._tabIndexes[elementUID]===undefined){this._tabIndexes[elementUID]=[]}if(this._ariaHiddens[elementUID]===undefined){this._ariaHiddens[elementUID]=[]}const tabindex=$item.attr("tabindex");const ariaHidden=$item.attr("aria-hidden");this._tabIndexes[elementUID].push(tabindex===undefined?"":tabindex);this._ariaHiddens[elementUID].push(ariaHidden===undefined?"":ariaHidden);if(config._options._isPopupTabIndexManagementEnabled){$item.attr("tabindex",-1)}if(config._options._isPopupAriaHiddenManagementEnabled){$item.attr("aria-hidden",true)}});const $items=$popupElement.find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);if(config._options._isPopupTabIndexManagementEnabled){$items.attr("tabindex",0)}if(config._options._isPopupAriaHiddenManagementEnabled){$items.removeAttr("aria-hidden").removeClass("aria-hidden").parents(config._options._ariaHiddenExcludes).removeAttr("aria-hidden").removeClass("aria-hidden")}}closed($focusElement,silent){const $previousFocusElement=this._removeLastPopupLayer();$focusElement=$focusElement||$previousFocusElement||$("body");if(!silent){Adapt$1.trigger("popup:closed",$focusElement,true)}this.a11y.focusFirst($($focusElement),{preventScroll:true});return this}_removeLastPopupLayer(){const config=this.a11y.config;if(!config._isEnabled||!config._options._isPopupManagementEnabled){return $(document.activeElement)}if(this._floorStack.length<=1){return}this._floorStack.pop();$(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes).each((index,item)=>{const $item=$(item);let previousTabIndex="";let previousAriaHidden="";if(typeof item.a11y_uid==="undefined"){item.a11y_uid="UID"+ ++this._elementUIDIndex}const elementUID=item.a11y_uid;if(this._tabIndexes[elementUID]?.length){previousTabIndex=this._tabIndexes[elementUID].pop();previousAriaHidden=this._ariaHiddens[elementUID].pop()}if(this._tabIndexes[elementUID]?.length){delete this._tabIndexes[elementUID];delete this._ariaHiddens[elementUID]}if(config._options._isPopupTabIndexManagementEnabled){if(previousTabIndex===""){$item.removeAttr("tabindex")}else{$item.attr({tabindex:previousTabIndex})}}if(config._options._isPopupAriaHiddenManagementEnabled){if(previousAriaHidden===""){$item.removeAttr("aria-hidden")}else{$item.attr({"aria-hidden":previousAriaHidden})}}});return this._focusStack.pop()}setCloseTo($focusElement){const $original=this._focusStack.pop();this._focusStack.push($focusElement);return $original}});var defaultAriaLevels=__AMD("core/js/enums/defaultAriaLevels",{_menu:1,_menuGroup:2,_menuItem:2,_page:1,_article:2,_block:3,_component:4,_componentItem:5,_notify:1});var deprecated=__AMD("core/js/a11y/deprecated",function(a11y){Object.assign($.fn,{isFixedPostion(){a11y.log.removed("$(\"..\").isFixedPostion was unneeded and has been removed, let us know if you need it back.");return false},a11y_aria_label(){a11y.log.removed("$(\"..\").a11y_aria_label was incorrect behaviour.");return this},limitedScrollTo(){a11y.log.removed("$.limitedScrollTo had no impact on the screen reader cursor.");return this},a11y_text(){a11y.log.removed("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return this},a11y_selected(){a11y.log.removed("$(\"..\").a11y_selected is removed. Please use aria-live instead.");return this},a11y_on(isOn){a11y.log.deprecated("$(\"..\").a11y_on, use a11y.findTabbable($element); and a11y.toggleAccessible($elements, isAccessible); instead.");const $tabbable=a11y.findTabbable(this);a11y.toggleAccessible($tabbable,isOn);return this},a11y_only(){a11y.log.removed("$(\"..\").a11y_only, use a11y.popupOpened($popupElement); instead.");return this},scrollDisable(){if(a11y.config._options._isScrollDisableEnabled===false){return this}a11y.log.deprecated("$(\"..\").scrollDisable, use a11y.scrollDisable($elements); instead.");a11y.scrollDisable(this);return this},scrollEnable(){if(a11y.config._options._isScrollDisableEnabled===false){return this}a11y.log.deprecated("$(\"..\").scrollEnable, use a11y.scrollEnable($elements); instead.");a11y.scrollEnable(this);return this},a11y_popup(){a11y.log.deprecated("$(\"..\").a11y_popup, use a11y.popupOpened($popupElement); instead.");return a11y.popupOpened(this)},a11y_cntrl(isOn,withDisabled){a11y.log.deprecated("$(\"..\").a11y_cntrl, use a11y.toggleAccessible($elements, isAccessible); and if needed a11y.toggleEnabled($elements, isEnabled); instead.");a11y.toggleAccessible(this,isOn);if(withDisabled)a11y.toggleEnabled(this,isOn);return this},a11y_cntrl_enabled(isOn){a11y.log.deprecated("$(\"..\").a11y_cntrl_enabled, use a11y.toggleAccessibleEnabled($elements, isAccessibleEnabled); instead.");a11y.toggleAccessibleEnabled(this,isOn);return this},isReadable(){a11y.log.deprecated("$(\"..\").isReadable, use a11y.isReadable($element); instead.");return a11y.isReadable(this)},findForward(selector){a11y.log.removed("$(\"..\").findForward has been removed as the use cases are very small, let us know if you need it back.");return a11y._findFirstForward(this,selector)},findWalk(selector){a11y.log.removed("$(\"..\").findWalk has been removed as the use cases are very small, let us know if you need it back.");return a11y._findFindForwardDescendant(this,selector)},focusNoScroll(){a11y.log.deprecated("$(\"..\").focusNoScroll, use a11y.focus($element); instead.");return a11y.focus(this)},focusNext(returnOnly){a11y.log.deprecated("$(\"..\").focusNext, use a11y.focusNext($element); or if needed a11y.findFirstReadable($element); instead.");if(returnOnly){return a11y.findFirstReadable(this)}return a11y.focusNext(this)},focusOrNext(returnOnly){a11y.log.deprecated("$(\"..\").focusOrNext, use a11y.focusFirst($element); or if needed a11y.findFirstReadable($element); or a11y.isReadable($element); instead.");if(returnOnly){if(a11y.isReadable(this))return this;return a11y.findFirstReadable(this)}return a11y.focusFirst(this)},a11y_focus(dontDefer){a11y.log.deprecated("$(\"..\").a11y_focus, use a11y.focusFirst($element, { defer: true }); instead.");a11y.focusFirst(this,{defer:!dontDefer});return this}});Object.assign($,{a11y_alert(){a11y.log.removed("$.a11y_alert is removed. Please use aria-live instead.");return this},a11y_update(){a11y.log.removed("a11y_update is no longer required.");return this},a11y_text(text){a11y.log.removed("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return text},a11y_on(isOn,selector){a11y.log.deprecated("$(\"..\").a11y_on, use a11y.toggleHidden($elements, isHidden); instead.");return a11y.toggleHidden(selector,!isOn)},a11y_popdown($focusTarget){a11y.log.removed("$.a11y_popdown, use a11y.popupClosed($focusTarget); instead.");return a11y.popupClosed($focusTarget)},a11y_focus(dontDefer){a11y.log.deprecated("$.a11y_focus, use a11y.focusFirst(\"body\", { defer: true }); instead.");a11y.focusFirst("body",{defer:!dontDefer});return this},a11y_normalize(html){a11y.log.deprecated("$.a11y_normalize, use a11y.normalize(\"html\"); instead.");return a11y.normalize(html)},a11y_remove_breaks(html){a11y.log.deprecated("$.a11y_remove_breaks, use a11y.removeBreaks(\"html\"); instead.");return a11y.removeBreaks(html)}})});class Components extends Backbone__default["default"].Controller{initialize(){this._register={};this.register=this.register.bind(this);this.getViewName=this.getViewName.bind(this);this.getViewClass=this.getViewClass.bind(this);this.getModelName=this.getModelName.bind(this);this.getModelClass=this.getModelClass.bind(this)}register(name,object){if(Array.isArray(name)){name.forEach(name=>this.register(name,object));return object}if(name.split(" ").length>1){this.register(name.split(" "),object);return object}if(!object.view&&!object.model||object instanceof Backbone__default["default"].View){logging$1.deprecated("View-only registrations are no longer supported");object={view:object}}if(object.view&&!object.view.template){object.view.template=name}const isModelSetAndInvalid=object.model&&!(object.model.prototype instanceof Backbone__default["default"].Model)&&!(object.model instanceof Function);if(isModelSetAndInvalid){throw new Error("The registered model is not a Backbone.Model or Function")}const isViewSetAndInvalid=object.view&&!(object.view.prototype instanceof Backbone__default["default"].View)&&!(object.view instanceof Function);if(isViewSetAndInvalid){throw new Error("The registered view is not a Backbone.View or Function")}this._register[name]=Object.assign({},this._register[name],object);return object}getViewName(nameModelViewOrData){if(typeof nameModelViewOrData==="string"){return nameModelViewOrData}if(nameModelViewOrData instanceof Backbone__default["default"].Model){nameModelViewOrData=nameModelViewOrData.toJSON()}if(nameModelViewOrData instanceof Backbone__default["default"].View){let foundName;Object.entries(this._register).forEach(_ref=>{let[key,entry]=_ref;if(!entry?.view)return;if(!(nameModelViewOrData instanceof entry.view))return;foundName=key;return true});return foundName}if(nameModelViewOrData instanceof Object){const names=[typeof nameModelViewOrData._view==="string"&&nameModelViewOrData._view,typeof nameModelViewOrData._component==="string"&&nameModelViewOrData._component,typeof nameModelViewOrData._type==="string"&&nameModelViewOrData._type].filter(Boolean);if(names.length){const name=names.find(name=>this._register[name]?.view);return name||names.pop()}}throw new Error("Cannot derive view class name from input")}getViewClass(nameModelViewOrData){const name=this.getViewName(nameModelViewOrData);const object=this._register[name];if(!object){logging$1.error(`A view for '${name}' isn't registered in your project`);return}const isBackboneView=object.view?.prototype instanceof Backbone__default["default"].View;if(!isBackboneView&&object.view instanceof Function){return object.view()}return object.view}getModelName(nameModelOrData){if(typeof nameModelOrData==="string"){return nameModelOrData}if(nameModelOrData instanceof Backbone__default["default"].Model){nameModelOrData=nameModelOrData.toJSON()}if(nameModelOrData instanceof Object){const name=nameModelOrData._component;const entry=this._register[name];const isViewOnlyQuestion=entry&&!entry.model&&entry.view?._isQuestionType;if(isViewOnlyQuestion){logging$1.deprecated(`Assuming a question model for a view-only question: ${name}`);return"question"}const names=[typeof nameModelOrData._model==="string"&&nameModelOrData._model,typeof nameModelOrData._component==="string"&&nameModelOrData._component,typeof nameModelOrData._type==="string"&&nameModelOrData._type].filter(Boolean);if(names.length){const name=names.find(name=>this._register[name]?.model);return name||names.pop()}}throw new Error("Cannot derive model class name from input")}getModelClass(nameModelOrData){const name=this.getModelName(nameModelOrData);const object=this._register[name];if(!object){logging$1.error(`A model for '${name}' isn't registered in your project`);return}const isBackboneModel=object.model?.prototype instanceof Backbone__default["default"].Model;if(!isBackboneModel&&object.model instanceof Function){return object.model()}return object.model}}const components=new Components;var components$1=__AMD("core/js/components",components);var AdaptCollection=__AMD("core/js/collections/adaptCollection",class AdaptCollection extends Backbone.Collection{initialize(models,options){this.once("reset",this.loadedData,this)}loadedData(){Adapt$1.trigger("adaptCollection:dataLoaded")}});var BuildModel=__AMD("core/js/models/buildModel",class BuildModel extends LockingModel{defaults(){return{jsonext:"json"}}initialize(attrs,options){this.url=options.url;this.fetch({success:()=>{this.isLoaded=true;Adapt$1.trigger("buildModel:dataLoaded")},error:()=>{console.log("Unable to load adapt/js/build.js");Adapt$1.trigger("buildModel:dataLoaded")}})}isFrameworkVersion(version){return semver__default["default"].satisfies(this.get("package").version,version,{includePrerelease:true})}isPluginInstalled(name){let version=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"*";const plugin=this.get("plugins").find(plugin=>{if(plugin.name!==name)return false;return semver__default["default"].satisfies(plugin.version,version,{includePrerelease:true})});return Boolean(plugin)}whenReady(){if(this.isLoaded)return Promise.resolve();return new Promise(resolve=>{Adapt$1.once("buildModel:dataLoaded",resolve)})}});var ConfigModel=__AMD("core/js/models/configModel",class ConfigModel extends LockingModel{defaults(){return{screenSize:{large:900,medium:760,small:520},_forceRouteLocking:false,_canLoadData:true,_disableAnimation:false}}setValuesFromURLParams(){const paramMappings={dir:"_defaultDirection",lang:"_defaultLanguage"};const params=new URLSearchParams(window.location.search);Object.entries(paramMappings).forEach(_ref=>{let[key,value]=_ref;const passedVal=params.get(key);if(!passedVal)return;if(key==="lang"&&Adapt$1.build.get("availableLanguageNames")?.includes(passedVal)===false)return;this.set(value,passedVal)})}initialize(attrs,options){this.url=options.url;this.fetch({success:()=>{this.setValuesFromURLParams();Adapt$1.trigger("offlineStorage:prepare");wait$1.queue(()=>{Adapt$1.trigger("configModel:dataLoaded");if(!this.get("_canLoadData"))return;Adapt$1.trigger("configModel:loadCourseData")})},error:()=>logging$1.error("Unable to load course/config.json")})}loadData(){}});class Data extends AdaptCollection{model(json){const ModelClass=components$1.getModelClass(json);if(!ModelClass){return new LockingModel(json)}return new ModelClass(json,{parse:true})}initialize(){super.initialize();this.findById=this.findById.bind(this);this.findViewByModelId=this.findViewByModelId.bind(this);this.findByTrackingPosition=this.findByTrackingPosition.bind(this);this.on({add:this.onAdded,remove:this.onRemoved})}async init(){this.reset();this._byAdaptID={};Adapt$1.build=new BuildModel(null,{url:"adapt/js/build.min.js",reset:true});await Adapt$1.build.whenReady();$("html").attr("data-adapt-framework-version",Adapt$1.build.get("package").version);this.loadConfigData()}onAdded(model){this._byAdaptID[model.get("_id")]=model}onRemoved(model){delete this._byAdaptID[model.get("_id")]}loadConfigData(){Adapt$1.config=new ConfigModel(null,{url:Adapt$1.build.get("coursedir")+"/config."+Adapt$1.build.get("jsonext"),reset:true});this.listenToOnce(Adapt$1,"configModel:loadCourseData",this.onLoadCourseData);this.listenTo(Adapt$1.config,{"change:_activeLanguage":this.onLanguageChange,"change:_defaultDirection":this.onDirectionChange})}onDirectionChange(model,direction){if(direction==="rtl"){$("html").removeClass("dir-ltr").addClass("dir-rtl").attr("dir","rtl")}else{$("html").removeClass("dir-rtl").addClass("dir-ltr").attr("dir","ltr")}}onLoadCourseData(){if(!Adapt$1.config.get("_activeLanguage")){Adapt$1.config.set("_activeLanguage",Adapt$1.config.get("_defaultLanguage"));return}this.loadCourseData()}async onLanguageChange(model,language){await wait$1.queue();offlineStorage$1.set("lang",language);if(Adapt$1.get("_isStarted")){Adapt$1.set("_isStarted",false)}this.loadCourseData(language)}async loadCourseData(newLanguage){const language=Adapt$1.config.get("_activeLanguage");const courseFolder=Adapt$1.build.get("coursedir")+"/"+language+"/";$("html").attr("lang",language);await this.loadManifestFiles(courseFolder);await this.triggerDataLoaded();await this.triggerDataReady(newLanguage);this.triggerInit()}getJSON(path){return new Promise((resolve,reject)=>{$.getJSON(path,data=>{data.__path__=path;resolve(data)}).fail(()=>{reject(new Error(`Unable to load ${path}`))})})}async loadManifestFiles(languagePath){this.trigger("loading");this.reset();const manifestPath=languagePath+"language_data_manifest.js";let manifest;try{manifest=await this.getJSON(manifestPath)}catch(err){manifest=["course.json","contentObjects.json","articles.json","blocks.json","components.json"];logging$1.error(`Manifest path '${manifestPath} not found. Using traditional files: ${manifest.join(", ")}`)}let allFileData;try{allFileData=await Promise.all(manifest.map(filePath=>{return this.getJSON(`${languagePath}${filePath}`)}))}catch(error){logging$1.error(error);return}const allModelData=allFileData.reduce((result,fileData)=>{if(Array.isArray(fileData)){fileData.forEach((datum,index)=>{datum.__path__=fileData.__path__;datum.__index__=index});result.push(...fileData)}else if(fileData instanceof Object){result.push(fileData)}else{logging$1.warnOnce(`File data isn't an array or object: ${fileData.__path__}`)}return result},[]);const course=allModelData.find(modelData=>modelData._type==="course");if(!course){throw new Error("Expected a model data with \"_type\": \"course\", none found.")}Adapt$1.trigger("courseModel:dataLoading");Adapt$1.course=this.push(course);Adapt$1.trigger("courseModel:dataLoaded");allModelData.forEach(modelData=>{if(modelData._type==="course"){return}try{components$1.getModelName(modelData)}catch(error){logging$1.error(`Failed to load object ${modelData.__path__}${Object.prototype.hasOwnProperty.call(modelData,"__index__")?`[${modelData.__index__}]`:""}`);logging$1.error(error);return}this.push(modelData)});this.checkData();this.trigger("reset");this.trigger("loaded");await wait$1.queue()}async triggerDataLoaded(){logging$1.debug("Firing app:dataLoaded");try{this.forEach(model=>model.setupModel?.());Adapt$1.trigger("app:dataLoaded")}catch(e){logging$1.error("Error during app:dataLoading trigger",e)}await wait$1.queue()}async triggerDataReady(newLanguage){if(newLanguage){Adapt$1.trigger("app:languageChanged",newLanguage);await wait$1.queue()}logging$1.debug("Firing app:dataReady");try{Adapt$1.trigger("app:dataReady")}catch(e){logging$1.error("Error during app:dataReady trigger",e)}await wait$1.queue()}triggerInit(){this.isReady=true;this.trigger("ready")}whenReady(){if(this.isReady)return Promise.resolve();return new Promise(resolve=>{this.once("ready",resolve)})}hasId(id){return Boolean(this._byAdaptID[id])}findById(id){const model=this._byAdaptID[id];if(!model){console.warn(`data.findById() unable to find id: ${id}`);return}return model}findViewByModelId(id){const model=this.findById(id);if(!model||!Adapt$1.parentView)return;const idPathToView=[id];const currentLocationId=location$1._currentId;const currentLocationModel=model.getAncestorModels().find(model=>{const modelId=model.get("_id");if(modelId===currentLocationId)return true;idPathToView.unshift(modelId);return false});if(!currentLocationModel){return console.warn(`data.findViewByModelId() unable to find view for model id: ${id}`)}const foundView=idPathToView.reduce((view,currentId)=>{if(!view)return null;const childViews=view.getChildViews();return childViews?.find(view=>view.model.get("_id")===currentId)},Adapt$1.parentView);return foundView}findByTrackingPosition(trackingPosition){const[trackingId,indexInTrackingIdDescendants]=trackingPosition;const trackingIdModel=this.find(model=>model.get("_trackingId")===trackingId);if(!trackingIdModel){console.warn(`data.findByTrackingPosition() unable to find trackingPosition: ${trackingPosition}`);return}if(indexInTrackingIdDescendants>=0){let trackingIdDescendants=[trackingIdModel].concat(trackingIdModel.getAllDescendantModels(true));trackingIdDescendants=trackingIdDescendants.filter(model=>!(model.isTypeGroup("component")&&model.get("_isTrackable")===false));return trackingIdDescendants[indexInTrackingIdDescendants]}const trackingIdAncestors=trackingIdModel.getAncestorModels();const ancestorDistance=Math.abs(indexInTrackingIdDescendants)-1;return trackingIdAncestors[ancestorDistance]}logReadyError(view){const notReadyDescendants=view.model.getAllDescendantModels(true).filter(model=>!model.get("_isReady"));logging$1.error(`View ${notReadyDescendants.map(model=>`${model.get("_id")} (${model.get("_component")??model.get("_type")})`).join(", ")} failed to become ready, forcing ready status.`);notReadyDescendants.reverse().forEach(model=>model.set("_isReady",true))}checkData(){this.checkIds();this.checkTrackingIds()}checkIds(){const items=this.toJSON();const idIndex=___default["default"].indexBy(items,"_id");const idGroups=___default["default"].groupBy(items,"_id");const parentIdGroups=___default["default"].groupBy(items,"_parentId");let orphanedIds={};let emptyIds={};let duplicateIds={};let missingIds={};items.forEach(o=>{const isCourseType=o._type==="course";const isComponentType=o._type==="component";if(idGroups[o._id].length>1){duplicateIds[o._id]=true}if(!isComponentType&&!parentIdGroups[o._id]){emptyIds[o._id]=true}if(!isCourseType&&(!o._parentId||!idIndex[o._parentId])){orphanedIds[o._id]=true}if(!isCourseType&&o._parentId&&!idIndex[o._parentId]){missingIds[o._parentId]=true}});orphanedIds=Object.keys(orphanedIds);emptyIds=Object.keys(emptyIds);duplicateIds=Object.keys(duplicateIds);missingIds=Object.keys(missingIds);const hasErrored=orphanedIds.length||emptyIds.length||duplicateIds.length||missingIds.length;if(orphanedIds.length){logging$1.error(`Orphaned _ids: ${orphanedIds.join(", ")}`)}if(missingIds.length){logging$1.error(`Missing _ids: ${missingIds.join(", ")}`)}if(emptyIds.length){logging$1.error(`Empty _ids: ${emptyIds.join(", ")}`)}if(duplicateIds.length){logging$1.error(`Duplicate _ids: ${duplicateIds.join(", ")}`)}if(hasErrored){const err=new Error("Oops, looks like you have some json errors.");err.number=10011;throw err}}checkTrackingIds(){const items=this.toJSON();const trackingIdType=Adapt$1.build.get("trackingIdType")||"block";const trackingIdCounts=___default["default"].groupBy(items.filter(item=>item._type===trackingIdType),"_trackingId");const missingTrackingIds=items.filter(item=>item._type===trackingIdType&&item._trackingId===undefined).map(item=>item._id);if(missingTrackingIds.length){logging$1.error(`Missing _trackingIds: ${missingTrackingIds.join(", ")}`)}const duplicateTrackingIds=Object.entries(trackingIdCounts).filter(_ref=>{let[id,group]=_ref;return group.length>1}).map(_ref2=>{let[id,group]=_ref2;return`${id}:[${group.map(item=>item._id).join(", ")}]`});if(duplicateTrackingIds.length){logging$1.error(`Duplicate _trackingIds: ${duplicateTrackingIds.join(", ")}`)}const hasErrored=missingTrackingIds.length||duplicateTrackingIds.length;if(hasErrored){const err=new Error("Oops, looks like you have some json errors with trackingIds.");err.number=10011;throw err}}}const data=new Data;var data$1=__AMD("core/js/data",data);class A11y extends Backbone.Controller{defaults(){return{_isFocusOutlineKeyboardOnlyEnabled:true,_isFocusOutlineDisabled:false,_isFocusAssignmentEnabled:true,_isFocusOnClickEnabled:true,_isFocusNextOnDisabled:true,_isScrollDisableEnabled:true,_isAriaHiddenManagementEnabled:true,_isPopupManagementEnabled:true,_isPopupWrapFocusEnabled:true,_isPopupAriaHiddenManagementEnabled:true,_isPopupTabIndexManagementEnabled:true,_ariaHiddenExcludes:":not(#wrapper):not(body)",_tabbableElements:"a,button,input,select,textarea,[tabindex]:not([data-a11y-force-focus])",_focusOutlineKeyboardOnlyIgnore:"input,textarea",_tabbableElementsExcludes:":not(.a11y-ignore):not([data-a11y-force-focus])",_focusableElements:"a,button,input,select,textarea,[tabindex],label",_readableElements:"[role=heading],[aria-label],[aria-labelledby],[alt]",_focusForwardElementsExcludes:":not([aria-labelledby][role=dialog],[aria-labelledby][role=main],[aria-labelledby][role=region],[aria-labelledby][role=radiogroup],[aria-labelledby][role=group],[aria-labelledby][role=tablist],[aria-labelledby][role=list],[aria-labelledby][role=tree],[aria-labelledby][role=treegrid],[aria-labelledby][role=table],[aria-labelledby][role=grid][aria-labelledby],[role=menu],[aria-labelledby][role=rowgroup])",_focusguard:".a11y-focusguard",_wrapStyleElements:"b,i,abbr,strong,em,small,sub,sup,ins,del,mark,zw,nb",_warnFirstOnly:true,_warn:true}}initialize(){this.isFocusable=this.isFocusable.bind(this);this.isReadable=this.isReadable.bind(this);this.isTabbable=this.isTabbable.bind(this);this.$html=$("html");this._htmlCharRegex=/&.*;/g;this.config=null;this._browserFocus=new BrowserFocus({a11y:this});this._keyboardFocusOutline=new KeyboardFocusOutline({a11y:this});this._wrapFocus=new WrapFocus({a11y:this});this._popup=new Popup({a11y:this});this._scroll=new Scroll({a11y:this});this.log=new Log({a11y:this});deprecated(this);this._removeLegacyElements();this.listenToOnce(Adapt$1,{"configModel:dataLoaded":this._onConfigDataLoaded,"navigationView:postRender":this._removeLegacyElements},this);Adapt$1.on("device:changed",this._setupNoSelect);this.listenTo(Adapt$1,{"router:location":this._onNavigationStart,"contentObjectView:ready router:plugin":this._onNavigationEnd})}_onConfigDataLoaded(){this.config=Adapt$1.config.get("_accessibility");this.config._isActive=false;this.config._options=_.defaults(this.config._options||{},this.defaults());offlineStorage$1.set("a11y",false);this.$html.toggleClass("has-accessibility",this.isEnabled());this._setupNoSelect();this._addFocuserDiv();if(this._isReady){return}this._isReady=true;Adapt$1.trigger("accessibility:ready")}_setupNoSelect(){if(!this.config?._disableTextSelectOnClasses){return}const classes=this.config._disableTextSelectOnClasses.split(" ");const isMatch=classes.some(className=>this.$html.is(className));this.$html.toggleClass("u-no-select",isMatch)}_addFocuserDiv(){if($("#a11y-focuser").length){return}$("body").append($("<div id=\"a11y-focuser\" class=\"a11y-ignore\" tabindex=\"-1\">&nbsp;</div>"))}_removeLegacyElements(){const $legacyElements=$("body").children("#accessibility-toggle, #accessibility-instructions");const $navigationElements=$(".nav").find("#accessibility-toggle, #accessibility-instructions");if(!$legacyElements.length&&!$navigationElements.length){return}logging$1.warn("REMOVED: #accessibility-toggle and #accessibility-instructions have been removed. Please remove them from all of your .html files.");$legacyElements.remove();$navigationElements.remove()}_onNavigationStart(){if(!this.isEnabled()){return}_.defer(()=>this.toggleHidden(".contentobject",true))}_onNavigationEnd(view){if(view?.model?.get("_id")!==location$1._currentId||!this.isEnabled()){return}this.toggleHidden(".contentobject",false)}isActive(){this.log.removed("Accessibility is now always active when enabled. Please unify your user experiences.");return false}isEnabled(){return this.config?._isEnabled}ariaLevel(){let{id=null,level="1",override=null}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(arguments.length===2){level=arguments[0];override=arguments[1];id=null}const ariaLevels=Adapt$1.config.get("_accessibility")?._ariaLevels??defaultAriaLevels;if(override===0)override=null;function calculateLevel(){let id=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;let level=arguments.length>1?arguments[1]:undefined;let offset=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;const isNumber=!isNaN(level);const isTypeName=/[a-zA-z]/.test(level);if(!isTypeName&&isNumber){return parseInt(level)+offset}const relativeDescriptor=Adapt$1.parseRelativeString(level);const nextLevel=ariaLevels?.["_"+relativeDescriptor.type];const hasModelId=Boolean(id);if(!hasModelId){logging$1.warnOnce("Cannot calculate appropriate heading level, no model id was specified");return calculateLevel(id,nextLevel,offset+relativeDescriptor.offset)}const nextModel=data$1.findById(id)?.findAncestor(relativeDescriptor.type?.toLowerCase())??data$1.findById(id);const nextModelId=nextModel?.get("_id")??id;const hasNextTitle=Boolean(nextModel.get("displayTitle"));let nextModelOverride=nextModel.get("_ariaLevel");if(nextModelOverride===0)nextModelOverride=null;const accumulatedOffset=offset+(hasNextTitle?relativeDescriptor.offset:0);const resolvedLevel=nextModelOverride??nextLevel;return calculateLevel(nextModelId,resolvedLevel,accumulatedOffset)}return calculateLevel(id,override??level)}toggleHidden($elements){let isHidden=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;$elements=$($elements);const config=this.config;if(!config._isEnabled||!config._options._isAriaHiddenManagementEnabled){return this}if(isHidden===true){$elements.attr("aria-hidden",true)}else{$elements.removeAttr("aria-hidden")}return this}toggleAccessibleEnabled($elements,isAccessibleEnabled){this.toggleAccessible($elements,isAccessibleEnabled);this.toggleEnabled($elements,isAccessibleEnabled);return this}toggleAccessible($elements){let isReadable=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;$elements=$($elements);const config=this.config;if(!config._isEnabled||!config._options._isAriaHiddenManagementEnabled||$elements.length===0){return this}if(!isReadable){$elements.attr({tabindex:"-1","aria-hidden":"true"}).addClass("aria-hidden")}else{$elements.removeAttr("aria-hidden tabindex").removeClass("aria-hidden");$elements.parents(config._options._ariaHiddenExcludes).removeAttr("aria-hidden").removeClass("aria-hidden")}return this}toggleEnabled($elements){let isEnabled=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;$elements=$($elements);if($elements.length===0){return this}if(!isEnabled){$elements.attr({"aria-disabled":"true"}).addClass("is-disabled")}else{$elements.removeAttr("aria-disabled").removeClass("is-disabled")}return this}toggleTabbableDescendants($element){let isTabbable=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;const $tabbable=this.findTabbable($element);if(!isTabbable){$tabbable.each((index,element)=>{if(element.isAdaptTabHidden)return;const $element=$(element);element.isAdaptTabHidden=true;element.adaptPreviousTabIndex=$element.attr("tabindex")??null;$element.attr("tabindex",-1)});return this}$tabbable.each((index,element)=>{if(!element.isAdaptTabHidden)return;const $element=$(element);if(element.adaptPreviousTabIndex===null)$element.removeAttr("tabindex");else $element.attr("tabindex",element.adaptPreviousTabIndex);delete element.isAdaptTabHidden;delete element.adaptPreviousTabIndex});return this}findFirstTabbable($element){$element=$($element).first();return this._findFirstForward($element,this.isTabbable)}findFirstReadable($element){$element=$($element).first();return this._findFirstForward($element,this.isReadable)}findFirstFocusable($element){$element=$($element).first();return this._findFirstForward($element,this.isFocusable)}findTabbable($element){const config=this.config;return $($element).find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes)}findReadable($element){return $($element).find("*").filter((index,element)=>this.isReadable(element))}findFocusable($element){return $($element).find("*").filter((index,element)=>this.isFocusable(element))}isTabbable($element){const config=this.config;const value=$($element).is(config._options._tabbableElements).is(config._options._tabbableElementsExcludes);if(!value){return null}return value}isReadable($element){let checkParents=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;const config=this.config;$element=$($element).first();const $branch=checkParents?$element.add($element.parents()):$element;const isNotVisible=$branch.toArray().some(item=>{const $item=$(item);return $item.css("display")==="none"||$item.css("visibility")==="hidden"||$item.attr("aria-hidden")==="true"});if(isNotVisible){return false}const hasReadableContent=!/^\s*$/.test($element.text())||!/^\s*$/.test($element.attr("aria-label")??"")||!/^\s*$/.test($element.attr("aria-labelledby")??"");const hasNativeFocusOrIsScreenReadable=($element.is(config._options._focusableElements)||$element.is(config._options._readableElements))&&hasReadableContent;if(hasNativeFocusOrIsScreenReadable){return true}const childNodes=$element[0].childNodes;for(let c=0,cl=childNodes.length;c<cl;c++){const childNode=childNodes[c];const isTextNode=childNode.nodeType===3;if(!isTextNode){continue}const isOnlyWhiteSpace=/^\s*$/.test(childNode.nodeValue);if(isOnlyWhiteSpace){continue}return true}return null}isFocusable($element){let checkParents=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;const config=this.config;$element=$($element).first();if(!$element.is(config._options._focusForwardElementsExcludes))return null;return this.isReadable($element,checkParents)}_findFirstForward($element,selector){$element=$($element).first();let iterator;switch(typeof selector){case"string":iterator=function($tag){return $tag.is(selector)||undefined};break;case"function":iterator=selector;break;case"undefined":iterator=Boolean;}if($element.length===0){return $element.not("*")}let $found=this._findFirstForwardDescendant($element,iterator);if($found.length){return $found}$element.nextAll().toArray().some(sibling=>{const $sibling=$(sibling);const value=iterator($sibling);if(value===false){return false}if(value){$found=$sibling;return true}$found=this._findFirstForwardDescendant($sibling,iterator);return Boolean($found.length)});if($found.length){return $found}$element.add($element.parents()).toArray().reverse().some(parent=>{const $parent=$(parent);if(iterator($parent)===false){return false}return $parent.nextAll().toArray().some(sibling=>{const $sibling=$(sibling);const value=iterator($sibling);if(value===false){return false}if(value){$found=$sibling;return true}$found=this._findFirstForwardDescendant($sibling,iterator);return Boolean($found.length)})});if(!$found.length){return $element.not("*")}return $found}_findFirstForwardDescendant($element,selector){$element=$($element).first();let iterator;switch(typeof selector){case"string":iterator=function($tag){return $tag.is(selector)||undefined};break;case"function":iterator=selector;break;case"undefined":iterator=Boolean;}const $notFound=$element.not("*");if($element.length===0){return $notFound}const stack=[{item:$element[0],value:undefined}];let stackIndexPosition=0;let childIndexPosition=stackIndexPosition+1;do{const stackEntry=stack[stackIndexPosition];const $stackItem=$(stackEntry.item);switch(stackEntry.value){case true:return $stackItem;case false:return $notFound;}$stackItem.children().toArray().forEach(item=>{const $item=$(item);const value=iterator($item);if(value===false){return}stack.splice(childIndexPosition++,0,{item,value})});stackIndexPosition++;childIndexPosition=stackIndexPosition+1}while(stackIndexPosition<stack.length);return $notFound}focusNext($element,options){options=new FocusOptions(options);$element=$($element).first();$element=this.findFirstFocusable($element);this.focus($element,options);return this}focusFirst($element,options){options=new FocusOptions(options);$element=$($element).first();if(this.isReadable($element)){this.focus($element,options);return $element}$element=this.findFirstFocusable($element);this.focus($element,options);return $element}focus($element,options){options=new FocusOptions(options);$element=$($element).first();const config=this.config;if(!config._isEnabled||!config._options._isFocusAssignmentEnabled||$element.length===0){return this}function perform(){if($element.attr("tabindex")===undefined){$element.attr({tabindex:"0","data-a11y-force-focus":"true"})}if(options.preventScroll){const y=$(window).scrollTop();try{$element[0].focus({preventScroll:true})}catch(e){}switch(device$1.browser){case"internet explorer":case"microsoft edge":case"safari":window.scrollTo(null,y);}}else{$element[0].focus()}}if(options.defer){_.defer(perform)}else{perform()}return this}normalize(htmls){htmls=[...arguments].filter(Boolean).filter(_.isString).join(" ");const text=$("<div>"+htmls+"</div>").text();return text.replace(this._htmlCharRegex,"")}removeBreaks(htmls){htmls=[...arguments].filter(Boolean).filter(_.isString).join(" ");const $div=$("<div>"+htmls+"</div>");const stack=[$div[0]];let stackIndex=0;const outputs=[];do{if(stack[stackIndex].childNodes.length){const nodes=stack[stackIndex].childNodes;const usable=nodes.filter(node=>{const isTextNode=node.nodeType===3;if(isTextNode){return true}const isStyleElement=$(node).is(this.config._options._wrapStyleElements);if(isStyleElement){return true}return false});outputs.push.apply(outputs,usable);stack.push.apply(stack,nodes)}stackIndex++}while(stackIndex<stack.length);let rtnText="";outputs.forEach(function(item){rtnText+=item.outerHTML||item.textContent});return rtnText}scrollEnable($elements){this._scroll.enable($elements);return this}scrollDisable($elements){this._scroll.disable($elements);return this}popupOpened($popupElement){this._popup.opened($popupElement);return this}popupClosed($focusElement){this._popup.closed($focusElement);return this}setPopupCloseTo($focusElement){return this._popup.setCloseTo($focusElement)}}const a11y=new A11y;var a11y$1=__AMD("core/js/a11y",a11y);class DrawerItemView extends Backbone.View{className(){return"drawer__menu drawer__item"}attributes(){return{role:"listitem"}}initialize(){this.listenTo(Adapt$1,"drawer:empty",this.remove);this.render()}events(){return{"click .drawer__item-btn":"onDrawerItemClicked"}}render(){const data=this.model.toJSON();const template=Handlebars.templates["drawerItem"];$(this.el).html(template(data)).appendTo(".drawer__holder");return this}onDrawerItemClicked(event){event.preventDefault();const eventCallback=this.model.get("eventCallback");Adapt$1.trigger(eventCallback)}}DrawerItemView.type="drawerItem";var DrawerItemView$1=__AMD("core/js/views/drawerItemView",DrawerItemView);class DrawerView extends Backbone.View{className(){return"drawer u-display-none"}attributes(){return{role:"dialog","aria-modal":"true","aria-labelledby":"drawer-heading","aria-hidden":"true"}}initialize(){this._isVisible=false;this.disableAnimation=Adapt$1.config.has("_disableAnimation")?Adapt$1.config.get("_disableAnimation"):false;this.drawerDir=Adapt$1.config.get("_defaultDirection")==="rtl"?"left":"right";this.drawerDuration=Adapt$1.config.get("_drawer")?._duration??400;this.setupEventListeners();this.render()}setupEventListeners(){this.listenTo(Adapt$1,{"navigation:toggleDrawer":this.toggleDrawer,"drawer:triggerCustomView":this.openCustomView,"drawer:closeDrawer":this.onCloseDrawer,remove:this.onRemove,"drawer:remove":this.remove});this.onKeyUp=this.onKeyUp.bind(this);this.setupEscapeKey()}setupEscapeKey(){$(window).on("keyup",this.onKeyUp)}onKeyUp(event){if(event.which!==27)return;event.preventDefault();this.onCloseDrawer()}events(){return{"click .drawer__back":"onBackButtonClicked","click .drawer__close":"onCloseClicked"}}render(){const template=Handlebars.templates.drawer;$(this.el).html(template({_globals:Adapt$1.course.get("_globals")})).prependTo("body");const shadowTemplate=Handlebars.templates.shadow;$(shadowTemplate()).prependTo("body");_.defer(this.postRender.bind(this));return this}postRender(){this.$("a, button, input, select, textarea").attr("tabindex",-1);this.checkIfDrawerIsAvailable()}openCustomView(view,hasBackButton){this.$(".js-drawer-holder").removeAttr("role");this._hasBackButton=hasBackButton;this._isCustomViewVisible=true;Adapt$1.trigger("drawer:empty");this.showDrawer();this.$(".drawer__holder").html(view)}checkIfDrawerIsAvailable(){const isEmptyDrawer=this.collection.length===0;$(".js-nav-drawer-btn").toggleClass("u-display-none",isEmptyDrawer);if(isEmptyDrawer){Adapt$1.trigger("drawer:noItems")}}onBackButtonClicked(event){event.preventDefault();this.showDrawer(true)}onCloseClicked(event){event.preventDefault();this.hideDrawer()}onCloseDrawer($toElement){this.hideDrawer($toElement)}onRemove(){this.hideDrawer()}toggleDrawer(){if(this._isVisible&&this._isCustomViewVisible===false){this.hideDrawer();return}this.showDrawer(true)}showDrawer(emptyDrawer){this.$el.removeClass("u-display-none").removeAttr("aria-hidden");if(!this._isVisible){a11y$1.popupOpened(this.$el);a11y$1.scrollDisable("body");this._isVisible=true}this.$("a, button, input, select, textarea").attr("tabindex",0);if(emptyDrawer){this.$(".drawer__back").addClass("u-display-none");this._isCustomViewVisible=false;this.emptyDrawer();if(this.collection.models.length===1){Adapt$1.trigger(this.collection.models[0].get("eventCallback"));this._isCustomViewVisible=false}else{this.renderItems();Adapt$1.trigger("drawer:openedItemView")}}else{const hideDrawerBackButton=!this._hasBackButton||this.collection.models.length<=1;this.$(".drawer__back").toggleClass("u-display-none",hideDrawerBackButton);Adapt$1.trigger("drawer:openedCustomView")}const complete=()=>{this.addShadowEvent();$(".js-nav-drawer-btn").attr("aria-expanded",true);Adapt$1.trigger("drawer:opened");a11y$1.focusFirst(this.$el,{defer:true})};const direction={};if(this.disableAnimation){$(".js-shadow").removeClass("u-display-none");$(".js-drawer-holder").scrollTop(0);direction[this.drawerDir]=0;this.$el.css(direction);complete()}else{$(".js-shadow").velocity({opacity:1},{duration:this.drawerDuration,begin:()=>{$(".js-shadow").removeClass("u-display-none");$(".js-drawer-holder").scrollTop(0);complete()}});const easing=Adapt$1.config.get("_drawer")?._showEasing||"easeOutQuart";direction[this.drawerDir]=0;this.$el.velocity(direction,this.drawerDuration,easing)}}emptyDrawer(){this.$(".drawer__holder").empty()}renderItems(){Adapt$1.trigger("drawer:empty");this.emptyDrawer();const isList=this.collection.length>1;if(isList)this.$(".js-drawer-holder").attr("role","list");else this.$(".js-drawer-holder").removeAttr("role");this.collection.forEach(model=>new DrawerItemView$1({model}))}hideDrawer($toElement){if(!this._isVisible)return;const direction={};a11y$1.popupClosed($toElement);this._isVisible=false;a11y$1.scrollEnable("body");if(this.disableAnimation){direction[this.drawerDir]=-this.$el.width();this.$el.css(direction).addClass("u-display-none").attr("aria-hidden","true");$(".js-shadow").addClass("u-display-none");this.$(".js-drawer-holder").removeAttr("role");Adapt$1.trigger("drawer:closed");$(".js-nav-drawer-btn").attr("aria-expanded",false)}else{const easing=Adapt$1.config.get("_drawer")?._hideEasing||"easeInQuart";direction[this.drawerDir]=-this.$el.width();this.$el.velocity(direction,this.drawerDuration,easing,()=>{this.$el.addClass("u-display-none").attr("aria-hidden","true");this.$(".js-drawer-holder").removeAttr("role");$(".js-nav-drawer-btn").attr("aria-expanded",false);Adapt$1.trigger("drawer:closed")});$(".js-shadow").velocity({opacity:0},{duration:this.drawerDuration,complete(){$(".js-shadow").addClass("u-display-none")}})}this._isCustomViewVisible=false;this.removeShadowEvent()}addShadowEvent(){$(".js-shadow").one("click touchstart",()=>this.onCloseDrawer())}removeShadowEvent(){$(".js-shadow").off("click touchstart")}remove(){super.remove();$(window).off("keyup",this.onKeyUp);Adapt$1.trigger("drawer:empty");this.collection.reset();$(".js-shadow").remove()}}Object.assign(DrawerView,{childContainer:".js-drawer-holder",childView:DrawerItemView$1});var DrawerView$1=__AMD("core/js/views/drawerView",DrawerView);const DrawerCollection=new Backbone.Collection(null,{comparator:"drawerOrder"});const Drawer={};Drawer.addItem=function(drawerObject,eventCallback){drawerObject.eventCallback=eventCallback;DrawerCollection.add(drawerObject)};Drawer.triggerCustomView=function(view,hasBackButton){if(hasBackButton!==false){hasBackButton=true}Adapt$1.trigger("drawer:triggerCustomView",view,hasBackButton)};Adapt$1.on({"adapt:start"(){new DrawerView$1({collection:DrawerCollection})},"app:languageChanged"(){Adapt$1.trigger("drawer:remove")}});var drawer=__AMD("core/js/drawer",Drawer);var AdaptSubsetCollection=__AMD("core/js/collections/adaptSubsetCollection",class AdaptSubsetCollection extends AdaptCollection{initialize(models,options){super.initialize(models,options);this.parent=options.parent;this.listenTo(this.parent,"reset",this.loadSubset)}loadSubset(){this.set(this.parent.filter(model=>model instanceof this.model));this._byAdaptID=this.groupBy("_id")}});var ModelEvent=__AMD("core/js/modelEvent",class ModelEvent extends Backbone.Controller{initialize(type,target,value){this.type=type;this.target=target;this.value=value;this.canBubble=true;this.deepPath=[target];this.timeStamp=null}stopPropagation(){this.canBubble=false}addPath(target){this.deepPath.unshift(target)}});var AdaptModel=__AMD("core/js/models/adaptModel",class AdaptModel extends LockingModel{toJSON(){const json={...this.attributes};delete json._children;delete json._parent;return $.extend(true,{},json)}get(name){switch(name){case"_parent":case"_children":logging$1.deprecated("Use model.getChildren() or model.getParent() instead of model.get('_children') or model.get('_parent')");}return super.get(name)}defaults(){return{_canShowFeedback:true,_classes:"",_canReset:true,_canRequestChild:false,_isComplete:false,_isInteractionComplete:false,_isA11yRegionEnabled:false,_isA11yCompletionDescriptionEnabled:true,_requireCompletionOf:-1,_isEnabled:true,_isResetOnRevisit:false,_isAvailable:true,_isOptional:false,_isRendered:false,_isReady:false,_isVisible:true,_isVisited:false,_isLocked:false,_isHidden:false}}get trackingPosition(){const firstDescendant=this.getAllDescendantModels(false).concat([this])[0];const nearestTrackingIdModel=[firstDescendant].concat(firstDescendant.getAncestorModels()).find(model=>model.has("_trackingId"));if(!nearestTrackingIdModel)return;const trackingId=nearestTrackingIdModel.get("_trackingId");let trackingIdDescendants=[nearestTrackingIdModel].concat(nearestTrackingIdModel.getAllDescendantModels(true));trackingIdDescendants=trackingIdDescendants.filter(model=>!(model.isTypeGroup("component")&&model.get("_isTrackable")===false));const indexInTrackingIdDescendants=trackingIdDescendants.findIndex(descendant=>descendant===this);if(indexInTrackingIdDescendants>=0){return[trackingId,indexInTrackingIdDescendants]}const trackingIdAncestors=nearestTrackingIdModel.getAncestorModels();const ancestorDistance=trackingIdAncestors.findIndex(ancestor=>ancestor===this);return[trackingId,-(ancestorDistance+1)]}parse(data){if(data._isResetOnRevisit==="false"){data._isResetOnRevisit=false}return data}trackable(){return["_id","_isComplete","_isInteractionComplete","_isVisited"]}trackableType(){return[String,Boolean,Boolean,Boolean]}bubblingEvents(){return["change:_isComplete","change:_isInteractionComplete","change:_isActive","change:_isVisited"]}setupModel(){if(this.hasManagedChildren){this.setupChildListeners()}this.init();_.defer(()=>{if(this.hasManagedChildren){this.checkCompletionStatus();this.checkInteractionCompletionStatus();this.checkLocking();this.checkVisitedStatus()}this.setupTrackables()})}setupTrackables(){const originalTrackableStateFunction=this.triggerTrackableState;this.triggerTrackableState=_.compose(()=>{this.triggerTrackableState.isQueued=true},_.debounce(()=>{originalTrackableStateFunction.apply(this);this.triggerTrackableState.isQueued=false},17));this.listenTo(this,"change",_ref=>{let{changed}=_ref;if(this.triggerTrackableState.isQueued||!Adapt$1.attributes._isStarted){return}const trackablePropertyNames=_.result(this,"trackable",[]);const changedPropertyNames=Object.keys(changed);const isTrackable=changedPropertyNames.find(item=>{return trackablePropertyNames.includes(item)});if(isTrackable){this.triggerTrackableState()}})}setupChildListeners(){const children=this.getChildren();if(!children.length){return}this.listenTo(children,{all:this.onAll,bubble:this.bubble,"change:_isVisited":this.checkVisitedStatus,"change:_isReady":this.checkReadyStatus,"change:_isComplete":this.onIsComplete,"change:_isInteractionComplete":this.checkInteractionCompletionStatus})}init(){}getTrackableState(){const trackable=this.resultExtend("trackable",[]);const json=this.toJSON();const args=trackable;args.unshift(json);return _.pick(...args)}setTrackableState(state){const trackable=this.resultExtend("trackable",[]);const args=trackable;args.unshift(state);state=_.pick(...args);this.set(state);return this}triggerTrackableState(){Adapt$1.trigger("state:change",this,this.getTrackableState())}reset(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"hard";let canReset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.get("_canReset");if(!canReset)return false;switch(type){case"hard":case true:this.set({_isEnabled:true,_isComplete:false,_isInteractionComplete:false});return true;case"soft":this.set({_isEnabled:true,_isInteractionComplete:false});return true;}return false}checkReadyStatus(model,value){if(value===false){return false}const children=this.getAvailableChildModels();if(children.find(child=>child.get("_isReady")===false&&child.get("_isRendered"))){return false}this.set("_isReady",true);return true}setReadyStatus(){this.set("_isReady",true)}checkVisitedStatus(){const children=this.getAvailableChildModels();const isVisited=children.some(child=>child.get("_isVisited")||child.get("_isComplete")||child.get("_isInteractionComplete"));if(isVisited)this.set("_isVisited",true);return isVisited}setVisitedStatus(){if(!this.get("_isReady")||!this.get("_isRendered"))return;this.set("_isVisited",true)}setCompletionStatus(){if(!this.get("_isVisible"))return;this.set({_isComplete:true,_isInteractionComplete:true,_isVisited:true})}checkCompletionStatus(){Adapt$1.checkingCompletion();_.defer(this.checkCompletionStatusFor.bind(this),"_isComplete")}checkInteractionCompletionStatus(){Adapt$1.checkingCompletion();_.defer(this.checkCompletionStatusFor.bind(this),"_isInteractionComplete")}checkCompletionStatusFor(){let completionAttribute=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"_isComplete";let completed=false;const children=this.getAvailableChildModels();const requireCompletionOf=this.get("_requireCompletionOf");if(requireCompletionOf===-1){completed=children.every(child=>{return child.get(completionAttribute)||child.get("_isOptional")})}else{completed=children.filter(child=>{return child.get(completionAttribute)&&!child.get("_isOptional")}).length>=requireCompletionOf}this.set(completionAttribute,completed);Adapt$1.checkedCompletion()}getTypeGroup(){}isTypeGroup(typeGroup){const hasUpperCase=/[A-Z]+/.test(typeGroup);const isPluralized=typeGroup.slice(-1)==="s";const lowerCased=typeGroup.toLowerCase();const singular=isPluralized&&lowerCased.slice(0,-1);const singularLowerCased=(singular||lowerCased).toLowerCase();if(isPluralized||hasUpperCase){logging$1.deprecated(`'${typeGroup}' appears pluralized or contains uppercase characters, suggest using the singular, lowercase type group '${singularLowerCased}'.`)}const pluralizedLowerCaseTypes=[singularLowerCased,!isPluralized&&`${lowerCased}s`].filter(Boolean);const typeGroups=this.getTypeGroups();if(_.intersection(pluralizedLowerCaseTypes,typeGroups).length){return true}return false}getTypeGroups(){if(this._typeGroups)return this._typeGroups;const typeGroups=[this.get("_type")];let parentClass=this;while(parentClass=Object.getPrototypeOf(parentClass)){if(!Object.prototype.hasOwnProperty.call(parentClass,"getTypeGroup"))continue;typeGroups.push(parentClass.getTypeGroup.call(this))}return this._typeGroups=_.uniq(typeGroups.filter(Boolean).map(s=>s.toLowerCase()))}findAncestor(ancestorType){const parent=this.getParent();if(!parent)return;if(!ancestorType||parent.isTypeGroup(ancestorType)){return parent}return parent.findAncestor(ancestorType)}findDescendantModels(descendants,options){const allDescendantsModels=this.getAllDescendantModels();const returnedDescendants=allDescendantsModels.filter(model=>{return model.isTypeGroup(descendants)});if(!options){return returnedDescendants}if(options.where){return returnedDescendants.filter(descendant=>{for(const property in options.where){const value=options.where[property];if(descendant.get(property)!==value){return false}}return true})}}getAllDescendantModels(isParentFirst){const descendants=[];if(!this.hasManagedChildren){return descendants}const children=this.getChildren();children.models.forEach(child=>{if(!child.hasManagedChildren){descendants.push(child);return}const subDescendants=child.getAllDescendantModels(isParentFirst);if(isParentFirst===true){descendants.push(child)}descendants.push(...subDescendants);if(isParentFirst!==true){descendants.push(child)}});return descendants}findRelativeModel(relativeString){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!relativeString)return this;let relativeDescriptorObjects=Adapt$1.parseRelativeString(relativeString);if(!Array.isArray(relativeDescriptorObjects))relativeDescriptorObjects=[relativeDescriptorObjects];const find=_ref2=>{let{type,offset,inset}=_ref2;const isInset=inset!==null;const isOffset=offset!==null;const rootModel=options.limitParentId?data$1.findById(options.limitParentId):isInset?this:Adapt$1.course;const increment=isOffset?offset:inset;const searchBackwards=increment<0;let moveBy=Math.abs(increment);let movementCount=0;const hasDescendantsOfType=Boolean(this.findDescendantModels(type).length);if(isInset&&!hasDescendantsOfType)return undefined;if(isOffset&&hasDescendantsOfType){moveBy--}if(isInset&&searchBackwards){moveBy--}const searchDescendants=searchBackwards?[rootModel,...rootModel.getAllDescendantModels(true)].reverse():[...rootModel.getAllDescendantModels(false),rootModel];const modelId=this.get("_id");const searchFromIndex=isInset?0:searchDescendants.findIndex(searchDescendant=>searchDescendant.get("_id")===modelId);const hasFilterFunction=typeof options.filter==="function";if(options.loop){const totalOfType=searchDescendants.reduce((count,model)=>{if(!model.isTypeGroup(type))return count;return++count},0);moveBy=moveBy%totalOfType;searchDescendants.push(...searchDescendants.slice(0))}for(let i=searchFromIndex,l=searchDescendants.length;i<l;i++){const descendant=searchDescendants[i];if(!descendant.isTypeGroup(type))continue;const isSelf=i===searchFromIndex;if(!isSelf&&hasFilterFunction&&!options.filter(descendant))continue;if(movementCount>moveBy){break}if(movementCount===moveBy){return descendant}movementCount++}};const nextDescriptor=relativeDescriptorObjects.slice(1).reduce((output,_ref3)=>{let{type,offset,inset}=_ref3;const isInset=inset!==null;const isOffset=offset!==null;if(isOffset)return`${output}@${type}${offset<0?offset:`+${offset}`}`;if(isInset)return`${output}@${type}=${inset}`;return`${output}@${type}`},"");const foundModel=find(relativeDescriptorObjects[0]);if(nextDescriptor){return foundModel?.findRelativeModel(nextDescriptor)}return foundModel}get hasManagedChildren(){return true}getChildren(){if(this._childrenCollection){return this._childrenCollection}let childrenCollection;if(!this.hasManagedChildren){childrenCollection=new Backbone.Collection}else{const id=this.get("_id");const children=data$1.filter(model=>model.get("_parentId")===id);childrenCollection=new Backbone.Collection(children)}if(this.get("_type")==="block"&&childrenCollection.length===2&&childrenCollection.models[0].get("_layout")!=="left"){childrenCollection.comparator="_layout";childrenCollection.sort()}this.setChildren(childrenCollection);return this._childrenCollection}setChildren(children){this._childrenCollection=children;this.set("_children",children)}getAvailableChildModels(){return this.getChildren().where({_isAvailable:true})}getParent(){if(this._parentModel){return this._parentModel}const parentId=this.get("_parentId");if(!parentId)return;this.setParent(data$1.findById(parentId));return this._parentModel}setParent(parent){this._parentModel=parent;this.set("_parentId",this._parentModel.get("_id"));this.set("_parent",this._parentModel)}getAncestorModels(shouldIncludeChild){const parents=[];let context=this;if(shouldIncludeChild)parents.push(context);while(context.has("_parentId")){context=context.getParent();parents.push(context)}return parents.length?parents:null}getSiblings(passSiblingsAndIncludeSelf){const id=this.get("_id");const parentId=this.get("_parentId");let siblings;if(!passSiblingsAndIncludeSelf){if(this._hasSiblingsAndSelf===false){return this.get("_siblings")}siblings=data$1.filter(model=>{return model.get("_parentId")===parentId&&model.get("_id")!==id});this._hasSiblingsAndSelf=false}else{if(this._hasSiblingsAndSelf){return this.get("_siblings")}siblings=data$1.filter(model=>{return model.get("_parentId")===parentId});this._hasSiblingsAndSelf=true}const siblingsCollection=new Backbone.Collection(siblings);this.set("_siblings",siblingsCollection);return siblingsCollection}setOnChildren(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}this.set(...args);if(!this.hasManagedChildren)return;const children=this.getChildren();children.models.forEach(child=>child.setOnChildren(...args))}setOptional(value){logging$1.deprecated("Use model.set('_isOptional', value) as setOptional() may be removed in the future");this.set({_isOptional:value})}checkLocking(){const lockType=this.get("_lockType");if(!lockType)return;switch(lockType){case"sequential":this.setSequentialLocking();break;case"unlockFirst":this.setUnlockFirstLocking();break;case"lockLast":this.setLockLastLocking();break;case"custom":this.setCustomLocking();break;default:console.warn(`AdaptModel.checkLocking: unknown _lockType '${lockType}' found on ${this.get("_id")}`);}}setSequentialLocking(){const children=this.getAvailableChildModels();children.slice(1).forEach((child,index)=>{const previousChild=children[index];const isLockedByPreviousChild=previousChild.get("_isLocked")||!previousChild.get("_isComplete")&&!previousChild.get("_isOptional");child.set("_isLocked",isLockedByPreviousChild)},false)}setUnlockFirstLocking(){const children=this.getAvailableChildModels();const firstChild=children.shift();const isLockedByFirstChild=!firstChild.get("_isComplete")&&!firstChild.get("_isOptional");children.forEach(child=>child.set("_isLocked",isLockedByFirstChild))}setLockLastLocking(){const children=this.getAvailableChildModels();const lastChild=children.pop();const isLockedByChildren=children.some(child=>!child.get("_isComplete")&&!child.get("_isOptional"));lastChild.set("_isLocked",isLockedByChildren)}setCustomLocking(){const children=this.getAvailableChildModels();children.forEach(child=>child.set("_isLocked",this.shouldLock(child)))}shouldLock(child){const lockedBy=child.get("_lockedBy");if(!lockedBy)return false;return lockedBy.some(id=>{try{const anotherModel=data$1.findById(id);return anotherModel.get("_isAvailable")&&(anotherModel.get("_isLocked")||!anotherModel.get("_isComplete")&&!anotherModel.get("_isOptional"))}catch(e){console.warn(`AdaptModel.shouldLock: unknown _lockedBy ID '${id}' found on ${child.get("_id")}`);return false}})}onIsComplete(){this.checkCompletionStatus();this.checkLocking()}checkIfResetOnRevisit(){const isResetOnRevisit=this.get("_isResetOnRevisit");this.reset(isResetOnRevisit)}deepClone(){let modifier=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;const ModelClass=this.constructor;const clonedModel=new ModelClass(this.toJSON());if(modifier){modifier(clonedModel,this)}let clonedId=clonedModel.get("_id");const hasId=Boolean(clonedId);const shouldAssignUniqueId=this.get("_id")===clonedId;if(hasId&&shouldAssignUniqueId){const cid=_.uniqueId(ModelClass.prototype.cidPrefix||"c");clonedId=`${clonedId}_${cid}`;clonedModel.set("_id",clonedId)}if(hasId){data$1.add(clonedModel)}if(this.hasManagedChildren){this.getChildren().each(child=>{if(!child.deepClone){throw new Error("Cannot deepClone child.")}child.deepClone((clone,child)=>{if(hasId){clone.set("_parentId",clonedId)}if(modifier){modifier(clone,child)}})})}clonedModel.getParent().getChildren().add(clonedModel);clonedModel.setupModel();return clonedModel}onAll(type,model,value){if(!_.result(this,"bubblingEvents").includes(type))return;const event=new ModelEvent(type,model,value);this.bubble(event)}bubble(event){if(!event.canBubble)return;event.addPath(this);this.trigger(`bubble:${event.type} bubble`,event)}});var ContentObjectModel=__AMD("core/js/models/contentObjectModel",class ContentObjectModel extends AdaptModel{get _parent(){logging$1.deprecated("contentObjectModel._parent, use contentObjectModel.getParent() instead, parent models are defined by the JSON");const isParentCourse=this.get("_parentId")===Adapt$1.course.get("_id");if(isParentCourse){return"course"}return"contentObjects"}get _siblings(){logging$1.deprecated("contentObjectModel._siblings, use contentObjectModel.getSiblings() instead, sibling models are defined by the JSON");return"contentObjects"}get _children(){logging$1.deprecated("contentObjectModel._children, use contentObjectModel.hasManagedChildren instead, child models are defined by the JSON");return null}getTypeGroup(){return"contentobject"}});class ArticleModel extends AdaptModel{get _parent(){logging$1.deprecated("articleModel._parent, use articleModel.getParent() instead, parent models are defined by the JSON");return"contentObjects"}get _siblings(){logging$1.deprecated("articleModel._siblings, use articleModel.getSiblings() instead, sibling models are defined by the JSON");return"articles"}get _children(){logging$1.deprecated("articleModel._children, use articleModel.hasManagedChildren instead, child models are defined by the JSON");return"blocks"}getTypeGroup(){return"article"}}components$1.register("article",{model:ArticleModel});var ArticleModel$1=__AMD("core/js/models/articleModel",ArticleModel);class BlockModel extends AdaptModel{get _parent(){logging$1.deprecated("blockModel._parent, use blockModel.getParent() instead, parent models are defined by the JSON");return"articles"}get _siblings(){logging$1.deprecated("blockModel._siblings, use blockModel.getSiblings() instead, sibling models are defined by the JSON");return"blocks"}get _children(){logging$1.deprecated("blockModel._children, use blockModel.hasManagedChildren instead, child models are defined by the JSON");return"components"}getTypeGroup(){return"block"}}components$1.register("block",{model:BlockModel});var BlockModel$1=__AMD("core/js/models/blockModel",BlockModel);class ComponentModel extends AdaptModel{get _parent(){logging$1.deprecated("componentModel._parent, use componentModel.getParent() instead, parent models are defined by the JSON");return"blocks"}get _siblings(){logging$1.deprecated("componentModel._siblings, use componentModel.getSiblings() instead, sibling models are defined by the JSON");return"components"}getTypeGroup(){return"component"}defaults(){return AdaptModel.resultExtend("defaults",{_isA11yComponentDescriptionEnabled:true,_shouldStoreAttempts:true,_userAnswer:null,_attemptStates:null})}trackable(){return AdaptModel.resultExtend("trackable",["_userAnswer","_attemptStates"])}trackableType(){return AdaptModel.resultExtend("trackableType",[Array,Array])}get hasManagedChildren(){return false}init(){if(Adapt$1.get("_isStarted")){this.onAdaptInitialize();return}this.listenToOnce(Adapt$1,"adapt:initialize",this.onAdaptInitialize)}onAdaptInitialize(){this.restoreUserAnswers()}restoreUserAnswers(){}storeUserAnswer(){}resetUserAnswer(){this.set("_userAnswer",null)}reset(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"hard";let canReset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.get("_canReset");const wasReset=super.reset(type,canReset);if(!wasReset)return false;this.resetUserAnswer();return true}getAttemptState(){let object=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.toJSON();const trackables=this.trackable();const types=this.trackableType();trackables.find((name,index)=>{if(name!=="_attemptStates")return false;trackables.splice(index,1);types.splice(index,1);return true});const values=trackables.map(n=>object[n]);const booleans=values.filter((v,i)=>types[i]===Boolean).map(Boolean);const numbers=values.filter((v,i)=>types[i]===Number).map(v=>Number(v)||0);const arrays=values.filter((v,i)=>types[i]===Array);return[numbers,booleans,arrays]}getAttemptObject(){let state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getAttemptState();const trackables=this.trackable();const types=this.trackableType();trackables.find((name,index)=>{if(name!=="_attemptStates")return false;trackables.splice(index,1);types.splice(index,1);return true});const numbers=(state[0]||[]).slice(0);const booleans=(state[1]||[]).slice(0);const arrays=(state[2]||[]).slice(0);const object={};trackables.forEach((n,i)=>{if(n==="_id")return;switch(types[i]){case Number:object[n]=numbers.shift();break;case Boolean:object[n]=booleans.shift();break;case Array:object[n]=arrays.shift();break;}});return object}setAttemptObject(object){let silent=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;this.set(object,{silent})}addAttemptObject(){let object=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getAttemptObject();const attemptStates=this.get("_attemptStates")||[];const state=this.getAttemptState(object);attemptStates.push(state);this.set("_attemptStates",attemptStates)}getAttemptObjects(){const states=this.get("_attemptStates")||[];return states.map(state=>this.getAttemptObject(state))}}components$1.register("component",{model:ComponentModel});var ComponentModel$1=__AMD("core/js/models/componentModel",ComponentModel);class MenuModel extends ContentObjectModel{get _children(){logging$1.deprecated("menuModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON");return"contentObjects"}getTypeGroup(){return"menu"}setCustomLocking(){const children=this.getAvailableChildModels();children.forEach(child=>{child.set("_isLocked",this.shouldLock(child));if(!(child instanceof MenuModel))return;child.checkLocking()})}}components$1.register("menu",{model:MenuModel});var MenuModel$1=__AMD("core/js/models/menuModel",MenuModel);class CourseModel extends MenuModel$1{get _parent(){logging$1.deprecated("courseModel._parent, use courseModel.getParent() instead, parent models are defined by the JSON");return null}get _siblings(){logging$1.deprecated("courseModel._siblings, use courseModel.getSiblings() instead, sibling models are defined by the JSON");return null}getTypeGroup(){return"course"}}components$1.register("course",{model:CourseModel});__AMD("core/js/models/courseModel",CourseModel);class PageModel extends ContentObjectModel{get _children(){logging$1.deprecated("pageModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON");return"articles"}getTypeGroup(){return"page"}}components$1.register("page",{model:PageModel});__AMD("core/js/models/pageModel",PageModel);var ChildEvent=__AMD("core/js/childEvent",class ChildEvent extends Backbone.Controller{initialize(type,target,model){this.type=type;this.target=target;this.isForced=false;this.isStoppedImmediate=false;this.isStoppedNext=false;this.hasRequestChild=false;this._model=model}get model(){return this._model}set model(model){if(this.type!=="requestChild"){logging$1.warn(`Cannot change model in ${this.type} event.`);return}if(this._model){logging$1.warn(`Cannot inject two models in one sitting. ${model.get("_id")} attempts to overwrite ${this._model.get("_id")}`);return}this._model=model;this.hasRequestChild=true}reset(){this.isStoppedImmediate=false;this.isStoppedNext=false}force(){this.isForced=true}stop(){let immediate=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(!immediate){return this.stopNext()}this.isStoppedImmediate=true}stopNext(){this.isStoppedNext=true}close(){this.trigger("closed")}});var TemplateRenderEvent=__AMD("core/js/templateRenderEvent",class TemplateRenderEvent extends Backbone.Controller{initialize(type,name,mode,value,args){this.type=type;this.name=name;this.mode=mode;this.value=value;this.args=args}});var register=__AMD("core/js/reactHelpers",function register(name,component){templates[name]=function(){const mode="reactTemplate";for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}const preRenderEvent=new TemplateRenderEvent(`${mode}:preRender`,name,mode,null,args);Adapt$1.trigger(preRenderEvent.type,preRenderEvent);const value=component(...preRenderEvent.args);const postRenderEvent=new TemplateRenderEvent(`${mode}:postRender`,name,mode,value,preRenderEvent.args);Adapt$1.trigger(postRenderEvent.type,postRenderEvent);return postRenderEvent.value}});(function(){const original=React__default["default"].createElement;React__default["default"].createElement=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}const name=args[0];const mode="reactElement";const preRenderEvent=new TemplateRenderEvent(`${mode}:preRender`,name,mode,null,args);Adapt$1.trigger(preRenderEvent.type,preRenderEvent);const value=original(...preRenderEvent.args);const postRenderEvent=new TemplateRenderEvent(`${mode}:postRender`,name,mode,value,preRenderEvent.args);Adapt$1.trigger(postRenderEvent.type,postRenderEvent);return postRenderEvent.value}})();const templates={};function html(html){if(!html)return;logging$1.deprecated("reactHelpers.html please use react dangerouslySetInnerHTML instead: https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml");return{__html:html}}function compile(template){for(var _len3=arguments.length,args=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){args[_key3-1]=arguments[_key3]}const output=Handlebars.compile(template)(...args);return output}function classes(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5]}return _.uniq(_.flatten(args).filter(Boolean).join(" ").split(" ")).join(" ")}function prefixClasses(prefixes){for(var _len6=arguments.length,args=new Array(_len6>1?_len6-1:0),_key6=1;_key6<_len6;_key6++){args[_key6-1]=arguments[_key6]}const classes=_.flatten(args).filter(Boolean);const prefixed=_.flatten(prefixes.map(prefix=>classes.map(className=>`${prefix}${className}`)));return _.uniq(prefixed.join(" ").split(" ")).join(" ")}class AdaptView extends Backbone.View{attributes(){return{"data-adapt-id":this.model.get("_id"),role:"presentation"}}initialize(){this.listenTo(this.model,{"change:_isVisible":this.toggleVisibility,"change:_isHidden":this.toggleHidden,"change:_isComplete":this.onIsCompleteChange});this.isJSX=(this.constructor.template||"").includes(".jsx");if(this.isJSX){this._classSet=new Set(_.result(this,"className").trim().split(/\s+/));this.listenTo(this.model,"all",this.changed);const children=this.model?.getChildren?.();children&&this.listenTo(children,"all",this.changed);this.listenTo(Adapt$1,"device:changed",this.changed)}this.model.set({_globals:Adapt$1.course.get("_globals"),_isReady:false});this._isRemoved=false;if(location$1._currentId===this.model.get("_id")){Adapt$1.parentView=this}this.preRender();this.render();this.setupOnScreenHandler()}preRender(){}async postRender(){await this.addChildren()}render(){const type=this.constructor.type;Adapt$1.trigger(`${type}View:preRender view:preRender`,this);if(this.isJSX){this.changed()}else{const data=this.model.toJSON();data.view=this;const template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))}Adapt$1.trigger(`${type}View:render view:render`,this);_.defer(async()=>{if(this._isRemoved)return;await this.postRender();Adapt$1.trigger(`${type}View:postRender view:postRender`,this)});return this}changed(){let eventName=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(!this.isJSX){throw new Error("Cannot call changed on a non-react view")}if(typeof eventName==="string"&&eventName.startsWith("bubble")){return}const props={...this,...this.model.toJSON(),_globals:Adapt$1.course.get("_globals")};const Template=templates[this.constructor.template.replace(".jsx","")];this.updateViewProperties();ReactDOM__default["default"].render(React__default["default"].createElement(Template,props),this.el)}updateViewProperties(){const classesToAdd=_.result(this,"className").trim().split(/\s+/);classesToAdd.forEach(i=>this._classSet.add(i));const classesToRemove=[...this._classSet].filter(i=>!classesToAdd.includes(i));classesToRemove.forEach(i=>this._classSet.delete(i));this._setAttributes({..._.result(this,"attributes"),id:_.result(this,"id")});this.$el.removeClass(classesToRemove).addClass(classesToAdd)}setupOnScreenHandler(){const onscreen=this.model.get("_onScreen");if(!onscreen?._isEnabled)return;this.$el.addClass(`has-animation ${onscreen._classes}-before`);this.$el.on("onscreen.adaptView",(e,m)=>{if(!m.onscreen)return;const minVerticalInview=onscreen._percentInviewVertical||33;if(m.percentInviewVertical<minVerticalInview)return;this.$el.addClass(`${onscreen._classes}-after`).off("onscreen.adaptView")})}async addChildren(){this.nthChild=this.nthChild||0;let addedCount=await this.addDescendants(false);while(true){const models=this.model.getAvailableChildModels();const event=this._getAddChildEvent(models[this.nthChild]);if(!event){break}if(event.isForced){event.reset()}if(event.isStoppedImmediate||!event.model){const subsequentModels=models.slice(this.nthChild);subsequentModels.forEach(model=>model.setOnChildren("_isRendered",false));break}const model=event.model;model.set({_isRendered:true,_nthChild:++this.nthChild});const ChildView=this.constructor.childView||components$1.getViewClass(model);if(!ChildView){throw new Error(`The component '${model.attributes._id}' ('${model.attributes._component}') has not been installed, and so is not available in your project.`)}const childView=new ChildView({model});this.addChildView(childView);addedCount++;if(event.isStoppedNext){break}}if(!addedCount){return addedCount}this.model.set("_isReady",false);return addedCount}addChildView(childView){const childViews=this.getChildViews()||[];childViews.push(childView);this.setChildViews(childViews);const $parentContainer=this.$(this.constructor.childContainer);switch(childView.model.get("_renderPosition")){case"outer-append":this.$el.append(childView.$el);break;case"inner-append":default:$parentContainer.append(childView.$el);break;}Adapt$1.trigger("view:childAdded",this,childView);return childView}async addDescendants(){let addedDescendantCount=0;const childViews=this.getChildViews();if(!childViews){return addedDescendantCount}for(let i=0,l=childViews.length;i<l;i++){const view=childViews[i];addedDescendantCount=view.addChildren?await view.addChildren():0;if(addedDescendantCount){break}}if(!addedDescendantCount){this.model.checkReadyStatus();return addedDescendantCount}this.model.set("_isReady",false);return addedDescendantCount}async whenReady(){if(this.model.get("_isReady"))return;return new Promise(resolve=>{const onReadyChange=(model,value)=>{if(!value)return;this.stopListening(this.model,"change:_isReady",onReadyChange);resolve()};this.listenTo(this.model,"change:_isReady",onReadyChange);this.model.checkReadyStatus()})}_getAddChildEvent(model){const isRequestChild=!model;const event=new ChildEvent(null,this,model);if(isRequestChild){const canRequestChild=this.model.get("_canRequestChild");if(!canRequestChild){return}event.type="requestChild";Adapt$1.trigger("view:requestChild",event);if(!event.hasRequestChild){event.close();return}}event.type="addChild";Adapt$1.trigger("view:addChild",event);event.close();return event}findDescendantViews(isParentFirst){const descendants=[];const childViews=this.getChildViews();childViews?.forEach(view=>{if(isParentFirst)descendants.push(view);const children=view.findDescendantViews?.(isParentFirst);if(children)descendants.push(...children);if(!isParentFirst)descendants.push(view)});return descendants}setReadyStatus(){this.model.setReadyStatus()}setCompletionStatus(){this.model.setCompletionStatus()}resetCompletionStatus(type){if(!this.model.get("_canReset"))return;const descendantComponents=this.model.findDescendantModels("component");if(descendantComponents.length===0){this.model.reset(type)}else{descendantComponents.forEach(model=>model.reset(type))}}preRemove(){const type=this.constructor.type;Adapt$1.trigger(`${type}View:preRemove view:preRemove`,this)}remove(){const type=this.constructor.type;this.preRemove();Adapt$1.trigger(`${type}View:remove view:remove`,this);this._isRemoved=true;this.stopListening();wait$1.for(end=>{if(this.isJSX){ReactDOM__default["default"].unmountComponentAtNode(this.el)}this.$el.off("onscreen.adaptView");super.remove();_.defer(()=>{Adapt$1.trigger(`${type}View:postRemove view:postRemove`,this)});end()});return this}setVisibility(){return this.model.get("_isVisible")?"":"u-visibility-hidden"}toggleVisibility(){this.$el.toggleClass("u-visibility-hidden",!this.model.get("_isVisible"))}setHidden(){return this.model.get("_isHidden")?"u-display-none":""}toggleHidden(){this.$el.toggleClass("u-display-none",this.model.get("_isHidden"))}onIsCompleteChange(model,isComplete){this.$el.toggleClass("is-complete",isComplete)}getChildViews(){if(!this._childViews)return this._childViews;return Object.entries(this._childViews).map(_ref=>{let[key,value]=_ref;return value})}setChildViews(value){this._childViews=value}get childViews(){logging$1.deprecated("view.childViews use view.getChildViews() and view.setChildViews([])");if(Array.isArray(this._childViews)){return _.indexBy(this._childViews,view=>view.model.get("_id"))}return this._childViews}set childViews(value){logging$1.deprecated("view.childViews use view.getChildViews() and view.setChildViews([])");this.setChildViews(value)}}AdaptView.className="";var AdaptView$1=__AMD("core/js/views/adaptView",AdaptView);var ContentObjectView=__AMD("core/js/views/contentObjectView",class ContentObjectView extends AdaptView$1{attributes(){return AdaptView$1.resultExtend("attributes",{role:"main"},this)}className(){return[this.constructor.type,"contentobject",this.constructor.className,this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].filter(Boolean).join(" ")}preRender(){$.inview.lock(this.constructor.type+"View");this.disableAnimation=Adapt$1.config.has("_disableAnimation")?Adapt$1.config.get("_disableAnimation"):false;this.$el.css("opacity",0);this.listenTo(this.model,"change:_isReady",this.isReady);this._loadingErrorTimeout=setTimeout(()=>data$1.logReadyError(this),10000)}render(){const type=this.constructor.type;Adapt$1.trigger(`${type}View:preRender contentObjectView:preRender view:preRender`,this);if(this.isReact){this.changed()}else{const data=this.model.toJSON();data.view=this;const template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))}Adapt$1.trigger(`${type}View:render contentObjectView:render view:render`,this);_.defer(()=>{if(this._isRemoved)return;this.postRender();Adapt$1.trigger(`${type}View:postRender contentObjectView:postRender view:postRender`,this)});return this}async isReady(){if(!this.model.get("_isReady")||this._isTriggeredReady)return;this._isTriggeredReady=true;clearTimeout(this._loadingErrorTimeout);delete this._loadingErrorTimeout;const type=this.constructor.type;const performIsReady=async()=>{Adapt$1.trigger(`${type}View:preReady contentObjectView:preReady view:preReady`,this);await wait$1.queue();$(".js-loading").hide();if(Adapt$1.get("_shouldContentObjectScrollTop")!==false){$(window).scrollTop(0)}Adapt$1.trigger(`${type}View:ready contentObjectView:ready view:ready`,this);$.inview.unlock(`${type}View`);const styleOptions={opacity:1};if(this.disableAnimation){this.$el.css(styleOptions);$.inview();_.defer(()=>{Adapt$1.trigger(`${type}View:postReady contentObjectView:postReady view:postReady`,this)})}else{this.$el.velocity(styleOptions,{duration:"fast",complete:()=>{$.inview();Adapt$1.trigger(`${type}View:postReady contentObjectView:postReady view:postReady`,this)}})}$(window).scroll()};_.defer(performIsReady)}async renderTo(id){const isRenderToSelf=id===this.model.get("_id");if(isRenderToSelf)return;let models=this.model.getAllDescendantModels(true).filter(model=>model.get("_isAvailable"));const index=models.findIndex(model=>model.get("_id")===id);if(index===-1){throw new Error(`Cannot renderTo "${id}" as it isn't a descendant.`)}const model=models[index];if(model.get("_isRendered")&&model.get("_isReady")){return}models=models.slice(0,index+1);const isLocked=models.some(model=>model.get("_isLocked"));if(isLocked)throw new Error(`Cannot renderTo ${id} as it is preceded by locked content`);const ids=_.indexBy(models,model=>model.get("_id"));const forceUntilId=event=>{const addingId=event.model.get("_id");if(!ids[addingId])return;event.force();if(addingId!==id)return;Adapt$1.off("view:addChild",forceUntilId)};Adapt$1.on("view:addChild",forceUntilId);await this.addChildren();await this.whenReady();if(!model.get("_isRendered")||!model.get("_isReady")){throw new Error(`Cannot renderTo "${id}".`)}}preRemove(){const type=this.constructor.type;Adapt$1.trigger(`${type}View:preRemove contentObjectView:preRemove view:preRemove`,this)}remove(){const type=this.constructor.type;this.preRemove();Adapt$1.trigger(`${type}View:remove contentObjectView:remove view:remove`,this);this._isRemoved=true;wait$1.for(end=>{if(this.isReact){ReactDOM__default["default"].unmountComponentAtNode(this.el)}this.$el.off("onscreen.adaptView");this.findDescendantViews().reverse().forEach(view=>{view.remove()});this.setChildViews(null);super.remove();_.defer(()=>{Adapt$1.trigger(`${type}View:postRemove contentObjectView:postRemove view:postRemove`,this);this.trigger("postRemove")});end()});return this}destroy(){this.remove();if(Adapt$1.parentView===this){Adapt$1.parentView=null}}});class PageView extends ContentObjectView{remove(){if(this.$pageLabel){this.$pageLabel.remove()}super.remove()}}Object.assign(PageView,{childContainer:".article__container",type:"page",template:"page"});components$1.register("page",{view:PageView});__AMD("core/js/views/pageView",PageView);class ArticleView extends AdaptView$1{className(){return["article",this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}}Object.assign(ArticleView,{childContainer:".block__container",type:"article",template:"article"});components$1.register("article",{view:ArticleView});__AMD("core/js/views/articleView",ArticleView);class BlockView extends AdaptView$1{className(){return["block",this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}}Object.assign(BlockView,{childContainer:".component__container",type:"block",template:"block"});components$1.register("block",{view:BlockView});__AMD("core/js/views/blockView",BlockView);class MPABC extends Backbone.Controller{initialize(){this.listenTo(data$1,{loading:this.waitForDataLoaded,loaded:this.onDataLoaded});this.setupSubsetCollections()}waitForDataLoaded(){wait$1.begin()}onDataLoaded(){wait$1.end()}setupSubsetCollections(){Adapt$1.contentObjects=new AdaptSubsetCollection(null,{parent:data$1,model:ContentObjectModel});Adapt$1.articles=new AdaptSubsetCollection(null,{parent:data$1,model:ArticleModel$1});Adapt$1.blocks=new AdaptSubsetCollection(null,{parent:data$1,model:BlockModel$1});Adapt$1.components=new AdaptSubsetCollection(null,{parent:data$1,model:ComponentModel$1})}}const mpabc=new MPABC;var mpabc$1=__AMD("core/js/mpabc",mpabc);var NotifyPushView=__AMD("core/js/views/notifyPushView",class NotifyPushView extends Backbone.View{className(){const classes=["notify-push",this.model.get("_classes"),this.model.get("_type")==="a11y-push"&&"aria-label"].filter(Boolean).join(".");return classes}attributes(){return{role:"dialog","aria-labelledby":"notify-push-heading","aria-modal":"false"}}initialize(){this.listenTo(Adapt$1,{"notify:pushShown notify:pushRemoved":this.updateIndexPosition,remove:this.remove});this.listenTo(this.model.collection,{remove:this.updateIndexPosition,"change:_index":this.updatePushPosition});this.preRender();this.render()}events(){return{"click .js-notify-push-close-btn":"closePush","click .js-notify-push-inner":"triggerEvent"}}preRender(){this.hasBeenRemoved=false}render(){const data=this.model.toJSON();const template=Handlebars.templates.notifyPush;this.$el.html(template(data)).appendTo(".notify__push-container");_.defer(this.postRender.bind(this));return this}postRender(){this.$el.addClass("is-active");_.delay(this.closePush.bind(this),this.model.get("_timeout"));Adapt$1.trigger("notify:pushShown")}closePush(event){if(event){event.preventDefault()}if(this.hasBeenRemoved===false){this.hasBeenRemoved=true;this.$el.removeClass("is-active");_.delay(()=>{this.model.collection.remove(this.model);Adapt$1.trigger("notify:pushRemoved",this);this.remove()},600)}}triggerEvent(event){Adapt$1.trigger(this.model.get("_callbackEvent"));this.closePush()}updateIndexPosition(){if(this.hasBeenRemoved)return;const models=this.model.collection.models;models.forEach((model,index)=>{if(!model.get("_isActive"))return;model.set("_index",index);this.updatePushPosition()})}updatePushPosition(){if(this.hasBeenRemoved){return}if(typeof this.model.get("_index")!=="undefined"){const elementHeight=this.$el.height();const offset=20;const navigationHeight=$(".nav").height();const currentIndex=this.model.get("_index");let flippedIndex=currentIndex===0?1:0;if(this.model.collection.where({_isActive:true}).length===1){flippedIndex=0}const positionLowerPush=(elementHeight+offset)*flippedIndex+navigationHeight+offset;this.$el.css("top",positionLowerPush)}}});var NotifyModel=__AMD("core/js/models/notifyModel",class NotifyModel extends LockingModel{defaults(){return{_isActive:false,_showIcon:false,_timeout:3000}}});var NotifyPushCollection=__AMD("core/js/collections/notifyPushCollection",class NotifyPushCollection extends Backbone.Collection{initialize(){this.model=NotifyModel;this.listenTo(this,"add",this.onPushAdded);this.listenTo(Adapt$1,"notify:pushRemoved",this.onRemovePush)}onPushAdded(model){this.checkPushCanShow(model)}checkPushCanShow(model){if(!this.canShowPush())return;model.set("_isActive",true);this.showPush(model)}canShowPush(){const availablePushNotifications=this.where({_isActive:true});return availablePushNotifications.length<2}showPush(model){new NotifyPushView({model:model})}onRemovePush(view){const inactivePushNotifications=this.where({_isActive:false});if(inactivePushNotifications.length>0){this.checkPushCanShow(inactivePushNotifications[0])}}});var NotifyPopupView=__AMD("core/js/views/notifyPopupView",class NotifyPopupView extends Backbone__default["default"].View{className(){return`notify ${this.model.get("_classes")||""}`}attributes(){return Object.assign({role:"dialog","aria-labelledby":"notify-heading","aria-modal":"true"},this.model.get("_attributes"))}events(){return{"click .js-notify-btn-alert":"onAlertButtonClicked","click .js-notify-btn-prompt":"onPromptButtonClicked","click .js-notify-close-btn":"onCloseButtonClicked","click .js-notify-shadow-click":"onShadowClicked"}}initialize(_ref){let{notify}=_ref;this.notify=notify;_.bindAll(this,"resetNotifySize","onKeyUp");this.disableAnimation=Adapt$1.config.get("_disableAnimation")||false;this.isOpen=false;this.hasOpened=false;this.setupEventListeners();this.render()}setupEventListeners(){this.listenTo(Adapt$1,{remove:this.closeNotify,"notify:resize":this.resetNotifySize,"notify:cancel":this.cancelNotify,"notify:close":this.closeNotify,"device:resize":this.resetNotifySize});this.setupEscapeKey()}setupEscapeKey(){$(window).on("keyup",this.onKeyUp)}onKeyUp(event){if(event.which!==27)return;event.preventDefault();this.cancelNotify()}render(){const data=this.model.toJSON();const template=Handlebars.templates.notifyPopup;this.$el.css("visibility","hidden");this.$el.html(template(data)).appendTo(".notify__popup-container");this.$(".notify__popup").css("visibility","hidden");this.$el.css("visibility","visible");this.showNotify();return this}onAlertButtonClicked(event){event.preventDefault();this.closeNotify();Adapt$1.trigger(this.model.get("_callbackEvent"),this)}onPromptButtonClicked(event){event.preventDefault();this.closeNotify();Adapt$1.trigger($(event.currentTarget).attr("data-event"),this)}onCloseButtonClicked(event){event.preventDefault();this.cancelNotify()}onShadowClicked(event){event.preventDefault();if(this.model.get("_closeOnShadowClick")===false)return;this.cancelNotify()}cancelNotify(){if(this.model.get("_isCancellable")===false)return;this.closeNotify();Adapt$1.trigger("notify:cancelled",this)}resetNotifySize(){if(!this.hasOpened)return;this.resizeNotify()}resizeNotify(){const windowHeight=$(window).height();const notifyHeight=this.$(".notify__popup-inner").outerHeight();const isFullWindow=notifyHeight>=windowHeight;this.$(".notify__popup").css({height:isFullWindow?"100%":"auto",top:isFullWindow?0:"","margin-top":isFullWindow?"":-(notifyHeight/2),"overflow-y":isFullWindow?"scroll":"","-webkit-overflow-scrolling":isFullWindow?"touch":""})}async showNotify(){this.isOpen=true;await this.addSubView();this.notify.stack.push(this);this.$previousActiveElement=$(document.activeElement);Adapt$1.trigger("notify:opened",this);this.$el.imageready(this.onLoaded.bind(this))}onLoaded(){if(this.disableAnimation){this.$(".notify__shadow").css("display","block")}else{this.$(".notify__shadow").velocity({opacity:0},{duration:0}).velocity({opacity:1},{duration:400,begin:()=>{this.$(".notify__shadow").css("display","block")}})}this.resizeNotify();if(this.disableAnimation){this.$(".notify__popup").css("visibility","visible");this.onOpened()}else{this.$(".notify__popup").velocity({opacity:0},{duration:0}).velocity({opacity:1},{duration:400,begin:()=>{this.$(".notify__popup").css("visibility","visible");this.onOpened()}})}}onOpened(){$.inview();this.hasOpened=true;a11y$1.popupOpened(this.$el);a11y$1.scrollDisable("body");$("html").addClass("notify");a11y$1.focusFirst(this.$(".notify__popup"),{defer:false})}async addSubView(){this.subView=this.model.get("_view");if(this.model.get("_shouldRenderId")&&this.model.get("_id")){const model=data$1.findById(this.model.get("_id"));const View=components$1.getViewClass(model);this.subView=new View({model})}if(!this.subView)return;this.subView.$el.on("resize",this.resetNotifySize);this.$(".notify__content-inner").append(this.subView.$el);if(!(this.subView instanceof AdaptView$1)||this.subView.model.get("_isReady"))return;return new Promise(resolve=>{const check=(model,value)=>{if(!value)return;this.subView.model.off("change:_isReady",check);resolve()};this.subView.model.on("change:_isReady",check)})}closeNotify(){const stackItem=this.notify.stack[this.notify.stack.length-1];if(this!==stackItem)return;this.notify.stack.pop();if(!this.isOpen)return;this.isOpen=false;if(this.hasOpened){this.onCloseReady();return}this.listenToOnce(Adapt$1,"popup:opened",()=>{_.defer(this.onCloseReady.bind(this))})}onCloseReady(){if(this.disableAnimation){this.$(".notify__popup").css("visibility","hidden");this.$el.css("visibility","hidden");this.remove()}else{this.$(".notify__popup").velocity({opacity:0},{duration:400,complete:()=>{this.$(".notify__popup").css("visibility","hidden")}});this.$(".notify__shadow").velocity({opacity:0},{duration:400,complete:()=>{this.$el.css("visibility","hidden");this.remove()}})}a11y$1.scrollEnable("body");$("html").removeClass("notify");a11y$1.popupClosed(this.$previousActiveElement);Adapt$1.trigger("notify:closed",this)}remove(){this.removeSubView();$(window).off("keyup",this.onKeyUp);super.remove(...arguments)}removeSubView(){if(!this.subView)return;this.subView.$el.off("resize",this.resetNotifySize);if(this.subView instanceof AdaptView$1){const views=[...this.subView.findDescendantViews(),this.subView];views.forEach(view=>{view.model.set("_isReady",false);view.remove()})}else{this.subView.remove()}this.subView=null}});var NotifyView=__AMD("core/js/views/notifyView",class NotifyView extends Backbone.View{className(){return"notify__container"}initialize(){this._stack=[];this.notifyPushes=new NotifyPushCollection;this.listenTo(Adapt$1,{"notify:popup":this._deprecated.bind(this,"popup"),"notify:alert":this._deprecated.bind(this,"alert"),"notify:prompt":this._deprecated.bind(this,"prompt"),"notify:push":this._deprecated.bind(this,"push")});this.render()}get stack(){return this._stack}get isOpen(){return this.stack.length>0}_deprecated(type,notifyObject){logging$1.deprecated(`NOTIFY DEPRECATED: Adapt.trigger('notify:${type}', notifyObject); is no longer supported, please use notify.${type}(notifyObject);`);return this.create(notifyObject,{_type:type})}render(){const notifyTemplate=Handlebars.templates.notify;this.$el.html(notifyTemplate());this.$el.appendTo("body")}create(notifyObject,defaults){notifyObject=_.defaults({},notifyObject,defaults,{_type:"popup",_shouldRenderId:false,_isCancellable:true,_showCloseButton:true,_closeOnShadowClick:true});switch(notifyObject._type){case"a11y-push":case"push":this.notifyPushes.push(notifyObject);return;}return new NotifyPopupView({model:new NotifyModel(notifyObject),notify:this})}popup(notifyObject){return this.create(notifyObject,{_type:"popup"})}alert(notifyObject){return this.create(notifyObject,{_type:"alert"})}prompt(notifyObject){return this.create(notifyObject,{_type:"prompt"})}push(notifyObject){return this.create(notifyObject,{_type:"push"})}});const notify=new NotifyView;var notify$1=__AMD("core/js/notify",notify);var RouterModel=__AMD("core/js/models/routerModel",class RouterModel extends LockingModel{defaults(){return{_canNavigate:true,_shouldNavigateFocus:true}}lockedAttributes(){return{_canNavigate:false,_shouldNavigateFocus:false}}});class Router extends Backbone.Router{routes(){return{"":"handleRoute","id/:id":"handleRoute",":pluginName(/*location)(/*action)":"handleRoute"}}initialize(_ref){let{model}=_ref;this.navigateToElement=this.navigateToElement.bind(this);this._isBackward=false;this.model=model;this._navigationRoot=null;this._isCircularNavigationInProgress=false;this.showLoading();this.$wrapper=$("#wrapper");this.$html=$("html");this.listenToOnce(Adapt$1,"app:dataReady",this.setDocumentTitle);this.listenTo(Adapt$1,"router:navigateTo",this.navigateToArguments)}get rootModel(){return this._navigationRoot||Adapt$1.course}set rootModel(model){this._navigationRoot=model}showLoading(){$(".js-loading").show()}hideLoading(){$(".js-loading").hide()}setDocumentTitle(){const currentModel=location$1._currentModel;const hasSubTitle=currentModel&&currentModel!==router.rootModel&&currentModel.get("title");const title=[this.rootModel.get("title"),hasSubTitle&&currentModel.get("title")].filter(Boolean).join(" | ");this.listenToOnce(Adapt$1,"contentObjectView:preRender",()=>{const escapedTitle=$(`<div>${title}</div>`).text();document.title=escapedTitle})}navigateToArguments(args){args=args.filter(v=>v!==null);const options={trigger:false,replace:false};if(args.length===1&&data$1.findById(args[0])){this.navigate("#/id/"+args[0],options);return}if(args.length<=3){this.navigate("#/"+args.join("/"),options);return}logging$1.deprecated("Use Backbone.history.navigate or window.location.href instead of Adapt.trigger('router:navigateTo')");this.handleRoute(...args)}handleRoute(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}args=args.filter(v=>v!==null);if(this.model.get("_canNavigate")){this._isCircularNavigationInProgress=false}if(this._isCircularNavigationInProgress===false){Adapt$1.trigger("router:navigate",args)}if(this.model.get("_canNavigate")){this.model.set("_canNavigate",false,{pluginName:"adapt"});this._isBackward=false;if(args.length<=1){return this.handleId(...args)}return this.handlePluginRouter(...args)}if(this._isCircularNavigationInProgress){this._isCircularNavigationInProgress=false;return}this._isCircularNavigationInProgress=true;Adapt$1.trigger("router:navigationCancelled",args);Backbone.history.history[this._isBackward?"forward":"back"]();this._isBackward=false}async handlePluginRouter(pluginName,location,action){const pluginLocation=[pluginName,location&&`-${location}`,action&&`-${action}`].filter(Boolean).join("");await this.updateLocation(pluginLocation,null,null,null);Adapt$1.trigger("router:plugin:"+pluginName,pluginName,location,action);Adapt$1.trigger("router:plugin",pluginName,location,action);this.model.set("_canNavigate",true,{pluginName:"adapt"})}async handleId(id){const rootModel=router.rootModel;let model=!id?rootModel:data$1.findById(id);if(!model){this.model.set("_canNavigate",true,{pluginName:"adapt"});return}const isContentObject=model.isTypeGroup?.("contentobject");const navigateToId=model.get("_id");model=isContentObject?model:model.findAncestor("contentobject");id=model.get("_id");const isRoot=model===rootModel;if(isRoot&&Adapt$1.course.has("_start")){const startController=Adapt$1.course.get("_start");if(startController._isEnabled===true&&startController._isMenuDisabled===true){return}}if(model.get("_isLocked")&&Adapt$1.config.get("_forceRouteLocking")){logging$1.warn("Unable to navigate to locked id: "+id);this.model.set("_canNavigate",true,{pluginName:"adapt"});if(location$1._previousId===undefined){return this.navigate("#/",{trigger:true,replace:true})}return this.navigateBack()}this.showLoading();await Adapt$1.remove();const isCourse=model.isTypeGroup?.("course");const type=isCourse?"menu":model.get("_type");const newLocation=isCourse?"course":`${type}-${id}`;model.set("_isVisited",true);await this.updateLocation(newLocation,type,id,model);Adapt$1.once("contentObjectView:ready",()=>{this.model.set("_canNavigate",true,{pluginName:"adapt"});this.handleNavigationFocus()});Adapt$1.trigger(`router:${type} router:contentObject`,model);const ViewClass=components$1.getViewClass(model);const isMenu=model.isTypeGroup?.("menu");if(!ViewClass&&isMenu){logging$1.deprecated(`Using event based menu view instantiation for '${components$1.getViewName(model)}'`);return}if(!isMenu){_.invoke(model.getAllDescendantModels(),"checkIfResetOnRevisit");await Adapt$1.deferUntilCompletionChecked()}this.$wrapper.append(new ViewClass({model}).$el);if(!isContentObject&&!this.isScrolling){await this.navigateToElement("."+navigateToId,{replace:true,duration:400})}}async updateLocation(currentLocation,type,id,currentModel){location$1._previousModel=location$1._currentModel;location$1._previousId=location$1._currentId;location$1._previousContentType=location$1._contentType;location$1._currentModel=currentModel;location$1._currentId=id;location$1._contentType=type;location$1._currentLocation=currentLocation;if(type==="menu"){location$1._lastVisitedType="menu";location$1._lastVisitedMenu=id}else if(type==="page"){location$1._lastVisitedType="page";location$1._lastVisitedPage=id}this.setDocumentTitle();this.setGlobalClasses();Adapt$1.trigger("router:location",location$1);await wait$1.queue()}setGlobalClasses(){const currentModel=location$1._currentModel;const htmlClasses=currentModel?.get("_htmlClasses")||"";const classes=location$1._currentId?`location-${location$1._contentType} location-id-${location$1._currentId}`:`location-${location$1._currentLocation}`;const currentClasses=`${classes} ${htmlClasses}`;this.$html.removeClass(location$1._previousClasses).addClass(currentClasses).attr("data-location",location$1._currentLocation);this.$wrapper.removeClass().addClass(classes).attr("data-location",location$1._currentLocation);location$1._previousClasses=currentClasses}handleNavigationFocus(){if(!this.model.get("_shouldNavigateFocus"))return;a11y$1.focus("body")}navigateBack(){this._isBackward=true;Backbone.history.history.back()}navigateToCurrentRoute(force){if(!this.model.get("_canNavigate")&&!force){return}if(!location$1._currentId){return}const currentId=location$1._currentModel.get("_id");const isRoot=location$1._currentModel===this.rootModel;const route=isRoot?"#/":"#/id/"+currentId;this.navigate(route,{trigger:true,replace:true})}navigateToPreviousRoute(force){if(!this.model.get("_canNavigate")&&!force){return}const currentModel=location$1._currentModel;const previousModel=location$1._previousModel;if(!currentModel){return this.navigateBack()}if(location$1._currentModel?.isTypeGroup("menu")){return this.navigateToParent()}if(previousModel){return this.navigateBack()}this.navigateToParent()}navigateToParent(force){if(!this.model.get("_canNavigate")&&!force){return}const parentId=location$1._currentModel.get("_parentId");const parentModel=data$1.findById(parentId);const isRoot=parentModel===this.rootModel;const route=isRoot?"#/":"#/id/"+parentId;this.navigate(route,{trigger:true})}navigateToHomeRoute(force){if(!this.model.get("_canNavigate")&&!force){return}this.navigate("#/",{trigger:true})}async navigateToElement(selector){let settings=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const currentModelId=typeof selector==="string"&&selector.replace(/\./g,"").split(" ")[0];const isSelectorAnId=data$1.hasId(currentModelId);if(isSelectorAnId){const currentModel=data$1.findById(currentModelId);const contentObject=currentModel.isTypeGroup?.("contentobject")?currentModel:currentModel.findAncestor("contentobject");const contentObjectId=contentObject.get("_id");const isNotInCurrentContentObject=contentObjectId!==location$1._currentId;if(currentModel&&(!currentModel.get("_isRendered")||!currentModel.get("_isReady")||isNotInCurrentContentObject)){const shouldReplace=settings.replace||false;if(isNotInCurrentContentObject){this.isScrolling=true;this.navigate(`#/id/${currentModelId}`,{trigger:true,replace:shouldReplace});this.model.set("_shouldNavigateFocus",false,{pluginName:"adapt"});await new Promise(resolve=>Adapt$1.once("contentObjectView:ready",_.debounce(()=>{this.model.set("_shouldNavigateFocus",true,{pluginName:"adapt"});resolve()},1)));this.isScrolling=false}await Adapt$1.parentView.renderTo(currentModelId)}if(currentModel&&selector===currentModel.get("_id")){selector=`.${selector}`}}const isElementUnavailable=!$(selector).length;if(isElementUnavailable){logging$1.warn(`router.navigateToElement, selector not found in document: ${selector}`);return}const newLocation=location$1._contentType?location$1._contentType:location$1._currentLocation;Adapt$1.trigger(`${newLocation}:scrollTo`,selector);const disableScrollToAnimation=Adapt$1.config.has("_disableAnimation")?Adapt$1.config.get("_disableAnimation"):false;if(disableScrollToAnimation){settings.duration=0}else if(!settings.duration){settings.duration=$.scrollTo.defaults.duration}const $wrapper=$("#wrapper");let offsetTop=-parseInt($wrapper.css("padding-top"));if($(selector).hasClass("component")){offsetTop-=$(selector).find(".aria-label").height()||0}if(!settings.offset)settings.offset={top:offsetTop,left:0};if(settings.offset.top===undefined)settings.offset.top=offsetTop;if(settings.offset.left===undefined)settings.offset.left=0;if(settings.offset.left===0)settings.axis="y";if(Adapt$1.get("_canScroll")!==false){$.scrollTo(selector,settings)}await new Promise(resolve=>{_.delay(()=>{a11y$1.focusNext(selector);Adapt$1.trigger(`${location$1}:scrolledTo`,selector);resolve()},settings.duration+300)})}get(){logging$1.deprecated("router.get, please use router.model.get");return this.model.get(...arguments)}set(){logging$1.deprecated("router.set, please use router.model.set");return this.model.set(...arguments)}}const router=new Router({model:new RouterModel(null,{reset:true})});var router$1=__AMD("core/js/router",router);class Scrolling extends Backbone.Controller{initialize(){this.scrollTo=this.scrollTo.bind(this);this.$html=$("html");this.isLegacyScrolling=true;Adapt$1.once("configModel:dataLoaded",this._loadConfig.bind(this))}_loadConfig(){const config=Adapt$1.config.get("_scrollingContainer");if(!config?._isEnabled)return;const limitTo=config._limitToSelector;const isIncluded=!limitTo||this.$html.is(limitTo)||this.$html.hasClass(limitTo);if(!isIncluded)return;this.isLegacyScrolling=false;this._windowScrollFix();this._addStyling();this._updateScrollbarWidth();this.listenTo(Adapt$1,"device:resize",this._updateScrollbarWidth)}_addStyling(){this.$html.addClass("adapt-scrolling")}_updateScrollbarWidth(){const $tester=$("<div class=\"outer\" style=\"overflow:scroll; visibility: hidden; position:fixed; top: 0; left: 0;\"><div class=\"inner\"> </div></div>\"");$("body").append($tester);const scrollBarWidth=$tester.outerWidth()-$tester.find(".inner").outerWidth();$tester.remove();const documentStyle=document.documentElement.style;documentStyle.setProperty("--adapt-scrollbar-width",`${scrollBarWidth}px`)}_windowScrollFix(){const body=document.body;const html=Adapt$1.scrolling.$html[0];const scrollY={get:()=>body.scrollTop,set:value=>body.scrollTop=value};const scrollX={get:()=>body.scrollLeft,set:value=>body.scrollLeft=value};const scrollHeight={get:()=>body.scrollHeight,set:value=>body.scrollHeight=value};const scrollWidth={get:()=>body.scrollWidth,set:value=>body.scrollWidth=value};Object.defineProperties(window,{scrollY,scrollX,pageYOffset:scrollY,pageXOffset:scrollX});Object.defineProperties(html,{scrollHeight,scrollWidth});window.scrollTo=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}const isObject=args.length===1&&typeof args[0]==="object"&&args[0]!==null;const left=(isObject?args[0].left:args[0])??null;const top=(isObject?args[0].top:args[1])??null;left!==null&&(body.scrollLeft=left);top!==null&&(body.scrollTop=top)};const MouseEvent=window.MouseEvent;Object.defineProperties(MouseEvent.prototype,{pageX:{get:function(){return this.clientX+scrollX.get()}},pageY:{get:function(){return this.clientY+scrollY.get()}}});const $window=$(window);$(document.body).on("scroll",()=>$window.scroll())}async scrollTo(selector){let settings=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};logging$1.deprecated("Adapt.scrollTo and Adapt.scrolling.scrollTo, use router.navigateToElement instead.");return router$1.navigateToElement(selector,settings)}}const scrolling=new Scrolling;var scrolling$1=__AMD("core/js/scrolling",scrolling);class StartController extends Backbone.Controller{initialize(){super.initialize(...arguments);this.model=null}loadCourseData(){this.model=new LockingModel(Adapt$1.course.get("_start"))}setStartLocation(){if(!this.isEnabled())return;window.history.replaceState("","",this.getStartHash())}returnToStartLocation(){const startIds=this.model.get("_startIds");if(startIds){startIds.forEach(startId=>startId._skipIfComplete=false)}window.location.hash=this.getStartHash(true)}getStartHash(alwaysForce){const startId=this.getStartId();const isRouteSpecified=window.location.href.indexOf("#")>-1;const shouldForceStartId=alwaysForce||this.model.get("_force");const shouldNavigateToStartId=startId&&(!isRouteSpecified||shouldForceStartId);if(shouldNavigateToStartId&&startId!==Adapt$1.course.get("_id")){return"#/id/"+startId}return window.location.hash||"#/"}isEnabled(){return Boolean(this.model?.get("_isEnabled"))}getStartId(){let startId=this.model.get("_id");const startIds=this.model.get("_startIds");if(!startIds?.length)return startId;const $html=$("html");for(let i=0,l=startIds.length;i<l;i++){const item=startIds[i];const className=item._className;const skipIfComplete=item._skipIfComplete;const model=data$1.findById(item._id);if(!model){console.log("startController: cannot find id",item._id);continue}if(skipIfComplete){if(model.get("_isComplete"))continue}if(!className||$html.is(className)||$html.hasClass(className)){startId=item._id;break}}return startId}}Adapt$1.once("adapt:start",()=>{startController.loadCourseData();startController.setStartLocation()});Adapt$1.on("navigation:returnToStart",()=>{startController.returnToStartLocation()});Adapt$1.on("app:languageChanged",()=>{wait$1.for(done=>{startController.loadCourseData();const hash=startController.isEnabled()?startController.getStartHash(false):"#/";router$1.navigate(hash,{trigger:true,replace:true});done()})});const startController=new StartController;var startController$1=__AMD("core/js/startController",startController);const COMPLETION_STATE=ENUM(["INCOMPLETE","COMPLETED","PASSED","FAILED"]);var COMPLETION_STATE$1=__AMD("core/js/enums/completionStateEnum",COMPLETION_STATE);class Tracking extends Backbone.Controller{initialize(){this._config={_requireContentCompleted:true,_requireAssessmentCompleted:false,_shouldSubmitScore:false};this._assessmentState=null;Adapt$1.once("configModel:dataLoaded",this.loadConfig.bind(this));Adapt$1.on("app:dataReady",this.setupEventListeners.bind(this))}setupEventListeners(){this.listenTo(Adapt$1,{"assessment:complete":this.onAssessmentComplete,"assessment:restored":this.onAssessmentRestored});if(this._config._requireContentCompleted){this.listenTo(Adapt$1.course,"change:_isComplete",this.checkCompletion)}}onAssessmentComplete(assessmentState){this._assessmentState=assessmentState;this.submitScore();if(this._config._requireAssessmentCompleted){this.checkCompletion()}}submitScore(){if(!this._config._shouldSubmitScore)return;if(this._assessmentState.isPercentageBased){offlineStorage$1.set("score",this._assessmentState.scoreAsPercent,0,100);return}offlineStorage$1.set("score",this._assessmentState.score,this._assessmentState.minScore,this._assessmentState.maxScore)}onAssessmentRestored(assessmentState){this._assessmentState=assessmentState}checkCompletion(){const completionData=this.getCompletionData();if(completionData.status===COMPLETION_STATE$1.INCOMPLETE){return}const canRetry=completionData.assessment?.canRetry===true;if(completionData.status===COMPLETION_STATE$1.FAILED&&canRetry){return}Adapt$1.trigger("tracking:complete",completionData);logging$1.debug("tracking:complete",completionData)}getCompletionData(){const completionData={status:COMPLETION_STATE$1.INCOMPLETE,assessment:null};if(this._config._requireContentCompleted&&!Adapt$1.course.get("_isComplete")){return completionData}if(this._config._requireAssessmentCompleted){if(!this._assessmentState){return completionData}completionData.status=this._assessmentState.isPass?COMPLETION_STATE$1.PASSED:COMPLETION_STATE$1.FAILED;completionData.assessment=this._assessmentState;return completionData}completionData.status=COMPLETION_STATE$1.COMPLETED;return completionData}loadConfig(){this._config=Adapt$1.config.get("_completionCriteria")??this._config;const newShouldSubmitScore=this._config._shouldSubmitScore;const legacyShouldSubmitScore=Adapt$1.config.get("_spoor")?._tracking?._shouldSubmitScore;if(legacyShouldSubmitScore!==undefined)logging$1.deprecated("config.json:_spoor._tracking._shouldSubmitScore, please use only config.json:_completionCriteria._shouldSubmitScore");this._config._shouldSubmitScore=legacyShouldSubmitScore??newShouldSubmitScore??true}}const tracking=new Tracking;var tracking$1=__AMD("core/js/tracking",tracking);const beginWait=()=>{logging$1.deprecated("Use wait.begin() as Adapt.trigger('plugin:beginWait') will be removed in the future");wait$1.begin()};const endWait=()=>{logging$1.deprecated("Use wait.end() as Adapt.trigger('plugin:endWait') will be removed in the future");wait$1.end()};const ready=()=>{if(wait$1.isWaiting()){return}const isEventListening=Adapt$1._events["plugins:ready"];if(!isEventListening){return}logging$1.deprecated("Use wait.queue(callback) as Adapt.on('plugins:ready', callback) will be removed in the future");Adapt$1.trigger("plugins:ready")};Adapt$1.listenTo(wait$1,"ready",ready);Adapt$1.on({"plugin:beginWait":beginWait,"plugin:endWait":endWait});Object.defineProperties(Adapt$1,{accessibility:{get(){a11y$1.log.deprecated("Adapt.accessibility has moved to a11y");return a11y$1}},a11y:{get(){logging$1.deprecated("Adapt.a11y, please use core/js/a11y directly");return a11y$1}},componentStore:{get(){logging$1.deprecated("Adapt.componentStore, please use core/js/components directly");return components$1._register}},data:{get(){logging$1.deprecated("Adapt.data, please use core/js/data directly");return data$1}},device:{get(){logging$1.deprecated("device, please use core/js/device directly");return device$1}},drawer:{get(){logging$1.deprecated("Adapt.drawer, please use core/js/drawer directly");return drawer}},findById:{get(){logging$1.deprecated("Adapt.findById, please use data.findById directly");return data$1.findById}},findViewByModelId:{get(){logging$1.deprecated("Adapt.findViewByModelId, please use data.findViewByModelId directly");return data$1.findViewByModelId}},findByTrackingPosition:{get(){logging$1.deprecated("Adapt.findByTrackingPosition, please use data.findByTrackingPosition directly");return data$1.findByTrackingPosition}},getViewName:{get(){logging$1.deprecated("Adapt.getViewName, please use components.getViewName instead");return components$1.getViewName}},getViewClass:{get(){logging$1.deprecated("Adapt.getViewClass, please use components.getViewClass instead");return components$1.getViewClass}},getModelName:{get(){logging$1.deprecated("Adapt.getModelName, please use components.getModelName instead");return components$1.getModelName}},getModelClass:{get(){logging$1.deprecated("Adapt.getModelClass, please use components.getModelClass instead");return components$1.getModelClass}},location:{get(){logging$1.deprecated("Adapt.location, please use core/js/location directly");return location$1}},log:{get(){logging$1.deprecated("Adapt.log, please use core/js/logging directly");return logging$1}},mpabc:{get(){logging$1.deprecated("Adapt.mpabc, please use core/js/mpabc directly");return mpabc$1}},notify:{get(){logging$1.deprecated("Adapt.notify, please use core/js/notify directly");return notify$1}},offlineStorage:{get(){logging$1.deprecated("offlineStorage, please use src/core/offlineStorage instead");return offlineStorage$1}},navigateToElement:{get(){logging$1.deprecated("Adapt.navigateToElement, please use router.navigateToElement");return router$1.navigateToElement}},register:{get(){logging$1.deprecated("Adapt.register, please use components.register instead");return components$1.register}},router:{get(){logging$1.deprecated("Adapt.router, please use core/js/router directly");return router$1}},scrolling:{get(){logging$1.deprecated("Adapt.scrolling, please use core/js/scrolling directly");return scrolling$1}},scrollTo:{get(){logging$1.deprecated("Adapt.scrollTo, please use router.navigateToElement");return scrolling$1.scrollTo}},startController:{get(){logging$1.deprecated("Adapt.startController, please use core/js/startController directly");return startController$1}},store:{get(){logging$1.deprecated("Adapt.store, please use core/js/components directly");return components$1._register}},tracking:{get(){logging$1.deprecated("Adapt.tracking, please use core/js/tracking directly");return tracking$1}},wait:{get(){logging$1.deprecated("Adapt.wait, please use src/core/wait instead");return wait$1}}});function onRender(cb){const intercept=(object,name,mode,cb)=>{return object[name]=cb.bind(object,object[name],name,mode)};Object.keys(Handlebars.templates).forEach(name=>{intercept(Handlebars.templates,name,"template",cb)});Object.keys(Handlebars.partials).forEach(name=>{intercept(Handlebars.partials,name,"partial",cb)})}onRender(function(template,name,mode){for(var _len=arguments.length,args=new Array(_len>3?_len-3:0),_key=3;_key<_len;_key++){args[_key-3]=arguments[_key]}const preRenderEvent=new TemplateRenderEvent(`${mode}:preRender`,name,mode,null,args);Adapt$1.trigger(preRenderEvent.type,preRenderEvent);const value=template(...preRenderEvent.args);const postRenderEvent=new TemplateRenderEvent(`${mode}:postRender`,name,mode,value,preRenderEvent.args);Adapt$1.trigger(postRenderEvent.type,postRenderEvent);return postRenderEvent.value});Adapt$1.on("app:dataReady",()=>{const config=Adapt$1.config.get("_fixes");if(config?._imgLazyLoad===false)return;applyImgLoadingFix()});function applyImgLoadingFix(){const findImgTag=/<img([^>]*)>/gi;const hasLoadingAttr=/ loading=/gi;Adapt$1.on("template:postRender partial:postRender",event=>{const imgTagsFound=event.value.match(findImgTag);if(!imgTagsFound){return}event.value=imgTagsFound.reduce((value,img)=>{if(hasLoadingAttr.test(img)){return value}return value.replace(img,img.replace(findImgTag,"<img loading=\"eager\"$1>"))},event.value)});Adapt$1.on("reactElement:preRender",event=>{if(event.name!=="img")return;const options=event.args[1]=event.args[1]||{};if(options&&options.hasOwnProperty("loading"))return;options.loading="eager"})}Adapt$1.on("app:dataReady",()=>{const config=Adapt$1.config.get("_fixes");if(config?._jsxReactHelpersHTML===false)return;applyReactHelpersHTML()});function applyReactHelpersHTML(){Adapt$1.on("reactElement:preRender",event=>{let[tagName,props,...children]=event.args;if(!children)return;if(!Array.isArray(children))children=[children];children=children.filter(Boolean);const hasSomeUnsafeConversions=children.some(c=>c?.__html);if(!hasSomeUnsafeConversions)return;const hasManyChildren=children.length>1;if(hasManyChildren){event.args=event.args.map(child=>{if(!child||!child.__html)return child;const attributes=Object.entries(props).map(_ref=>{let[name,value]=_ref;return`${name}="${value}"`}).join(" ");logging$1.warnOnce(`html() call should be the only child in its parent <${tagName} ${attributes}>`);return child.__html?HTMLReactParser__default["default"](child.__html):undefined});return}props=event.args[1]=event.args[1]||{};props.dangerouslySetInnerHTML=children[0];event.args.length=2})}const helpers$1={lowercase(text){return text.toLowerCase()},capitalise(text){return text.charAt(0).toUpperCase()+text.slice(1)},inc(index){return index+1},dec(index){return index-1},odd(index){return(index+1)%2===0?"even":"odd"},equals(value,text,block){return helpers$1.compare.call(this,value,"==",text,block)},compare(value,operator,text,block){switch(operator){case"===":if(value===text)return block.fn(this);break;case"=":case"==":if(value==text)return block.fn(this);break;case">=":if(value>=text)return block.fn(this);break;case"<=":if(value<=text)return block.fn(this);break;case">":if(value>text)return block.fn(this);break;case"<":if(value<text)return block.fn(this);break;}return block.inverse(this)},math(lvalue,operator,rvalue,options){lvalue=parseFloat(lvalue);rvalue=parseFloat(rvalue);switch(operator){case"+":return lvalue+rvalue;case"-":return lvalue-rvalue;case"*":return lvalue*rvalue;case"/":return lvalue/rvalue;case"%":return lvalue%rvalue;}},any(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}const specified=args.slice(0,-1);const block=args.slice(-1)[0];return specified.some(Boolean)?block.fn?block.fn(this):true:block.inverse?block.inverse(this):false},all(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}const specified=args.slice(0,-1);const block=args.slice(-1)[0];return specified.every(Boolean)?block.fn?block.fn(this):true:block.inverse?block.inverse(this):false},none(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}const specified=args.slice(0,-1);const block=args.slice(-1)[0];return!specified.some(Boolean)?block.fn?block.fn(this):true:block.inverse?block.inverse(this):false},compile(template,context){if(!template)return"";if(template instanceof Object)template=template.toString();const data=context?.data?.root?this:context;return Handlebars.compile(template)(data)},compile_a11y_text(template,context){logging$1.deprecated("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return helpers$1.compile.call(this,template,context)},compile_a11y_normalize(template,context){if(!template){return""}if(template instanceof Object)template=template.toString();return Handlebars.helpers.a11y_normalize.call(this,helpers$1.compile.call(this,template,context))},compile_a11y_remove_breaks(template,context){if(!template){return""}return Handlebars.helpers.a11y_remove_breaks.call(this,helpers$1.compile.call(this,template,context))},import_globals(context){if(context.data.root._globals){return""}context.data.root._globals=Adapt$1.course.get("_globals");return""},import_adapt(context){if(context.data.root.Adapt){return}const adapt=context.data.root.Adapt={};let i,l,name;const directImport=["config","course"];for(i=0,l=directImport.length;i<l;i++){name=directImport[i];adapt[name]=Adapt$1[name].toJSON()}const indexedImport=["contentObjects","articles","blocks","components"];for(i=0,l=indexedImport.length;i<l;i++){name=indexedImport[i];const importArray=Adapt$1[name].toJSON();const importIndex={};for(let i1=0,l1=importArray.length;i1<l1;i1++){const item=importArray[i1];importIndex[item._id]=item}adapt[name]=importIndex}return""},component_description(override,context){if(!this._isA11yComponentDescriptionEnabled){return}const isNotDefined=!this._globals._components?.["_"+this._component];if(isNotDefined){return}const hasOverride=arguments.length>1;let description;if(hasOverride){description=override;description=helpers$1.compile(description,context)}else{description=this._globals._components["_"+this._component].ariaRegion;description=helpers$1.compile(description,override)}if(!description){return}return new Handlebars.SafeString("<div class=\"aria-label\">"+description+"</div>")},a11y_text(text){logging$1.deprecated("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return text},a11y_normalize(htmls){return a11y$1.normalize.apply(a11y$1,arguments)},a11y_remove_breaks(htmls){return a11y$1.removeBreaks.apply(a11y$1,arguments)},a11y_aria_label(htmls){let values=Array.prototype.slice.call(arguments,0,-1);values=values.filter(Boolean);return new Handlebars.SafeString("<div class=\"aria-label\">"+values.join(" ")+"</div>")},a11y_aria_label_relative(htmls){let values=Array.prototype.slice.call(arguments,0,-1);values=values.filter(Boolean);return new Handlebars.SafeString("<div class=\"aria-label relative\">"+values.join(" ")+"</div>")},a11y_aria_image(texts){let values=Array.prototype.slice.call(arguments,0,-1);values=values.filter(Boolean);return new Handlebars.SafeString("<div class=\"aria-label\" role=\"img\" aria-label=\""+values.join(" ")+"\"></div>")},a11y_wrap_focus(){const cfg=Adapt$1.config.get("_accessibility");if(cfg._isPopupWrapFocusEnabled===false)return"";return new Handlebars.SafeString("<a class=\"a11y-focusguard a11y-ignore a11y-ignore-focus\" tabindex=\"0\" role=\"presentation\">&nbsp;</a>")},a11y_attrs_heading(level){logging$1.deprecated("a11y_attrs_heading, please use a11y_aria_level or a11y.ariaLevel");const resolvedLevel=a11y$1.ariaLevel({id:this._id??Array.from(arguments).lastItem?.data?.root?._id,level,override:this._ariaLevel});return new Handlebars.SafeString(` role="heading" aria-level="${resolvedLevel}" `)},a11y_aria_level(id,level){let override=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;const resolvedLevel=a11y$1.ariaLevel({id,level,override});return resolvedLevel},a11y_attrs_tabbable(){logging$1.deprecated("a11y_attrs_tabbable should not be used. tabbable elements should be natively tabbable.");return new Handlebars.SafeString(" role=\"region\" tabindex=\"0\" ")},a11y_alt_text(visible,alternatives){let values=Array.prototype.slice.call(arguments,1,-1);values=values.filter(Boolean);return new Handlebars.SafeString("<span aria-hidden=\"true\">"+visible+"</span><span class=\"aria-label\">"+values.join(" ")+"</span>")}};Object.assign(helpers$1,{if_value_equals(){logging$1.deprecated("if_value_equals, use equals instead.");return helpers$1.equals.apply(this,arguments)},numbers(){logging$1.deprecated("numbers, use inc instead.");return helpers$1.inc.apply(this,arguments)},lowerCase(){logging$1.deprecated("lowerCase, use lowercase instead.");return helpers$1.lowercase.apply(this,arguments)}});for(const name in helpers$1){Handlebars.registerHelper(name,helpers$1[name])}__AMD("core/js/helpers",helpers$1);class HeadingView extends Backbone.View{initialize(){this.listenTo(Adapt$1.parentView,"postRemove",this.remove);this.listenTo(this.model,"change:_isComplete",this.updateAria);this.render()}render(){const template=Handlebars.templates[this.constructor.template];const data=this.model.toJSON();const customHeadingType=this.$el.attr("data-a11y-heading-type");const isBackwardCompatible=[...this.$el[0].classList].every(name=>!name.includes("-inner"));data._isBackwardCompatible=isBackwardCompatible;if(customHeadingType)data._type=customHeadingType;if(data._type==="course")data._type="menu";this.$el.html(template(data));this.checkCompletion()}updateAria(){const template=Handlebars.templates[this.constructor.template];const data=this.model.toJSON();const $rendered=$(`<div>${template(data)}</div>`);this.$(".aria-label").html($rendered.find(".aria-label").html());this.checkCompletion()}checkCompletion(){const isComplete=this.model.get("_isComplete");this.$el.toggleClass("is-complete",isComplete).toggleClass("is-incomplete",!isComplete)}}HeadingView.template="heading";var HeadingView$1=__AMD("core/js/views/headingView",HeadingView);class Headings extends Backbone.Controller{initialize(){this.listenTo(Adapt$1,"view:render",this.onViewRender)}onViewRender(view){const $headingSeats=view.$(".js-heading");$headingSeats.each((index,el)=>new HeadingView$1({el,model:view.model}))}}__AMD("core/js/headings",new Headings);class NavigationView extends Backbone.View{className(){return"nav"}events(){return{"click [data-event]":"triggerEvent"}}attributes(){return{role:"navigation"}}initialize(){this.sortNavigationButtons=_.debounce(this.sortNavigationButtons.bind(this),1);this.listenToOnce(Adapt$1,{"courseModel:dataLoading":this.remove});this.listenTo(Adapt$1,"router:menu router:page",this.onNavigate);this.preRender()}preRender(){Adapt$1.trigger("navigationView:preRender",this);this.render()}render(){const template=Handlebars.templates[this.constructor.template];this.$el.html(template({_globals:Adapt$1.course.get("_globals"),_accessibility:Adapt$1.config.get("_accessibility")})).insertBefore("#app");_.defer(()=>{Adapt$1.trigger("navigationView:postRender",this)});return this}triggerEvent(event){event.preventDefault();const currentEvent=$(event.currentTarget).attr("data-event");Adapt$1.trigger("navigation:"+currentEvent);switch(currentEvent){case"backButton":router$1.navigateToPreviousRoute();break;case"homeButton":router$1.navigateToHomeRoute();break;case"parentButton":router$1.navigateToParent();break;case"skipNavigation":this.skipNavigation();break;case"returnToStart":startController$1.returnToStartLocation();break;}}skipNavigation(){a11y$1.focusFirst("."+location$1._contentType)}onNavigate(model){this.hideNavigationButton(model);this.sortNavigationButtons()}hideNavigationButton(model){const shouldHide=model.get("_type")==="course";this.$(".nav__back-btn, .nav__home-btn").toggleClass("u-display-none",shouldHide)}sortNavigationButtons(){const container=this.$(".nav__inner")[0];const items=[...container.children];items.sort((a,b)=>parseFloat($(a).attr("data-order")||0)-parseFloat($(b).attr("data-order")||0)).forEach(item=>container.appendChild(item))}showNavigationButton(){this.$(".nav__back-btn, .nav__home-btn").removeClass("u-display-none")}}NavigationView.template="nav";var NavigationView$1=__AMD("core/js/views/navigationView",NavigationView);class NavigationController extends Backbone.Controller{initialize(){this.listenTo(Adapt$1,"adapt:preInitialize",this.addNavigationBar)}addNavigationBar(){const adaptConfig=Adapt$1.course.get("_navigation");if(adaptConfig?._isDefaultNavigationDisabled){Adapt$1.trigger("navigation:initialize");return}Adapt$1.navigation=new NavigationView$1}}__AMD("core/js/navigation",new NavigationController);class ComponentView extends AdaptView$1{attributes(){if(!this.model.get("_isA11yRegionEnabled")){return AdaptView$1.resultExtend("attributes",{},this)}return AdaptView$1.resultExtend("attributes",{"aria-labelledby":this.model.get("_id")+"-heading",role:"region"},this)}className(){return["component",this.model.get("_component").toLowerCase(),this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),"is-"+this.model.get("_layout"),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}renderState(){logging$1.removed("renderState is removed and moved to item title")}setupInviewCompletion(){let inviewElementSelector=arguments.length>0&&arguments[0]!==undefined?arguments[0]:".component__inner";let callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.setCompletionStatus;this.$inviewElement=this.$(inviewElementSelector);this.inviewCallback=callback;this.$inviewElement.on("inview.componentView",this.onInview.bind(this))}removeInviewListener(){if(!this.$inviewElement)return;this.$inviewElement.off("inview.componentView");this.$inviewElement=null}onInview(event,visible,visiblePartX,visiblePartY){if(!visible)return;switch(visiblePartY){case"top":this.hasSeenTop=true;break;case"bottom":this.hasSeenBottom=true;break;case"both":this.hasSeenTop=this.hasSeenBottom=true;}if(!this.hasSeenTop||!this.hasSeenBottom)return;this.inviewCallback();if(this.model.get("_isComplete")){this.removeInviewListener()}}postRender(){}remove(){this.removeInviewListener();super.remove()}}ComponentView.type="component";var ComponentView$1=__AMD("core/js/views/componentView",ComponentView);class GraphicView extends ComponentView$1{className(){return[super.className(),this.model.get("_isScrollable")&&"is-scrollable"].filter(Boolean).join(" ")}events(){return{"click .js-graphic-link":"onClick","keydown .js-graphic-scrollbar":"onKeyDown"}}postRender(){this.$(".graphic__widget").imageready(()=>{this.setReadyStatus();this.setupInviewCompletion(".graphic__widget");this.setupScrollable()})}setupScrollable(){if(!this.model.get("_isScrollable"))return;this.onScroll=_.debounce(this.onScroll.bind(this),17);const $scrollbar=this.$(".js-graphic-scrollbar");const $scrollContainer=this.$(`#${$scrollbar.attr("aria-controls")}`);$scrollContainer.on("scroll",this.onScroll);this.onKeyDown()}onScroll(event){if(!this.model.get("_isScrollable"))return;const $scrollbar=this.$(".js-graphic-scrollbar");const $scrollContainer=this.$(`#${$scrollbar.attr("aria-controls")}`);const{clientWidth,scrollWidth}=$scrollContainer[0];const scrollableWidth=scrollWidth-clientWidth;const left=$scrollContainer.scrollLeft();const calculatedScrollPercent=parseInt(left/scrollableWidth*100);this.model.set("_scrollPercent",calculatedScrollPercent)}onKeyDown(event){if(!this.model.get("_isScrollable"))return;const $scrollbar=this.$(".js-graphic-scrollbar");const $scrollContainer=this.$(`#${$scrollbar.attr("aria-controls")}`);const{clientWidth,scrollWidth}=$scrollContainer[0];const scrollableWidth=scrollWidth-clientWidth;const step=clientWidth*0.1;let left=$scrollContainer.scrollLeft();const calculatedScrollPercent=parseInt(left/scrollableWidth*100);const definedScrollPercent=this.model.get("_scrollPercent")??0;if(definedScrollPercent!==calculatedScrollPercent){left=definedScrollPercent/100*scrollableWidth}switch(event?.which){case 37:left-=step;break;case 39:left+=step;break;}left=_.max([0,_.min([scrollableWidth,left])]);$scrollContainer.scrollLeft(left)}onClick(event){if(event)event.preventDefault();const item=this.model.get("_graphic");const{_url:url,_target:target="_blank"}=item;const isNewWindow=target!=="_self";if(isNewWindow)return window.open(url,target);const isRouterNavigation=url.substr(0,1)==="#";if(isRouterNavigation)return Backbone.history.navigate(url,{trigger:true});window.location.href=url}preRemove(){if(!this.model.get("_isScrollable"))return;const $scrollbar=this.$(".js-graphic-scrollbar");const $scrollContainer=this.$(`#${$scrollbar.attr("aria-controls")}`);$scrollContainer.off("scroll",this.onScroll)}}GraphicView.template="graphic.jsx";var GraphicView$1=__AMD("components/adapt-contrib-graphic/js/GraphicView",GraphicView);var GraphicModel=__AMD("components/adapt-contrib-graphic/js/GraphicModel",class GraphicModel extends ComponentModel$1{init(){this.set("_scrollPercent",this.get("_defaultScrollPercent"))}});__AMD("components/adapt-contrib-graphic/js/adapt-contrib-graphic",components$1.register("graphic",{model:GraphicModel,view:GraphicView$1}));var mepPrototype=$.extend({},window.mejs.MediaElementPlayer.prototype);$.extend(window.mejs.MediaElementPlayer.prototype,{detectFullscreenMode:function(){var vendorPrefix=this.getVendorPrefix();var fsEventName="on"+vendorPrefix+"fullscreenchange";if(document[fsEventName]===null){document[fsEventName]=function fullScreenEventHandler(){var elementName=vendorPrefix===""?"fullscreenElement":vendorPrefix+"FullscreenElement";if(document[elementName]!==null){$.inview.lock("mediaelement");Adapt$1.trigger("media:fullscreen:enter")}else{$.inview.unlock("mediaelement");Adapt$1.trigger("media:fullscreen:exit")}}}return mepPrototype.detectFullscreenMode.apply(this,arguments)},getVendorPrefix:function(){var browser=device$1.browser;if(browser==="internet explorer"){return"ms"}if(browser==="microsoft edge"||browser==="safari"){return"webkit"}return""}});Object.assign(window.mejs.MepDefaults,{keyActions:[],defaultSeekForwardInterval:duration=>{if(typeof duration==="object")return duration.duration*0.05;return duration*0.05},defaultSeekBackwardInterval:duration=>{if(typeof duration==="object")return duration.duration*0.05;return duration*0.05}});const purge=function(d){let a=d.attributes;if(a){for(let i=a.length-1;i>=0;i-=1){const n=a[i].name;if(typeof d[n]==="function"){d[n]=null}}}a=d.childNodes;if(a){for(let i=0,count=a.length;i<count;i+=1){purge(d.childNodes[i])}}};window.mejs.i18n.locale.language="en-US";window.mejs.i18n.locale.strings["en-US"]={};const ariaLabelMappings={playText:"Play",pauseText:"Pause",stopText:"Stop",audioPlayerText:"Audio Player",videoPlayerText:"Video Player",tracksText:"Captions/Subtitles",timeSliderText:"Time Slider",muteText:"Mute Toggle",unmuteStatusText:"Unmute",muteStatusText:"Mute",volumeSliderText:"Volume Slider",fullscreenText:"Fullscreen",goFullscreenText:"Go Fullscreen",turnOffFullscreenText:"Turn off Fullscreen",noneText:"None",skipBackText:"Skip back %1 seconds",allyVolumeControlText:"Use Up/Down Arrow keys to increase or decrease volume.",progessHelpText:"Use Left/Right Arrow keys to advance one second, Up/Down arrows to advance ten seconds."};Adapt$1.on("app:dataReady",()=>{const dynamicLabels=window.mejs.i18n.locale.strings["en-US"];const fixedDefaults=window.mejs.MepDefaults;const globals=Adapt$1.course.get("_globals")?._components?._media;for(const k in ariaLabelMappings){dynamicLabels[ariaLabelMappings[k]]=globals[k]??ariaLabelMappings[k];fixedDefaults[k]=dynamicLabels[ariaLabelMappings[k]]}});class MediaView extends ComponentView$1{events(){return{"click .js-media-inline-transcript-toggle":"onToggleInlineTranscript","click .js-media-external-transcript-click":"onExternalTranscriptClicked","click .js-skip-to-transcript":"onSkipToTranscript"}}className(){let classes=super.className();const playerOptions=this.model.get("_playerOptions");if(playerOptions?.toggleCaptionsButtonWhenOnlyOne){classes+=" toggle-captions"}return classes}preRender(){this.listenTo(Adapt$1,{"device:resize":this.onScreenSizeChanged,"device:changed":this.onDeviceChanged,"media:stop":this.onMediaStop});_.bindAll(this,"onMediaElementPlay","onMediaElementPause","onMediaElementEnded","onMediaElementTimeUpdate","onMediaElementSeeking","onOverlayClick","onMediaElementClick","onWidgetInview");this.model.set({_isMediaEnded:false,_isMediaPlaying:false});if(!this.model.get("_media").source)return;const media=this.model.get("_media");if(window.location.protocol==="https:"&&media.source.indexOf("http:")===0){media.source=media.source.replace(/^http:/,"https:")}this.model.set("_media",media)}postRender(){this.setupPlayer();this.addMejsButtonClass()}addMejsButtonClass(){this.$(".mejs-overlay-button").addClass("icon")}setupPlayer(){if(!this.model.get("_playerOptions"))this.model.set("_playerOptions",{});const modelOptions=this.model.get("_playerOptions");if(modelOptions.pluginPath===undefined){_.extend(modelOptions,{pluginPath:"https://cdnjs.cloudflare.com/ajax/libs/mediaelement/2.21.2/",flashName:"flashmediaelement-cdn.swf",flashScriptAccess:"always"})}if(modelOptions.features===undefined){modelOptions.features=["playpause","progress","current","duration"];if(this.model.get("_useClosedCaptions")){modelOptions.features.unshift("tracks")}if(this.model.get("_allowFullScreen")){modelOptions.features.push("fullscreen")}if(this.model.get("_showVolumeControl")){modelOptions.features.push("volume")}}modelOptions.success=_.debounce(this.onPlayerReady.bind(this),100);if(this.model.get("_useClosedCaptions")){const startLanguage=this.model.get("_startLanguage")||"en";if(!offlineStorage$1.get("captions")){offlineStorage$1.set("captions",startLanguage)}modelOptions.startLanguage=this.checkForSupportedCCLanguage(offlineStorage$1.get("captions"))}if(modelOptions.alwaysShowControls===undefined){modelOptions.alwaysShowControls=false}if(modelOptions.hideVideoControlsOnLoad===undefined){modelOptions.hideVideoControlsOnLoad=true}this.addMediaTypeClass();this.addThirdPartyFixes(modelOptions,()=>{this.$("audio, video").mediaelementplayer(modelOptions);this.cleanUpPlayer();const _media=this.model.get("_media");if(!_media.mp3&&!_media.mp4&&!_media.ogv&&!_media.webm&&!_media.source){logging$1.warn("ERROR! No media is selected in components.json for component "+this.model.get("_id"));this.setReadyStatus();return}if(!_media.source)return;this.$(".media__widget").addClass("external-source")})}addMediaTypeClass(){const media=this.model.get("_media");if(!media?.type)return;const typeClass=media.type.replace(/\//,"-");this.$(".media__widget").addClass(typeClass)}addThirdPartyFixes(modelOptions,callback){const media=this.model.get("_media");if(!media)return callback();if(media.mp3||media.ogg){modelOptions.alwaysShowControls=true}switch(media.type){case"video/vimeo":modelOptions.alwaysShowControls=false;modelOptions.hideVideoControlsOnLoad=true;modelOptions.features=[];if(MediaView.froogaloopAdded)return callback();$.getScript("assets/froogaloop.js").done(()=>{MediaView.froogaloopAdded=true;callback()}).fail(()=>{MediaView.froogaloopAdded=false;logging$1.error("Could not load froogaloop.js")});break;default:callback();}}cleanUpPlayer(){const containerLabel=this.model.get("displayTitle")||this.model.get("title");this.$(".media__widget").children(".mejs-offscreen").remove();this.$("[role=application]").removeAttr("role tabindex");this.$(".mejs-container").attr({role:"region","aria-label":containerLabel});this.$("[aria-controls]").removeAttr("aria-controls");this.$(".mejs-overlay-play").attr("aria-hidden","true")}setupEventListeners(){this.completionEvent=this.model.get("_setCompletionOn")||"play";if(this.completionEvent==="inview"){this.setupInviewCompletion(".component__widget")}if(this.model.get("_preventForwardScrubbing")&&!this.model.get("_isComplete")){$(this.mediaElement).on({seeking:this.onMediaElementSeeking,timeupdate:this.onMediaElementTimeUpdate})}$(this.mediaElement).on({play:this.onMediaElementPlay,pause:this.onMediaElementPause,ended:this.onMediaElementEnded});_.delay(this.listenForCaptionsChange.bind(this),250)}listenForCaptionsChange(){if(!this.model.get("_useClosedCaptions"))return;const selector=this.model.get("_playerOptions").toggleCaptionsButtonWhenOnlyOne?".mejs-captions-button button":".mejs-captions-selector";this.$(selector).on("click.mediaCaptionsChange",_.debounce(()=>{const srclang=this.mediaElement.player.selectedTrack?this.mediaElement.player.selectedTrack.srclang:"none";offlineStorage$1.set("captions",srclang);Adapt$1.trigger("media:captionsChange",this,srclang)},250));this.listenTo(Adapt$1,"media:captionsChange",this.onCaptionsChanged)}onCaptionsChanged(view,lang){if(view?.cid===this.cid)return;lang=this.checkForSupportedCCLanguage(lang);this.mediaElement.player.setTrack(lang);const $inputs=this.$(".mejs-captions-selector input");$inputs.filter(":checked").prop("checked",false);$inputs.filter(`[value="${lang}"]`).prop("checked",true)}checkForSupportedCCLanguage(lang){if(!lang||lang==="none")return"none";if(_.findWhere(this.model.get("_media").cc,{srclang:lang}))return lang;return this.model.get("_startLanguage")||"none"}onMediaElementPlay(event){this.queueGlobalEvent("play");Adapt$1.trigger("media:stop",this);if(this.model.get("_pauseWhenOffScreen")){this.$(".mejs-container").on("inview",this.onWidgetInview)}this.model.set({_isMediaPlaying:true,_isMediaEnded:false});if(this.completionEvent!=="play")return;this.setCompletionStatus()}onMediaElementPause(event){this.queueGlobalEvent("pause");this.$(".mejs-container").off("inview",this.onWidgetInview);this.model.set("_isMediaPlaying",false)}onMediaElementEnded(event){this.queueGlobalEvent("ended");this.model.set("_isMediaEnded",true);if(this.completionEvent==="ended"){this.setCompletionStatus()}}onWidgetInview(event,isInView){if(!isInView&&!this.mediaElement.paused)this.mediaElement.player.pause()}onMediaElementSeeking(event){let maxViewed=this.model.get("_maxViewed");if(!maxViewed){maxViewed=0}if(event.target.currentTime<=maxViewed)return;event.target.currentTime=maxViewed}onMediaElementTimeUpdate(event){let maxViewed=this.model.get("_maxViewed");if(!maxViewed){maxViewed=0}if(event.target.currentTime<=maxViewed)return;this.model.set("_maxViewed",event.target.currentTime)}setupPlayPauseToggle(){const player=this.mediaElement.player;if(!player){logging$1.warn("MediaView.setupPlayPauseToggle: OOPS! there is no player reference.");return}player.options.clickToPlayPause=false;this.$(".mejs-overlay-button").on("click",this.onOverlayClick);this.$(".mejs-mediaelement").on("click",this.onMediaElementClick)}onMediaStop(view){if(view?.cid===this.cid)return;if(!this.mediaElement||!this.mediaElement.player)return;this.mediaElement.player.pause()}onOverlayClick(){const player=this.mediaElement.player;if(!player)return;player.play()}onMediaElementClick(event){const player=this.mediaElement.player;if(!player)return;const isPaused=player.media.paused;if(!isPaused)player.pause()}remove(){this.$(".mejs-overlay-button").off("click",this.onOverlayClick);this.$(".mejs-mediaelement").off("click",this.onMediaElementClick);this.$(".mejs-container").off("inview",this.onWidgetInview);if(this.model.get("_useClosedCaptions")){const selector=this.model.get("_playerOptions").toggleCaptionsButtonWhenOnlyOne?".mejs-captions-button button":".mejs-captions-selector";this.$(selector).off("click.mediaCaptionsChange")}const modelOptions=this.model.get("_playerOptions");delete modelOptions.success;const media=this.model.get("_media");if(media){switch(media.type){case"video/vimeo":this.$("iframe")[0].isRemoved=true;}}if(this.mediaElement&&this.mediaElement.player){const playerId=this.mediaElement.player.id;purge(this.$el[0]);this.mediaElement.player.remove();if(window.mejs.players[playerId]){delete window.mejs.players[playerId]}}if(this.mediaElement){$(this.mediaElement).off({play:this.onMediaElementPlay,pause:this.onMediaElementPause,ended:this.onMediaElementEnded,seeking:this.onMediaElementSeeking,timeupdate:this.onMediaElementTimeUpdate});this.mediaElement.src="";$(this.mediaElement.pluginElement).remove();delete this.mediaElement}super.remove()}onDeviceChanged(){if(!this.model.get("_media").source)return;this.$(".mejs-container").width(this.$(".component__widget").width())}onPlayerReady(mediaElement,domObject){this.mediaElement=mediaElement;let player=this.mediaElement.player;if(!player)player=window.mejs.players[this.$(".mejs-container").attr("id")];const hasTouch=window.mejs.MediaFeatures.hasTouch;if(hasTouch){this.setupPlayPauseToggle()}this.addThirdPartyAfterFixes();this.cleanUpPlayerAfter();if(player&&this.model.has("_startVolume")){player.setVolume(parseInt(this.model.get("_startVolume"))/100)}this.setReadyStatus();this.setupEventListeners()}addThirdPartyAfterFixes(){const media=this.model.get("_media");switch(media.type){case"video/vimeo":this.$(".mejs-container").attr("tabindex",0);}}cleanUpPlayerAfter(){this.$("[aria-valuemax='NaN']").attr("aria-valuemax",0)}onScreenSizeChanged(){this.$("audio, video").width(this.$(".component__widget").width())}onSkipToTranscript(){_.delay(()=>{a11y$1.focus(this.$(".media__transcript-btn"))},250)}onToggleInlineTranscript(event){if(event)event.preventDefault();const $transcriptBodyContainer=this.$(".media__transcript-body-inline");const $button=this.$(".media__transcript-btn-inline");const $buttonText=this.$(".media__transcript-btn-inline .media__transcript-btn-text");if($transcriptBodyContainer.hasClass("inline-transcript-open")){$transcriptBodyContainer.stop(true,true).slideUp(()=>{$(window).resize()}).removeClass("inline-transcript-open");$button.attr("aria-expanded",false);$buttonText.html(this.model.get("_transcript").inlineTranscriptButton);return}$transcriptBodyContainer.stop(true,true).slideDown(()=>{$(window).resize()}).addClass("inline-transcript-open");$button.attr("aria-expanded",true);$buttonText.html(this.model.get("_transcript").inlineTranscriptCloseButton);if(this.model.get("_transcript")._setCompletionOnView!==false){this.setCompletionStatus()}}onExternalTranscriptClicked(event){if(this.model.get("_transcript")._setCompletionOnView===false)return;this.setCompletionStatus()}queueGlobalEvent(eventType){const time=Date.now();const lastEvent=this.lastEvent||{time:0};const timeSinceLastEvent=time-lastEvent.time;const debounceTime=500;this.lastEvent={time,type:eventType};clearTimeout(this.eventTimeout);if(eventType==="ended"){return this.triggerGlobalEvent(eventType)}if(timeSinceLastEvent<=debounceTime)return;this.eventTimeout=setTimeout(this.triggerGlobalEvent.bind(this,eventType),debounceTime)}triggerGlobalEvent(eventType){const player=this.mediaElement.player;const eventObj={type:eventType,src:this.mediaElement.src,platform:this.mediaElement.pluginType};if(player)eventObj.isVideo=player.isVideo;Adapt$1.trigger("media",eventObj)}}MediaView.froogaloopAdded=false;var MediaView$1=__AMD("components/adapt-contrib-media/js/mediaView",MediaView);__AMD("components/adapt-contrib-media/js/adapt-contrib-media",components$1.register("media",{model:ComponentModel$1.extend({}),view:MediaView$1}));class TextView extends ComponentView$1{postRender(){this.setReadyStatus();this.setupInview()}setupInview(){const selector=this.getInviewElementSelector();if(!selector)return this.setCompletionStatus();this.setupInviewCompletion(selector)}getInviewElementSelector(){if(this.model.get("body"))return".component__body";if(this.model.get("instruction"))return".component__instruction";if(this.model.get("displayTitle"))return".component__title";return null}}TextView.template="text.jsx";var TextView$1=__AMD("components/adapt-contrib-text/js/TextView",TextView);var TextModel=__AMD("components/adapt-contrib-text/js/TextModel",class TextModel extends ComponentModel$1{});__AMD("components/adapt-contrib-text/js/adapt-contrib-text",components$1.register("text",{model:TextModel,view:TextView$1}));var aboutPage=_.extend({initialize:function(){this.listenTo(Adapt$1,"aboutPage:showAboutPage",this.showAboutPage);this.listenTo(Adapt$1,"router:course",this.updateCourse);this.listenTo(Adapt$1,"pageView:ready",this.addLink);this.listenTo(Adapt$1,"menuView:ready",this.addLink);this.listenTo(Adapt$1,"router:page",this.updatePage)},updateCourse:function(target){this.currentCourse=target},updatePage:function(target){this.contentObject=target},getPage:function(){return this.contentObject},getCourse:function(){return this.currentCourse},addLink:function(){var title="About";var contactEmail="";var contactLinkText="";try{title=Adapt$1.course.get("_globals")._extensions._aboutPage.linkText}catch(err){}try{var items=Adapt$1.course.get("_aboutPage")._items}catch(err){return}try{if($(".about-links").prop("innerHTML").trim().length>0){$(".about-links").append(" | ")}$(".about-links").append("<a class=\"about\" onClick=\"require('core/js/adapt').trigger('aboutPage:showAboutPage'); return false;\">"+title+"</a>")}catch(err){}try{contactEmail=Adapt$1.course.get("_globals")._extensions._aboutPage.contactEMail;contactLinkText=Adapt$1.course.get("_globals")._extensions._aboutPage.contactLinkText;if(contactLinkText!=""&&contactEmail!=""){console.log(contactEmail);console.log(contactLinkText);if($(".about-links").prop("innerHTML").trim().length>0){$(".about-links").append(" | ")}$(".about-links").append("<a class=\"contact\" href=\"mailto:"+contactEmail+"\" target=\"_blank\">"+contactLinkText+"</a>")}}catch(err){console.log(err)}try{var aboutcredit=this.contentObject.get("_aboutPage").aboutCredit;if(aboutcredit!=""){$(".about-credit").html(aboutcredit)}}catch(err){}try{var aboutSLtext=this.contentObject.get("_aboutPage").SL_text;if(aboutSLtext!=""){$("#about-SL-text").html(aboutSLtext)}}catch(err){}},showAboutPage:function(){var items=[];try{items=this.contentObject.get("_aboutPage")._items}catch(err){}if(items.length<1){items=Adapt$1.course.get("_aboutPage")._items}var title="About";try{title=Adapt$1.course.get("_globals")._extensions._aboutPage.titleText}catch(err){}var string="";_.each(items,function(item){var graphic=item._graphic;if(graphic.src){string+="<div class='aboutPageGraphicElement'><img class='aboutPageGraphic' src='"+graphic.src+"'/></div>"}string+="<div class='aboutPageText'>";string+="<h2>"+item.title+"</h2>";string+="<p>"+item.description+"</p>";string+="</div>";string+="<hr class='aboutPageRule'/>"});var alertObject={title:title,body:string};Adapt$1.once("notify:closed",function(){Adapt$1.trigger("tutor:closed")});Adapt$1.trigger("notify:popup",alertObject);Adapt$1.trigger("tutor:opened")}},Backbone.Events);aboutPage.initialize();__AMD("extensions/adapt-contrib-aboutPage/js/adapt-contrib-aboutPage",aboutPage);class Completion extends Backbone.Controller{initialize(){this.subProgressCompleted=0;this.subProgressTotal=0;this.nonAssessmentCompleted=0;this.nonAssessmentTotal=0;this.assessmentCompleted=0;this.assessmentTotal=0}calculateCompletion(contentObjectModel){const completion=Adapt$1.completion;const viewType=contentObjectModel.get("_type");const isComplete=contentObjectModel.get("_isComplete")?1:0;let children;switch(viewType){case"page":{children=contentObjectModel.getAllDescendantModels().filter(model=>{return model.get("_isAvailable")&&!model.get("_isOptional")});const availableChildren=this.filterAvailableChildren(children);const components=this.getPageLevelProgressEnabledModels(availableChildren);const nonAssessmentComponents=this.getNonAssessmentComponents(components);completion.nonAssessmentTotal=nonAssessmentComponents.length;completion.nonAssessmentCompleted=this.getComponentsCompleted(nonAssessmentComponents).length;const assessmentComponents=this.getAssessmentComponents(components);completion.assessmentTotal=assessmentComponents.length;completion.assessmentCompleted=this.getComponentsInteractionCompleted(assessmentComponents).length;if(contentObjectModel.get("_pageLevelProgress")._excludeAssessments!==true){completion.subProgressCompleted=contentObjectModel.get("_subProgressComplete")||0;completion.subProgressTotal=contentObjectModel.get("_subProgressTotal")||0}const showPageCompletionCourse=Adapt$1.course.get("_pageLevelProgress")?._showPageCompletion!==false;const showPageCompletionPage=contentObjectModel.get("_pageLevelProgress")?._showPageCompletion!==false;if(showPageCompletionCourse&&showPageCompletionPage){completion.nonAssessmentCompleted+=isComplete;completion.nonAssessmentTotal+=1}break}case"menu":case"course":{children=contentObjectModel.getChildren().models;children.forEach(contentObject=>{const completionObject=Adapt$1.completion.calculateCompletion(contentObject);completion.subProgressCompleted+=completionObject.subProgressCompleted||0;completion.subProgressTotal+=completionObject.subProgressTotal||0;completion.nonAssessmentTotal+=completionObject.nonAssessmentTotal;completion.nonAssessmentCompleted+=completionObject.nonAssessmentCompleted;completion.assessmentTotal+=completionObject.assessmentTotal;completion.assessmentCompleted+=completionObject.assessmentCompleted});break}}return completion}getNonAssessmentComponents(models){return models.filter(model=>{return!model.get("_isPartOfAssessment")})}getAssessmentComponents(models){return models.filter(model=>{return model.get("_isPartOfAssessment")})}getComponentsCompleted(models){return models.filter(item=>{return item.get("_isComplete")})}getComponentsInteractionCompleted(models){return models.filter(item=>{return item.get("_isComplete")})}getPageLevelProgressEnabledModels(models){return models.filter(model=>{const config=model.get("_pageLevelProgress");return config?._isEnabled})}unavailableInHierarchy(parents){if(!parents)return;return parents.some(parent=>{return!parent.get("_isAvailable")})}filterAvailableChildren(children){const availableChildren=[];for(let i=0,count=children.length;i<count;i++){const parents=children[i].getAncestorModels();if(this.unavailableInHierarchy(parents))continue;availableChildren.push(children[i])}return availableChildren}calculatePercentageComplete(model){const completionObject=this.calculateCompletion(model);const completed=completionObject.nonAssessmentCompleted+completionObject.assessmentCompleted+completionObject.subProgressCompleted;const total=completionObject.nonAssessmentTotal+completionObject.assessmentTotal+completionObject.subProgressTotal;const percentageComplete=Math.floor(completed/total*100);return percentageComplete}}var completionCalculations=__AMD("extensions/adapt-contrib-pageLevelProgress/js/completionCalculations",Adapt$1.completion=new Completion);class PageLevelProgressIndicatorView extends Backbone.View{tagName(){return"span"}initialize(options){options=options||{};this.parent=options.parent;this.calculatePercentage=options.calculatePercentage||this.calculatePercentage;this.ariaLabel=options.ariaLabel||"";this.type=options.type||this.model.get("_type");this.addClasses();this.setUpEventListeners();this.setPercentageComplete();this.render();this.refresh()}addClasses(){this.$el.addClass(["pagelevelprogress__indicator","is-"+this.type].join(" "))}checkAria(){if(!this.ariaLabel){this.$el.attr("aria-hidden",true);return}const data=this.getRenderData();this.$(".js-indicator-aria-label").html(Handlebars.compile(this.ariaLabel)(data))}setUpEventListeners(){if(this.parent){this.listenToOnce(this.parent,"postRemove",this.remove)}else{this.listenTo(Adapt$1,"remove",this.remove)}this.listenTo(this.model,"change:_isComplete",this.refresh);if(!this.collection)return;this.listenTo(this.collection,"change:_isComplete",this.refresh)}setPercentageComplete(){const percentage=this.calculatePercentage();this.model.set("percentageComplete",percentage);return percentage}calculatePercentage(){return this.model.get("_isComplete")?100:0}render(){const data=this.getRenderData();const template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))}getRenderData(){const data=this.model.toJSON();data.ariaLabel=this.ariaLabel;data.type=this.type;return data}refresh(){this.checkCompletion();this.checkAria();this.$(".js-indicator-bar").css({width:this.calculatePercentage()+"%"})}checkCompletion(){const percentage=this.setPercentageComplete();this.$el.toggleClass("is-complete",percentage===100).toggleClass("is-incomplete",percentage!==100)}}PageLevelProgressIndicatorView.template="pageLevelProgressIndicator";var PageLevelProgressIndicatorView$1=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressIndicatorView",PageLevelProgressIndicatorView);class PageLevelProgressItemView extends Backbone.View{className(){return["pagelevelprogress__item drawer__item",this.model.get("_type")+"__indicator"].join(" ")}attributes(){return{role:"listitem"}}initialize(){this.listenTo(Adapt$1,"remove",this.remove);this.render();this.addIndicator()}render(){const data=this.model.toJSON();const template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))}addIndicator(){if(this.model.get("_isOptional"))return;const item=new PageLevelProgressIndicatorView$1({model:this.model});this.$(".js-indicator").append(item.$el)}}PageLevelProgressItemView.template="pageLevelProgressItem";var PageLevelProgressItemView$1=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressItemView",PageLevelProgressItemView);var PageLevelProgressView=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView",class PageLevelProgressView extends Backbone.View{className(){return"pagelevelprogress"}events(){return{"click .js-pagelevelprogress-item-click":"scrollToPageElement"}}initialize(){this.listenTo(Adapt$1,"remove",this.remove);this.render();this.addChildren()}async scrollToPageElement(event){if(event&&event.preventDefault)event.preventDefault();const $target=$(event.currentTarget);if($target.is(".is-disabled"))return;const id=$target.attr("data-pagelevelprogress-id");const model=data$1.findById(id);if(!model.get("_isRendered")){try{await Adapt$1.parentView.renderTo(id)}catch(err){return}}const currentComponentSelector=`.${id}`;Adapt$1.once("drawer:closed",()=>{router$1.navigateToElement(currentComponentSelector,{duration:400})}).trigger("drawer:closeDrawer",$(currentComponentSelector))}render(){const template=Handlebars.templates.pageLevelProgress;this.$el.html(template({}))}addChildren(){const $children=this.$(".js-children");this.collection.each(model=>{$children.append(new PageLevelProgressItemView$1({model}).$el)})}});var PageLevelProgressNavigationView=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView",class PageLevelProgressNavigationView extends Backbone.View{tagName(){return"button"}className(){return"btn-icon nav__btn nav__pagelevelprogress-btn pagelevelprogress__nav-btn"}attributes(){return{"data-order":Adapt$1.course.get("_globals")?._extensions?._pageLevelProgress?._navOrder||0}}events(){return{click:"onProgressClicked"}}initialize(){_.bindAll(this,"updateProgressBar");this.setUpEventListeners();this.render();this.addIndicator();this.deferredUpdate()}setUpEventListeners(){this.listenTo(Adapt$1,{remove:this.remove,"router:location":this.updateProgressBar,"view:childAdded pageLevelProgress:update":this.refreshProgressBar})}render(){const template=Handlebars.templates.pageLevelProgressNavigation;this.$el.html(template({}))}addIndicator(){this.indicatorView=new PageLevelProgressIndicatorView$1({model:this.model,collection:this.collection,calculatePercentage:this._getPageCompletionPercentage,ariaLabel:Adapt$1.course.get("_globals")._extensions._pageLevelProgress.pageLevelProgressIndicatorBar});this.$el.prepend(this.indicatorView.$el)}_getPageCompletionPercentage(){return completionCalculations.calculatePercentageComplete(this.model)}deferredUpdate(){_.defer(this.updateProgressBar)}updateProgressBar(){this.indicatorView.refresh()}refreshProgressBar(){this.collection.repopulate();this.updateProgressBar()}onProgressClicked(event){if(event&&event.preventDefault)event.preventDefault();drawer.triggerCustomView(new PageLevelProgressView({collection:this.collection}).$el,false)}remove(){super.remove();this.collection.reset()}});var PageLevelProgressCollection=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressCollection",class PageLevelProgressCollection extends Backbone.Collection{initialize(models,options){this.listenTo(Adapt$1,"remove",this.reset);if(!options?.pageModel)return;this._pageModel=options.pageModel;this.repopulate()}repopulate(){this.reset();if(!this._pageModel)return;const allDescendants=this._pageModel.getAllDescendantModels(true);const currentPageItems=allDescendants.filter(item=>{return item.get("_isAvailable")===true});const availableItems=completionCalculations.filterAvailableChildren(currentPageItems);const enabledProgressItems=completionCalculations.getPageLevelProgressEnabledModels(availableItems);this.add(enabledProgressItems)}});class PageLevelProgress extends Backbone.Controller{initialize(){this.listenTo(Adapt$1,{"app:dataReady":this.onDataReady,"app:languageChanged":this.onLanguageChange})}getCourseConfig(){return Adapt$1.course.get("_pageLevelProgress")}onDataReady(){const coursePLPConfig=this.getCourseConfig();if(!coursePLPConfig?._isEnabled)return;this.setUpEventListeners()}onLanguageChange(){this.stopListening();this.initialize()}setUpEventListeners(){const headerIndicatorTypes=["menu","menuItem","page","article","block","component"];const headerIndicatorEventNames=headerIndicatorTypes.concat([""]).join("View:render ");this.listenTo(Adapt$1,headerIndicatorEventNames,this.renderHeaderIndicatorView);this.listenTo(Adapt$1,{"menuItemView:postRender":this.renderMenuItemIndicatorView,"router:page":this.renderNavigationView});this.listenTo(Adapt$1.course,"bubble:change:_isComplete",this.onCompletionChange)}onCompletionChange(event){if(!location$1._currentId)return;const currentModel=data$1.findById(location$1._currentId);const completionState={currentLocation:completionCalculations.calculatePercentageComplete(currentModel),course:completionCalculations.calculatePercentageComplete(Adapt$1.course)};const hasChanged=!_.isMatch(this._previousCompletionState,completionState);if(!hasChanged)return;this._previousCompletionState=completionState;Adapt$1.trigger("pageLevelProgress:percentageCompleteChange",completionState)}renderHeaderIndicatorView(view){const model=view.model;const config=model.get("_pageLevelProgress");if(!config?._isEnabled||!config?._isCompletionIndicatorEnabled)return;const pageModel=model.findAncestor("contentobject");const pageConfig=pageModel&&pageModel.get("_pageLevelProgress");if(!pageConfig?._isEnabled)return;const $headings=view.$(".js-heading");$headings.each((index,el)=>{const $el=$(el);const indicatorView=new PageLevelProgressIndicatorView$1({parent:view,model});const isBackwardCompatible=[...$el[0].classList].every(name=>!name.includes("-inner"));if(isBackwardCompatible){indicatorView.$el.insertAfter($el);return}indicatorView.$el.insertBefore($el)})}renderMenuItemIndicatorView(view){if(view.model.get("_id")===location$1._currentId)return;const viewType=view.model.get("_type");if(viewType==="course")return;const pageLevelProgress=view.model.get("_pageLevelProgress");if(!pageLevelProgress?._isEnabled)return;view.$el.find(".js-menu-item-progress").append(new PageLevelProgressIndicatorView$1({parent:view,model:view.model,type:"menu-item",calculatePercentage:this._getMenuItemCompletionPercentage.bind(view),ariaLabel:Adapt$1.course.get("_globals")._extensions._pageLevelProgress.pageLevelProgressMenuBar}).$el)}_getMenuItemCompletionPercentage(){return completionCalculations.calculatePercentageComplete(this.model)}renderNavigationView(pageModel){const coursePLPConfig=this.getCourseConfig();if(coursePLPConfig?._isShownInNavigationBar===false)return;const pagePLPConfig=pageModel.get("_pageLevelProgress");if(!pagePLPConfig?._isEnabled)return;const collection=new PageLevelProgressCollection(null,{pageModel});if(collection.length===0)return;$(".nav__drawer-btn").after(new PageLevelProgressNavigationView({model:pageModel,collection}).$el)}}__AMD("extensions/adapt-contrib-pageLevelProgress/js/adapt-contrib-pageLevelProgress",Adapt$1.pageLevelProgress=new PageLevelProgress);var ResourcesView=__AMD("extensions/adapt-contrib-resources/js/ResourcesView",class ResourcesView extends Backbone.View{className(){return"resources"}initialize(){this.listenTo(Adapt$1,"remove",this.remove);this.render()}events(){return{"click .js-resources-filter-btn-click":"onFilterClicked"}}render(){this.$el.html(Handlebars.templates.resources({model:this.model.toJSON(),resources:this.collection.toJSON()}));_.defer(()=>{this.listenTo(Adapt$1,"drawer:triggerCustomView",this.remove)});return this}onFilterClicked(e){if(e&&e.preventDefault)e.preventDefault();const $resources=this.$("#resources");const $clickedButton=this.$(e.currentTarget);const clickedTabId=$clickedButton.attr("id");this.$(".js-resources-filter-btn-click").removeClass("is-selected").attr("aria-selected",false);$resources.attr("aria-labelledby",clickedTabId);$clickedButton.attr("aria-selected",true);let items;const filter=$clickedButton.addClass("is-selected").attr("data-filter");if(filter==="all"){items=this.$(".js-resources-item").removeClass("u-display-none")}else{this.$(".js-resources-item").removeClass("u-display-none").not(".is-"+filter).addClass("u-display-none");items=this.$(".js-resources-item.is-"+filter)}if(items.length<0)return;a11y$1.focusFirst($(items[0]))}});const helpers={resources_has_type(resources,type,block){const hasType=resources.some(_.matcher({_type:type}));return hasType?block.fn(this):block.inverse(this)},resources_has_multiple_types(resources,block){if(resources.length===1)return block.inverse(this);const allSameType=resources.every(_.matcher({_type:resources[0]._type}));return allSameType?block.inverse(this):block.fn(this)},resources_get_column_count(resources){return _.uniq(_.pluck(resources,"_type")).length+1},resources_force_download(resource,block){if(device$1.browser==="internet explorer"||device$1.OS==="ios"){return block.inverse(this)}return resource._forceDownload||resource.filename?block.fn(this):block.inverse(this)}};for(const name in helpers){Handlebars__default["default"].registerHelper(name,helpers[name])}__AMD("extensions/adapt-contrib-resources/js/ResourcesHelpers",helpers);class Resources extends Backbone.Controller{initialize(){this.listenTo(Adapt$1,"adapt:start",this.initResources)}initResources(){const courseResources=Adapt$1.course.get("_resources");if(!courseResources||courseResources._isEnabled===false)return;const drawerObject={title:courseResources.title,description:courseResources.description,className:"is-resources",drawerOrder:courseResources._drawerOrder||0};drawer.addItem(drawerObject,"resources:showResources");this.setupResources(courseResources)}setupResources(resourcesData){const model=new Backbone.Model(resourcesData);const collection=new Backbone.Collection(model.get("_resourcesItems"));this.listenTo(Adapt$1,"resources:showResources",()=>{drawer.triggerCustomView(new ResourcesView({model,collection}).$el)})}}__AMD("extensions/adapt-contrib-resources/js/adapt-contrib-resources",new Resources);const TUTOR_TYPE=ENUM(["NOTIFY","INLINE","OVERLAY","NONE"]);var TUTOR_TYPE$1=__AMD("extensions/adapt-contrib-tutor/js/TUTOR_TYPE",TUTOR_TYPE);var TutorModel=__AMD("extensions/adapt-contrib-tutor/js/TutorModel",class TutorModel extends Backbone.Model{defaults(){return{_type:TUTOR_TYPE$1.NOTIFY.asLowerCase,_classes:"",_hasNotifyBottomButton:false,_button:{text:"{{_globals._extensions._tutor.hideFeedback}}",ariaLabel:"{{_globals._extensions._tutor.hideFeedback}}"},...Adapt$1.course.get("_tutor")}}initialize(data,parentModel){data=$.extend(true,this.defaults(),data?._isInherited===true?null:data,{_attributes:{"data-adapt-id":parentModel.get("_id")},_id:parentModel.get("_id"),_shouldRenderId:false,...(parentModel.getFeedback?.()||{altTitle:parentModel.get("altFeedbackTitle"),title:parentModel.get("feedbackTitle"),body:parentModel.get("feedbackMessage")})});data._classes+=` tutor ${this.getOriginClasses(parentModel)}`;this.set(data)}getOriginClasses(model){const component=model.get("_component");const extension=model.get("_extension");return[model.get("_isCorrect")?"is-correct":model.get("_isAtLeastOneCorrectSelection")?"is-partially-correct":"is-incorrect",component&&`is-component is-${component}`,extension&&`is-extension is-${extension}`].filter(Boolean).join(" ")}});var TutorNotify=__AMD("extensions/adapt-contrib-tutor/js/TutorNotify",class TutorNotify extends Backbone.Controller{initialize(options){this.parentView=options.parentView;this.listenToOnce(Adapt$1,"notify:closed",this.onNotifyClosed);this.triggerNotify()}triggerNotify(){const{_hasNotifyBottomButton:isButtonEnabled,_button:{text:promptText}}=this.model.toJSON();this.notifyOptions={...this.model.toJSON(),_prompts:isButtonEnabled&&[{promptText:Handlebars.compile(promptText)({_globals:Adapt$1.course.get("_globals")})}],_type:isButtonEnabled?"prompt":"popup"};notify$1.create(this.notifyOptions);Adapt$1.trigger("tutor:opened",this.parentView,this.notifyOptions)}onNotifyClosed(){Adapt$1.trigger("tutor:closed",this.parentView,this.notifyOptions)}});const BUTTON_STATE=ENUM(["SUBMIT","CORRECT","INCORRECT","SHOW_CORRECT_ANSWER","HIDE_CORRECT_ANSWER","SHOW_FEEDBACK","RESET"]);var BUTTON_STATE$1=__AMD("core/js/enums/buttonStateEnum",BUTTON_STATE);var TutorView=__AMD("extensions/adapt-contrib-tutor/js/TutorView",class TutorView extends Backbone.View{className(){return["tutor",`tutor-type-${this.model.get("_type")}`,this.model.get("_classes")].join(" ")}events(){return{"click .js-tutor-btn":"onCloseClick"}}initialize(options){this.parentView=options.parentView;this.buttonsView=this.parentView.buttonsView;this.listenTo(this.parentView,"postRemove",this.onTutorClosed);this.listenTo(this.buttonsView,"buttons:stateUpdate",this.onButtonsStateUpdate);this.render()}render(){this.$el.html(Handlebars.templates.tutor(this.model.toJSON()));_.defer(this.postRender.bind(this))}postRender(){this.toggleFeedback({shouldOpen:true})}toggleFeedback(){let{shouldOpen,shouldManageFocus=true}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const animation=this.model.get("_type")==="inline"?"slide":"fade";const onAnimationEnd=shouldOpen?this.onTutorOpened.bind(this,shouldManageFocus):this.onTutorClosed.bind(this,shouldManageFocus);if(shouldManageFocus){a11y$1.toggleEnabled(this.buttonsView.$(".js-btn-feedback"),!shouldOpen)}this.$(".tutor__inner").stop()[`${animation}Toggle`](200,onAnimationEnd)}onCloseClick(){this.toggleFeedback({shouldOpen:false})}onTutorOpened(shouldManageFocus){if(shouldManageFocus){a11y$1.focus(this.$(".tutor__inner"),{defer:true,preventScroll:true})}Adapt$1.trigger("tutor:opened",this.parentView,this.model.toJSON())}onTutorClosed(shouldManageFocus){if(shouldManageFocus){const $showFeedbackButton=this.buttonsView.$(".js-btn-feedback");a11y$1.focus($showFeedbackButton,{defer:true,preventScroll:true})}Adapt$1.trigger("tutor:closed",this.parentView,this.model.toJSON());this.remove()}onButtonsStateUpdate(state){if(state!==BUTTON_STATE$1.RESET)return;this.toggleFeedback({shouldOpen:false,shouldManageFocus:false})}});class Tutor extends Backbone.Controller{initialize(){this.listenTo(Adapt$1,"questionView:showFeedback",this.onQuestionViewShowFeedback)}onQuestionViewShowFeedback(view){const parentModel=view.model;const tutorModel=new TutorModel(parentModel.get("_tutor"),parentModel);const options={model:tutorModel,parentView:view};switch(TUTOR_TYPE$1(tutorModel.get("_type").toUpperCase())){case TUTOR_TYPE$1.NOTIFY:new TutorNotify(options);break;case TUTOR_TYPE$1.INLINE:case TUTOR_TYPE$1.OVERLAY:view.$(".component__inner").append(new TutorView(options).$el);break;case TUTOR_TYPE$1.NONE:}}}__AMD("extensions/adapt-contrib-tutor/js/adapt-contrib-tutor",Adapt$1.tutor=new Tutor);var footerLink=_.extend({initialize:function(){this.listenTo(Adapt$1,"router:course",this.updateCourse);this.listenTo(Adapt$1,"pageView:ready",this.addLinks);this.listenTo(Adapt$1,"menuView:ready",this.addLinks);this.listenTo(Adapt$1,"router:page",this.updatePage)},updateCourse:function(target){this.currentCourse=target},getCourse:function(){return this.currentCourse},updatePage:function(target){this.contentObject=target},getPage:function(){return this.contentObject},addLinks:function(){var items=[];try{items=this.contentObject.get("_FooterLink")._items}catch(err){}if(items.length<1){items=Adapt$1.course.get("_FooterLink")._items}_.each(items,function(item){var title=item.title;var link=item.link;try{if($(".about-links").prop("innerHTML").trim().length>0){$(".about-links").append(" | ")}$(".about-links").append("<a class=\"about\" target=\"_blank\"; href='"+link+"'>"+title+"</a>")}catch(err){}})}},Backbone.Events);footerLink.initialize();__AMD("extensions/adapt-odi-footerLink/js/adapt-odi-footerLink",footerLink);var licencePage=_.extend({initialize:function(){this.listenTo(Adapt$1,"licencePage:showLicencePage",this.showLicencePage);this.listenTo(Adapt$1,"router:course",this.updateCourse);this.listenTo(Adapt$1,"pageView:ready",this.addLink);this.listenTo(Adapt$1,"menuView:ready",this.addLink);this.listenTo(Adapt$1,"router:page",this.updatePage)},updateCourse:function(target){this.currentCourse=target},getCourse:function(){return this.currentCourse},updatePage:function(target){this.contentObject=target},getPage:function(){return this.contentObject},addLink:function(){var title="Licence";try{title=Adapt$1.course.get("_globals")._extensions._ODILicence.linkText;if($(".about-links").prop("innerHTML").trim().length>0){$(".about-links").append(" | ")}$(".about-links").append("<a class=\"about\" onClick=\"require('core/js/adapt').trigger('licencePage:showLicencePage'); return false;\">"+title+"</a>")}catch(err){}},showLicencePage:function(){var items=[];try{items=this.contentObject.get("_ODILicence")._items}catch(err){}if(items.length<1){items=Adapt$1.course.get("_ODILicence")._items}var title="Licence";try{title=Adapt$1.course.get("_globals")._extensions._ODILicence.titleText}catch(err){}var string="";_.each(items,function(item){var graphic=item._graphic;if(graphic.src){string+="<div class='licencePageGraphicElement'><img class='licencePageGraphic' src='"+graphic.src+"'/></div>"}string+="<div class='licencePageText'>";string+="<h2>"+item.title+"</h2>";string+="<p>"+item.description+"</p>";string+="</div>";string+="<hr class='licencePageRule'/>"});var alertObject={title:title,body:string};Adapt$1.once("notify:closed",function(){Adapt$1.trigger("tutor:closed")});Adapt$1.trigger("notify:popup",alertObject);Adapt$1.trigger("tutor:opened")}},Backbone.Events);licencePage.initialize();__AMD("extensions/adapt-odi-licence/js/adapt-odi-licence",licencePage);class MenuItemView extends AdaptView$1{attributes(){return AdaptView$1.resultExtend("attributes",{"role":"listitem","aria-labelledby":this.model.get("_id")+"-heading"},this)}className(){return["menu-item",this.constructor.className,this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),this.model.get("_isVisited")?"is-visited":"",this.model.get("_isComplete")?"is-complete":"",this.model.get("_isLocked")?"is-locked":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}preRender(){this.model.checkCompletionStatus();this.model.checkInteractionCompletionStatus()}postRender(){this.$el.imageready(this.setReadyStatus.bind(this))}}MenuItemView.type="menuItem";var MenuItemView$1=__AMD("core/js/views/menuItemView",MenuItemView);class MenuView extends ContentObjectView{}Object.assign(MenuView,{childContainer:".js-children",childView:MenuItemView$1,type:"menu",template:"menu"});var MenuView$1=__AMD("core/js/views/menuView",MenuView);class BoxMenuItemView extends MenuItemView$1{className(){return`${super.className()} boxmenu-item`}events(){return{"click .js-btn-click":"onClickMenuItemButton"}}onClickMenuItemButton(event){if(event&&event.preventDefault)event.preventDefault();if(this.model.get("_isLocked"))return;router$1.navigateToElement(this.model.get("_id"))}}BoxMenuItemView.template="boxMenuItem";var BoxMenuItemView$1=__AMD("menu/adapt-contrib-boxMenu/js/BoxMenuItemView",BoxMenuItemView);class BoxMenuGroupView extends MenuItemView$1{className(){return`${super.className()} boxmenu-group`}postRender(){_.defer(this.addChildren.bind(this));this.$el.imageready(this.setReadyStatus.bind(this));this.$el.parents(".boxmenu__item-container").addClass("has-groups")}}BoxMenuGroupView.template="boxMenuGroup";BoxMenuGroupView.childContainer=".js-group-children";BoxMenuGroupView.childView=BoxMenuItemView$1;var BoxMenuGroupView$1=__AMD("menu/adapt-contrib-boxMenu/js/BoxMenuGroupView",BoxMenuGroupView);class BoxMenuView extends MenuView$1{className(){return`${super.className()} boxmenu`}initialize(){super.initialize();this.setStyles();this.listenTo(Adapt$1,"device:changed",this.onDeviceResize)}onDeviceResize(){this.setStyles()}addChildren(){let nthChild=0;const models=this.model.getChildren().models;const childViews=[];models.forEach(model=>{if(!model.get("_isAvailable"))return;if(model.get("_isHidden")){model.set("_isReady",true);return}nthChild++;model.set("_nthChild",nthChild);const ChildView=model.get("_type")==="menu"&&model.get("_boxMenu")&&model.get("_boxMenu")._renderAsGroup?BoxMenuGroupView$1:BoxMenuItemView$1;const $parentContainer=this.$(this.constructor.childContainer);const childView=new ChildView({model});childViews.push(childView);$parentContainer.append(childView.$el)});this.setChildViews(childViews)}setStyles(){this.addBackgroundLayer();this.setBackgroundImage();this.setBackgroundStyles();this.processHeader()}addBackgroundLayer(){if(this.$el.find(" > .background").length)return;this.$background=$("<div class=\"background\" aria-hidden=\"true\"></div>").prependTo(this.$el)}setBackgroundImage(){const config=this.model.get("_boxMenu");const backgroundImages=config?._backgroundImage;if(!backgroundImages)return;const backgroundImage=backgroundImages[`_${Adapt$1.device.screenSize}`]??backgroundImages._small;this.$el.toggleClass("has-bg-image",Boolean(backgroundImage));this.$background.css("background-image",backgroundImage?"url("+backgroundImage+")":"")}setBackgroundStyles(){const config=this.model.get("_boxMenu");const styles=config?._backgroundStyles;if(!styles)return;this.$background.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})}processHeader(){const config=this.model.get("_boxMenu");const header=config?._menuHeader;if(!header)return;const $header=this.$(".menu__header");this.addHeaderBackgroundLayer($header);this.setHeaderBackgroundImage(header,$header);this.setHeaderBackgroundStyles(header,$header);this.setHeaderMinimumHeight(header,$header)}addHeaderBackgroundLayer($header){if($header.find(" > .background").length)return;this.$headerBackground=$("<div class=\"background\" aria-hidden=\"true\"></div>").prependTo($header)}setHeaderBackgroundImage(config,$header){const backgroundImages=config._backgroundImage;if(!backgroundImages)return;const backgroundImage=backgroundImages[`_${Adapt$1.device.screenSize}`]??backgroundImages._small;$header.toggleClass("has-bg-image",Boolean(backgroundImage));this.$headerBackground.css("background-image",backgroundImage?"url("+backgroundImage+")":"")}setHeaderBackgroundStyles(config,$header){const styles=config._backgroundStyles;if(!styles)return;this.$headerBackground.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})}setHeaderMinimumHeight(config,$header){const minimumHeights=config._minimumHeights;if(!minimumHeights)return;const minimumHeight=minimumHeights[`_${Adapt$1.device.screenSize}`]??minimumHeights._small;$header.toggleClass("has-min-height",Boolean(minimumHeight)).css("min-height",minimumHeight?minimumHeight+"px":"")}}BoxMenuView.template="boxMenu";var BoxMenuView$1=__AMD("menu/adapt-contrib-boxMenu/js/BoxMenuView",BoxMenuView);components$1.register("course menu",{view:BoxMenuView$1});components$1.register("boxMenu",{view:BoxMenuView$1,model:MenuModel$1.extend({})});var ThemeView=Backbone.View.extend({className:function(){},initialize:function(){this.setStyles();this.listenTo(Adapt$1,{"device:changed":this.onDeviceResize,"remove":this.remove})},onDeviceResize:function(){this.setStyles()},remove:function(){Backbone.View.prototype.remove.call(this);this.onRemove()},setStyles:function(){this.setClasses();this.setBackgroundImage();this.setBackgroundStyles();this.setMinimumHeight();this.setCustomStyles()},setClasses:function(){this.$el.addClass(this.className())},setBackgroundImage:function(){var backgroundImages=this.model.get("_backgroundImage");if(!backgroundImages)return;var backgroundImage;switch(Adapt$1.device.screenSize){case"large":backgroundImage=backgroundImages._large;break;case"medium":backgroundImage=backgroundImages._medium;break;default:backgroundImage=backgroundImages._small;}if(backgroundImage){this.$el.addClass("has-bg-image").css("background-image","url("+backgroundImage+")")}else{this.$el.removeClass("has-bg-image").css("background-image","")}},setBackgroundStyles:function(){var styles=this.model.get("_backgroundStyles");if(!styles)return;this.$el.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})},setMinimumHeight:function(){var minimumHeights=this.model.get("_minimumHeights");if(!minimumHeights)return;var minimumHeight;switch(Adapt$1.device.screenSize){case"large":minimumHeight=minimumHeights._large;break;case"medium":minimumHeight=minimumHeights._medium;break;default:minimumHeight=minimumHeights._small;}if(minimumHeight){this.$el.addClass("has-min-height").css("min-height",minimumHeight+"px")}else{this.$el.removeClass("has-min-height").css("min-height","")}},setCustomStyles:function(){},onRemove:function(){}});var ThemeView$1=__AMD("theme/5ee351b2d140fe35be130b76/js/themeView",ThemeView);var ThemePageView=ThemeView$1.extend({className:function(){},setCustomStyles:function(){this.processHeader()},processHeader:function(){var header=this.model.get("_pageHeader");if(!header)return;var $header=this.$(".page__header");this.setHeaderBackgroundImage(header,$header);this.setHeaderBackgroundStyles(header,$header);this.setHeaderMinimumHeight(header,$header)},setHeaderBackgroundImage:function(config,$header){var backgroundImages=config._backgroundImage;if(!backgroundImages)return;var backgroundImage;switch(Adapt$1.device.screenSize){case"large":backgroundImage=backgroundImages._large;break;case"medium":backgroundImage=backgroundImages._medium;break;default:backgroundImage=backgroundImages._small;}if(backgroundImage){$header.addClass("has-bg-image").css("background-image","url("+backgroundImage+")")}else{$header.removeClass("has-bg-image").css("background-image","")}},setHeaderBackgroundStyles:function(config,$header){var styles=config._backgroundStyles;if(!styles)return;$header.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})},setHeaderMinimumHeight:function(config,$header){var minimumHeights=config._minimumHeights;if(!minimumHeights)return;var minimumHeight;switch(Adapt$1.device.screenSize){case"large":minimumHeight=minimumHeights._large;break;case"medium":minimumHeight=minimumHeights._medium;break;default:minimumHeight=minimumHeights._small;}if(minimumHeight){$header.addClass("has-min-height").css("min-height",minimumHeight+"px")}else{$header.removeClass("has-min-height").css("min-height","")}},onRemove:function(){}});var ThemePageView$1=__AMD("theme/5ee351b2d140fe35be130b76/js/themePageView",ThemePageView);var ThemeArticleView=ThemeView$1.extend({className:function(){},setCustomStyles:function(){},onRemove:function(){}});var ThemeArticleView$1=__AMD("theme/5ee351b2d140fe35be130b76/js/themeArticleView",ThemeArticleView);var ThemeBlockView=ThemeView$1.extend({className:function(){return this.model.get("_isDividerBlock")?"is-divider-block":""},setCustomStyles:function(){},onRemove:function(){}});var ThemeBlockView$1=__AMD("theme/5ee351b2d140fe35be130b76/js/themeBlockView",ThemeBlockView);function onDataReady(){$("html").addClass(Adapt$1.course.get("_courseStyle"))}function onPostRender(view){var model=view.model;var theme=model.get("_odi-generic");if(!theme)return;switch(model.get("_type")){case"page":new ThemePageView$1({model:new Backbone.Model(theme),el:view.$el});break;case"article":new ThemeArticleView$1({model:new Backbone.Model(theme),el:view.$el});break;case"block":new ThemeBlockView$1({model:new Backbone.Model(theme),el:view.$el});break;default:new ThemeView$1({model:new Backbone.Model(theme),el:view.$el});}}Adapt$1.on({"app:dataReady":onDataReady,"pageView:postRender articleView:postRender blockView:postRender":onPostRender});register("header",function Header(props){const jsxHeading=React.useRef(null);const{_id,displayTitle,body,instruction,mobileInstruction,_type,_component,_isA11yComponentDescriptionEnabled,classNamePrefixes=[_type&&_type.toLowerCase(),_component&&_component.toLowerCase()].filter(Boolean)}=props;const sizedInstruction=mobileInstruction&&device$1.screenSize!=="large"?mobileInstruction:instruction;const _globals=Adapt$1.course.get("_globals");const ariaRegion=_globals?._components?.[`_${_component}`]?.ariaRegion;const isSet=displayTitle||body||sizedInstruction;if(!isSet&&_isA11yComponentDescriptionEnabled&&ariaRegion){return React__default["default"].createElement("div",{className:"aria-label",dangerouslySetInnerHTML:{__html:compile(ariaRegion)}})}if(!isSet)return null;return React__default["default"].createElement("div",{id:`${_id}-header`,className:prefixClasses(classNamePrefixes,["__header"])},React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__header-inner"])},displayTitle&&React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__title"])},React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__title-inner"])+" js-heading",ref:jsxHeading})),_isA11yComponentDescriptionEnabled&&ariaRegion&&React__default["default"].createElement("div",{className:"aria-label",dangerouslySetInnerHTML:{__html:compile(ariaRegion,props)}}),body&&React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__body"])},React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__body-inner"]),dangerouslySetInnerHTML:{__html:compile(body,props)}})),sizedInstruction&&React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__instruction"])},React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__instruction-inner"]),dangerouslySetInnerHTML:{__html:compile(sizedInstruction,props)}}))))});register("image",function Image(props){const hasMediumSetting=Object.prototype.hasOwnProperty.call(props,"_medium")||Object.prototype.hasOwnProperty.call(props,"medium");const screenSize=hasMediumSetting?device$1.screenSize:device$1.screenSize==="large"?"large":"small";const src=props[`_${screenSize}`]||props[`${screenSize}`]||props._src||props.src;const hasSource=Boolean(src);if(!hasSource)return null;const attributionClassNamePrefixes=props.attributionClassNamePrefixes||props.classNamePrefixes;return React__default["default"].createElement("span",{id:props.id,className:classes([prefixClasses(props.classNamePrefixes,["__image-container"]),props.classes,props.attribution&&"has-attribution"])},React__default["default"].createElement("img",{className:prefixClasses(props.classNamePrefixes,["__image"]),src:src,"aria-label":a11y$1.normalize(props.alt),"aria-hidden":!props.alt,loading:"eager","aria-describedby":props.longdescription?props.longDescriptionId:undefined}),props.attribution&&React__default["default"].createElement("span",{className:prefixClasses(attributionClassNamePrefixes,["__attribution"])},React__default["default"].createElement("span",{className:prefixClasses(attributionClassNamePrefixes,["__attribution-inner"])},html(props.attribution))))});function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}const LinkWrapper=_ref=>{let{href,children,target,className,role}=_ref;return href?React__default["default"].createElement("a",{href:href,target:target,className:className,role:role},children):children};register("graphic",function Graphic(props){const{_id,_isScrollable,_scrollPercent,_graphic,_globals}=props;const scrollableProperties=_isScrollable?{role:"slider",className:"component__widget graphic__widget js-graphic-scrollbar","aria-controls":`graphic__scroll__container__${_id}`,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0","aria-valuenow":_scrollPercent,"aria-label":Handlebars.compile(_globals._components._graphic.scrollAriaLabel)(props),"aria-describedby":_graphic.longdescription?`graphic__longdescription__${_id}`:undefined,tabIndex:"0"}:{};return React__default["default"].createElement("div",{className:"component__inner graphic__inner"},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",_extends({className:"component__widget graphic__widget"},scrollableProperties),React__default["default"].createElement(LinkWrapper,{href:_graphic._url,target:_graphic._target,className:"graphic__link js-graphic-link",role:"link"},React__default["default"].createElement(templates.image,_extends({},_graphic,{"aria-hidden":_isScrollable,id:`graphic__scroll__container__${_id}`,longDescriptionId:`graphic__longdescription__${_id}`,classes:"js-graphic-scroll-container",classNamePrefixes:["component","graphic"]})),_graphic.longdescription&&React__default["default"].createElement("div",{id:`graphic__longdescription__${_id}`,className:"graphic__longdescription"},React__default["default"].createElement("div",{className:"graphic__longdescription-inner"},_graphic.longdescription)))))});register("text",function Text(props){return React__default["default"].createElement("div",{className:"component__inner text__inner"},React__default["default"].createElement(templates.header,props))});$("body").append(Handlebars.templates.loading());data$1.on("ready",()=>{logging$1.debug("Calling Adapt.init");Adapt$1.init();Adapt$1.off("adaptCollection:dataLoaded courseModel:dataLoaded")}).init()});window.__AMD=function(id,value){window.define(id,function(){return value});window.require([id]);return value};
